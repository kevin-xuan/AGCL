dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:2
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.7
dis_delta:0.0
valid_epoch:1
device:cuda:2
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0942, tra_kl_loss: 6.5868, time_kl_loss: 7.0318, dis_kl_loss: 6.0510, contra_loss: 13351.3801
Test epoch:1, time: 18.577263(s), Recall (@2: 0.1059, @5: 0.1643, @10: 0.2173), NDCG (@2: 0.0943, @5: 0.1207, @10: 0.1376)

Train epoch:2, time: 18.577263(s), rec_loss: 7.3363, tra_kl_loss: 7.1723, time_kl_loss: 14.4490, dis_kl_loss: 5.9716, contra_loss: 7630.6178
Test epoch:2, time: 36.569179(s), Recall (@2: 0.1054, @5: 0.1820, @10: 0.2464), NDCG (@2: 0.0919, @5: 0.1259, @10: 0.1468)

Train epoch:3, time: 36.569179(s), rec_loss: 6.8201, tra_kl_loss: 6.7785, time_kl_loss: 13.9641, dis_kl_loss: 5.3582, contra_loss: 8359.8862
Test epoch:3, time: 54.604644(s), Recall (@2: 0.1179, @5: 0.1912, @10: 0.2630), NDCG (@2: 0.1026, @5: 0.1354, @10: 0.1584)

Train epoch:4, time: 54.604644(s), rec_loss: 6.4532, tra_kl_loss: 6.4894, time_kl_loss: 13.1100, dis_kl_loss: 5.0929, contra_loss: 10456.8903
Test epoch:4, time: 72.568902(s), Recall (@2: 0.1358, @5: 0.2188, @10: 0.2799), NDCG (@2: 0.1166, @5: 0.1536, @10: 0.1733)

Train epoch:5, time: 72.568902(s), rec_loss: 6.1771, tra_kl_loss: 6.4434, time_kl_loss: 12.0804, dis_kl_loss: 4.9798, contra_loss: 12195.2339
Test epoch:5, time: 90.782012(s), Recall (@2: 0.1210, @5: 0.1988, @10: 0.2719), NDCG (@2: 0.1057, @5: 0.1406, @10: 0.1643)

Train epoch:6, time: 90.782012(s), rec_loss: 5.9726, tra_kl_loss: 6.3377, time_kl_loss: 11.7616, dis_kl_loss: 4.9086, contra_loss: 13047.7750
Test epoch:6, time: 109.377474(s), Recall (@2: 0.1296, @5: 0.2173, @10: 0.2915), NDCG (@2: 0.1106, @5: 0.1502, @10: 0.1741)

Train epoch:7, time: 109.377474(s), rec_loss: 5.7936, tra_kl_loss: 6.3503, time_kl_loss: 11.4431, dis_kl_loss: 4.8802, contra_loss: 13754.7409
Test epoch:7, time: 127.428757(s), Recall (@2: 0.1358, @5: 0.2238, @10: 0.3010), NDCG (@2: 0.1167, @5: 0.1564, @10: 0.1814)

Train epoch:8, time: 127.428757(s), rec_loss: 5.6664, tra_kl_loss: 6.4729, time_kl_loss: 10.5224, dis_kl_loss: 4.8774, contra_loss: 15149.7689
Test epoch:8, time: 145.550855(s), Recall (@2: 0.1399, @5: 0.2303, @10: 0.3021), NDCG (@2: 0.1208, @5: 0.1612, @10: 0.1845)

Train epoch:9, time: 145.550855(s), rec_loss: 5.5584, tra_kl_loss: 6.3292, time_kl_loss: 10.5989, dis_kl_loss: 4.8300, contra_loss: 14302.0104
Test epoch:9, time: 163.598820(s), Recall (@2: 0.1458, @5: 0.2290, @10: 0.3047), NDCG (@2: 0.1248, @5: 0.1620, @10: 0.1865)

Train epoch:10, time: 163.598820(s), rec_loss: 5.4579, tra_kl_loss: 6.2822, time_kl_loss: 10.9282, dis_kl_loss: 4.8046, contra_loss: 13908.6268
Test epoch:10, time: 181.474288(s), Recall (@2: 0.1490, @5: 0.2318, @10: 0.3083), NDCG (@2: 0.1274, @5: 0.1647, @10: 0.1894)

Train epoch:11, time: 181.474288(s), rec_loss: 5.3881, tra_kl_loss: 6.3460, time_kl_loss: 10.1485, dis_kl_loss: 4.7976, contra_loss: 14670.3622
Test epoch:11, time: 199.400648(s), Recall (@2: 0.1425, @5: 0.2307, @10: 0.3025), NDCG (@2: 0.1239, @5: 0.1637, @10: 0.1869)

Train epoch:12, time: 199.400648(s), rec_loss: 5.3285, tra_kl_loss: 6.2404, time_kl_loss: 10.4933, dis_kl_loss: 4.7987, contra_loss: 14068.7274
Test epoch:12, time: 216.993510(s), Recall (@2: 0.1490, @5: 0.2346, @10: 0.3094), NDCG (@2: 0.1281, @5: 0.1668, @10: 0.1909)

Train epoch:13, time: 216.993510(s), rec_loss: 5.2777, tra_kl_loss: 6.2849, time_kl_loss: 10.6318, dis_kl_loss: 4.7685, contra_loss: 14125.7689
Test epoch:13, time: 234.707987(s), Recall (@2: 0.1520, @5: 0.2432, @10: 0.3202), NDCG (@2: 0.1304, @5: 0.1714, @10: 0.1961)

Train epoch:14, time: 234.707987(s), rec_loss: 5.2253, tra_kl_loss: 6.2429, time_kl_loss: 10.3438, dis_kl_loss: 4.7872, contra_loss: 14607.7515
Test epoch:14, time: 252.700688(s), Recall (@2: 0.1511, @5: 0.2393, @10: 0.3038), NDCG (@2: 0.1296, @5: 0.1692, @10: 0.1899)

Train epoch:15, time: 252.700688(s), rec_loss: 5.1978, tra_kl_loss: 6.2613, time_kl_loss: 10.8383, dis_kl_loss: 4.7899, contra_loss: 12687.9265
Test epoch:15, time: 270.702066(s), Recall (@2: 0.1503, @5: 0.2436, @10: 0.3137), NDCG (@2: 0.1304, @5: 0.1725, @10: 0.1951)

Train epoch:16, time: 270.702066(s), rec_loss: 5.1631, tra_kl_loss: 6.2389, time_kl_loss: 11.0616, dis_kl_loss: 4.7615, contra_loss: 12017.5594
Test epoch:16, time: 288.608969(s), Recall (@2: 0.1529, @5: 0.2426, @10: 0.3122), NDCG (@2: 0.1314, @5: 0.1716, @10: 0.1941)

Train epoch:17, time: 288.608969(s), rec_loss: 5.1630, tra_kl_loss: 6.2833, time_kl_loss: 11.4274, dis_kl_loss: 4.7293, contra_loss: 11464.5282
Test epoch:17, time: 306.406405(s), Recall (@2: 0.1565, @5: 0.2505, @10: 0.3202), NDCG (@2: 0.1353, @5: 0.1777, @10: 0.2002)

Train epoch:18, time: 306.406405(s), rec_loss: 5.1099, tra_kl_loss: 6.3524, time_kl_loss: 10.4770, dis_kl_loss: 4.8295, contra_loss: 12319.5093
Test epoch:18, time: 324.498935(s), Recall (@2: 0.1503, @5: 0.2395, @10: 0.3053), NDCG (@2: 0.1307, @5: 0.1707, @10: 0.1920)

Train epoch:19, time: 324.498935(s), rec_loss: 5.0657, tra_kl_loss: 6.1878, time_kl_loss: 11.0667, dis_kl_loss: 4.7281, contra_loss: 10446.6794
Test epoch:19, time: 342.484936(s), Recall (@2: 0.1574, @5: 0.2533, @10: 0.3230), NDCG (@2: 0.1364, @5: 0.1795, @10: 0.2021)

Train epoch:20, time: 342.484936(s), rec_loss: 5.0608, tra_kl_loss: 6.3338, time_kl_loss: 11.0067, dis_kl_loss: 4.7469, contra_loss: 11949.0049
Test epoch:20, time: 360.117362(s), Recall (@2: 0.1527, @5: 0.2439, @10: 0.3111), NDCG (@2: 0.1320, @5: 0.1730, @10: 0.1947)

Train epoch:21, time: 360.117362(s), rec_loss: 5.0264, tra_kl_loss: 6.3107, time_kl_loss: 11.5357, dis_kl_loss: 4.7223, contra_loss: 10495.4493
Test epoch:21, time: 378.138070(s), Recall (@2: 0.1587, @5: 0.2464, @10: 0.3230), NDCG (@2: 0.1375, @5: 0.1770, @10: 0.2015)

Train epoch:22, time: 378.138070(s), rec_loss: 4.9954, tra_kl_loss: 6.2702, time_kl_loss: 11.4484, dis_kl_loss: 4.6923, contra_loss: 10193.8652
Test epoch:22, time: 395.965014(s), Recall (@2: 0.1634, @5: 0.2508, @10: 0.3256), NDCG (@2: 0.1411, @5: 0.1802, @10: 0.2045)

Train epoch:23, time: 395.965014(s), rec_loss: 4.9936, tra_kl_loss: 6.3093, time_kl_loss: 11.3021, dis_kl_loss: 4.7442, contra_loss: 9723.8191
Test epoch:23, time: 414.605013(s), Recall (@2: 0.1477, @5: 0.2346, @10: 0.3042), NDCG (@2: 0.1273, @5: 0.1661, @10: 0.1886)

Train epoch:24, time: 414.605013(s), rec_loss: 4.9556, tra_kl_loss: 6.2007, time_kl_loss: 11.5016, dis_kl_loss: 4.7328, contra_loss: 9572.2942
Test epoch:24, time: 432.739308(s), Recall (@2: 0.1539, @5: 0.2404, @10: 0.3163), NDCG (@2: 0.1336, @5: 0.1731, @10: 0.1976)

Train epoch:25, time: 432.739308(s), rec_loss: 4.9592, tra_kl_loss: 6.4171, time_kl_loss: 10.9608, dis_kl_loss: 4.7188, contra_loss: 9964.4561
Test epoch:25, time: 451.214124(s), Recall (@2: 0.1576, @5: 0.2421, @10: 0.3152), NDCG (@2: 0.1379, @5: 0.1758, @10: 0.1994)

Train epoch:26, time: 451.214124(s), rec_loss: 4.9586, tra_kl_loss: 6.2806, time_kl_loss: 11.1560, dis_kl_loss: 4.7566, contra_loss: 8978.2598
Test epoch:26, time: 469.515338(s), Recall (@2: 0.1498, @5: 0.2350, @10: 0.3049), NDCG (@2: 0.1301, @5: 0.1682, @10: 0.1907)

Train epoch:27, time: 469.515338(s), rec_loss: 4.9342, tra_kl_loss: 6.2907, time_kl_loss: 11.7626, dis_kl_loss: 4.6996, contra_loss: 8422.6628
Test epoch:27, time: 487.809566(s), Recall (@2: 0.1675, @5: 0.2589, @10: 0.3295), NDCG (@2: 0.1451, @5: 0.1862, @10: 0.2088)

Train epoch:28, time: 487.809566(s), rec_loss: 4.9237, tra_kl_loss: 6.3121, time_kl_loss: 12.1643, dis_kl_loss: 4.7468, contra_loss: 8854.6609
Test epoch:28, time: 505.762015(s), Recall (@2: 0.1514, @5: 0.2316, @10: 0.3008), NDCG (@2: 0.1315, @5: 0.1675, @10: 0.1898)

Train epoch:29, time: 505.762015(s), rec_loss: 4.9042, tra_kl_loss: 6.2664, time_kl_loss: 11.7712, dis_kl_loss: 4.7254, contra_loss: 8247.5526
Test epoch:29, time: 523.881089(s), Recall (@2: 0.1576, @5: 0.2449, @10: 0.3187), NDCG (@2: 0.1372, @5: 0.1767, @10: 0.2007)

Train epoch:30, time: 523.881089(s), rec_loss: 4.9044, tra_kl_loss: 6.2894, time_kl_loss: 11.9088, dis_kl_loss: 4.6799, contra_loss: 8025.4968
Test epoch:30, time: 542.380757(s), Recall (@2: 0.1624, @5: 0.2471, @10: 0.3202), NDCG (@2: 0.1410, @5: 0.1790, @10: 0.2025)

Train epoch:31, time: 542.380757(s), rec_loss: 4.8731, tra_kl_loss: 6.3181, time_kl_loss: 11.6544, dis_kl_loss: 4.7360, contra_loss: 8219.3622
Test epoch:31, time: 560.746932(s), Recall (@2: 0.1580, @5: 0.2398, @10: 0.3167), NDCG (@2: 0.1389, @5: 0.1756, @10: 0.2004)

Train epoch:32, time: 560.746932(s), rec_loss: 4.8789, tra_kl_loss: 6.3018, time_kl_loss: 11.6860, dis_kl_loss: 4.7226, contra_loss: 7875.5104
Test epoch:32, time: 578.790550(s), Recall (@2: 0.1587, @5: 0.2447, @10: 0.3178), NDCG (@2: 0.1379, @5: 0.1768, @10: 0.2004)

Train epoch:33, time: 578.790550(s), rec_loss: 4.8484, tra_kl_loss: 6.3158, time_kl_loss: 12.1623, dis_kl_loss: 4.7362, contra_loss: 7504.0192
Test epoch:33, time: 597.239529(s), Recall (@2: 0.1505, @5: 0.2378, @10: 0.3064), NDCG (@2: 0.1312, @5: 0.1703, @10: 0.1924)

Train epoch:34, time: 597.239529(s), rec_loss: 4.8409, tra_kl_loss: 6.1640, time_kl_loss: 12.2299, dis_kl_loss: 4.7095, contra_loss: 7287.9456
Test epoch:34, time: 615.471312(s), Recall (@2: 0.1490, @5: 0.2335, @10: 0.3060), NDCG (@2: 0.1298, @5: 0.1677, @10: 0.1909)

Train epoch:35, time: 615.471312(s), rec_loss: 4.8409, tra_kl_loss: 6.2989, time_kl_loss: 12.4779, dis_kl_loss: 4.7103, contra_loss: 7245.6228
Test epoch:35, time: 633.423195(s), Recall (@2: 0.1576, @5: 0.2443, @10: 0.3176), NDCG (@2: 0.1378, @5: 0.1768, @10: 0.2004)

Train epoch:36, time: 633.423195(s), rec_loss: 4.8189, tra_kl_loss: 6.2711, time_kl_loss: 12.0292, dis_kl_loss: 4.7260, contra_loss: 7295.4818
Test epoch:36, time: 651.887942(s), Recall (@2: 0.1498, @5: 0.2357, @10: 0.3036), NDCG (@2: 0.1308, @5: 0.1694, @10: 0.1913)

Train epoch:37, time: 651.887942(s), rec_loss: 4.8291, tra_kl_loss: 6.2433, time_kl_loss: 12.3058, dis_kl_loss: 4.6978, contra_loss: 6986.3262
Test epoch:37, time: 670.113230(s), Recall (@2: 0.1520, @5: 0.2350, @10: 0.3055), NDCG (@2: 0.1326, @5: 0.1701, @10: 0.1927)

Train epoch:38, time: 670.113230(s), rec_loss: 4.7914, tra_kl_loss: 6.3656, time_kl_loss: 12.2307, dis_kl_loss: 4.7037, contra_loss: 7003.5220
Test epoch:38, time: 688.386603(s), Recall (@2: 0.1520, @5: 0.2324, @10: 0.3060), NDCG (@2: 0.1346, @5: 0.1706, @10: 0.1942)

Train epoch:39, time: 688.386603(s), rec_loss: 4.7916, tra_kl_loss: 6.2648, time_kl_loss: 11.9102, dis_kl_loss: 4.7565, contra_loss: 7319.6224
Test epoch:39, time: 706.560073(s), Recall (@2: 0.1557, @5: 0.2387, @10: 0.3124), NDCG (@2: 0.1363, @5: 0.1737, @10: 0.1975)

Train epoch:40, time: 706.560073(s), rec_loss: 4.7748, tra_kl_loss: 6.3481, time_kl_loss: 12.1537, dis_kl_loss: 4.7555, contra_loss: 6848.2614
Test epoch:40, time: 725.056799(s), Recall (@2: 0.1458, @5: 0.2273, @10: 0.2978), NDCG (@2: 0.1273, @5: 0.1636, @10: 0.1865)

Train epoch:41, time: 725.056799(s), rec_loss: 4.7801, tra_kl_loss: 6.3014, time_kl_loss: 13.0544, dis_kl_loss: 4.7721, contra_loss: 6611.6284
Test epoch:41, time: 743.231114(s), Recall (@2: 0.1535, @5: 0.2402, @10: 0.3085), NDCG (@2: 0.1338, @5: 0.1725, @10: 0.1945)

Train epoch:42, time: 743.231114(s), rec_loss: 4.7815, tra_kl_loss: 6.3344, time_kl_loss: 12.7565, dis_kl_loss: 4.7394, contra_loss: 6778.7772
Test epoch:42, time: 761.946013(s), Recall (@2: 0.1559, @5: 0.2406, @10: 0.3096), NDCG (@2: 0.1367, @5: 0.1749, @10: 0.1973)

Train epoch:43, time: 761.946013(s), rec_loss: 4.7674, tra_kl_loss: 6.3275, time_kl_loss: 12.4124, dis_kl_loss: 4.7135, contra_loss: 6749.0062
Test epoch:43, time: 780.331106(s), Recall (@2: 0.1572, @5: 0.2367, @10: 0.3075), NDCG (@2: 0.1374, @5: 0.1724, @10: 0.1953)

Train epoch:44, time: 780.331106(s), rec_loss: 4.7851, tra_kl_loss: 6.3994, time_kl_loss: 12.3243, dis_kl_loss: 4.7293, contra_loss: 6778.6143
Test epoch:44, time: 798.864047(s), Recall (@2: 0.1498, @5: 0.2348, @10: 0.3029), NDCG (@2: 0.1311, @5: 0.1690, @10: 0.1912)

Train epoch:45, time: 798.864047(s), rec_loss: 4.7741, tra_kl_loss: 6.3329, time_kl_loss: 12.8794, dis_kl_loss: 4.7309, contra_loss: 6667.2355
Test epoch:45, time: 815.802222(s), Recall (@2: 0.1514, @5: 0.2391, @10: 0.3064), NDCG (@2: 0.1342, @5: 0.1737, @10: 0.1955)

Train epoch:46, time: 815.802222(s), rec_loss: 4.7437, tra_kl_loss: 6.2465, time_kl_loss: 12.9870, dis_kl_loss: 4.7526, contra_loss: 6734.1986
Test epoch:46, time: 833.137083(s), Recall (@2: 0.1451, @5: 0.2301, @10: 0.3031), NDCG (@2: 0.1280, @5: 0.1659, @10: 0.1894)

Train epoch:47, time: 833.137083(s), rec_loss: 4.7393, tra_kl_loss: 6.2876, time_kl_loss: 12.6263, dis_kl_loss: 4.7972, contra_loss: 6700.6453
Test epoch:47, time: 850.232094(s), Recall (@2: 0.1578, @5: 0.2426, @10: 0.3146), NDCG (@2: 0.1378, @5: 0.1759, @10: 0.1992)

Train epoch:48, time: 850.232094(s), rec_loss: 4.7341, tra_kl_loss: 6.3408, time_kl_loss: 12.9665, dis_kl_loss: 4.7536, contra_loss: 6558.2203
Test epoch:48, time: 867.545399(s), Recall (@2: 0.1539, @5: 0.2342, @10: 0.3070), NDCG (@2: 0.1352, @5: 0.1711, @10: 0.1946)

Train epoch:49, time: 867.545399(s), rec_loss: 4.7130, tra_kl_loss: 6.3069, time_kl_loss: 13.0151, dis_kl_loss: 4.7279, contra_loss: 6678.5178
Test epoch:49, time: 884.720492(s), Recall (@2: 0.1468, @5: 0.2372, @10: 0.3060), NDCG (@2: 0.1296, @5: 0.1698, @10: 0.1922)

Train epoch:50, time: 884.720492(s), rec_loss: 4.7599, tra_kl_loss: 6.2325, time_kl_loss: 12.8808, dis_kl_loss: 4.7269, contra_loss: 6859.4120
Test epoch:50, time: 901.707021(s), Recall (@2: 0.1479, @5: 0.2322, @10: 0.3047), NDCG (@2: 0.1321, @5: 0.1699, @10: 0.1933)
