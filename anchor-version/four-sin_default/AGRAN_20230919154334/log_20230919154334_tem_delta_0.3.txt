dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:2
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.3
dis_delta:0.0
valid_epoch:1
device:cuda:2
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0957, tra_kl_loss: 6.5921, time_kl_loss: 6.1354, dis_kl_loss: 6.0521, contra_loss: 15445.4647
Test epoch:1, time: 12.736501(s), Recall (@2: 0.1097, @5: 0.1636, @10: 0.2204), NDCG (@2: 0.0965, @5: 0.1204, @10: 0.1386)

Train epoch:2, time: 12.736501(s), rec_loss: 7.3460, tra_kl_loss: 7.1020, time_kl_loss: 7.2277, dis_kl_loss: 5.8396, contra_loss: 25657.8802
Test epoch:2, time: 25.016007(s), Recall (@2: 0.1115, @5: 0.1947, @10: 0.2514), NDCG (@2: 0.0984, @5: 0.1351, @10: 0.1537)

Train epoch:3, time: 25.016007(s), rec_loss: 6.8234, tra_kl_loss: 6.8248, time_kl_loss: 5.0640, dis_kl_loss: 5.2209, contra_loss: 26817.9403
Test epoch:3, time: 37.504122(s), Recall (@2: 0.1138, @5: 0.1852, @10: 0.2602), NDCG (@2: 0.0985, @5: 0.1303, @10: 0.1544)

Train epoch:4, time: 37.504122(s), rec_loss: 6.4516, tra_kl_loss: 6.4845, time_kl_loss: 4.2888, dis_kl_loss: 5.0526, contra_loss: 25543.8628
Test epoch:4, time: 49.670794(s), Recall (@2: 0.1253, @5: 0.2063, @10: 0.2794), NDCG (@2: 0.1076, @5: 0.1440, @10: 0.1676)

Train epoch:5, time: 49.670794(s), rec_loss: 6.1758, tra_kl_loss: 6.4403, time_kl_loss: 3.5344, dis_kl_loss: 4.9785, contra_loss: 24826.1345
Test epoch:5, time: 61.785972(s), Recall (@2: 0.1220, @5: 0.2033, @10: 0.2775), NDCG (@2: 0.1055, @5: 0.1420, @10: 0.1660)

Train epoch:6, time: 61.785972(s), rec_loss: 5.9675, tra_kl_loss: 6.3441, time_kl_loss: 3.2531, dis_kl_loss: 4.8689, contra_loss: 23677.5784
Test epoch:6, time: 74.211210(s), Recall (@2: 0.1328, @5: 0.2158, @10: 0.2984), NDCG (@2: 0.1149, @5: 0.1524, @10: 0.1792)

Train epoch:7, time: 74.211210(s), rec_loss: 5.7955, tra_kl_loss: 6.3438, time_kl_loss: 3.0826, dis_kl_loss: 4.8428, contra_loss: 22530.6969
Test epoch:7, time: 86.375013(s), Recall (@2: 0.1348, @5: 0.2195, @10: 0.3023), NDCG (@2: 0.1153, @5: 0.1536, @10: 0.1801)

Train epoch:8, time: 86.375013(s), rec_loss: 5.6593, tra_kl_loss: 6.4364, time_kl_loss: 2.9054, dis_kl_loss: 4.8311, contra_loss: 21513.2033
Test epoch:8, time: 98.780442(s), Recall (@2: 0.1393, @5: 0.2298, @10: 0.3060), NDCG (@2: 0.1192, @5: 0.1600, @10: 0.1846)

Train epoch:9, time: 98.780442(s), rec_loss: 5.5531, tra_kl_loss: 6.3264, time_kl_loss: 2.7210, dis_kl_loss: 4.8215, contra_loss: 20369.1503
Test epoch:9, time: 110.894518(s), Recall (@2: 0.1442, @5: 0.2279, @10: 0.3036), NDCG (@2: 0.1227, @5: 0.1604, @10: 0.1849)

Train epoch:10, time: 110.894518(s), rec_loss: 5.4542, tra_kl_loss: 6.3119, time_kl_loss: 2.6298, dis_kl_loss: 4.8253, contra_loss: 18668.9382
Test epoch:10, time: 123.259133(s), Recall (@2: 0.1464, @5: 0.2339, @10: 0.3051), NDCG (@2: 0.1251, @5: 0.1644, @10: 0.1873)

Train epoch:11, time: 123.259133(s), rec_loss: 5.3825, tra_kl_loss: 6.3495, time_kl_loss: 2.6419, dis_kl_loss: 4.7975, contra_loss: 18278.1474
Test epoch:11, time: 135.849280(s), Recall (@2: 0.1445, @5: 0.2335, @10: 0.3008), NDCG (@2: 0.1241, @5: 0.1640, @10: 0.1858)

Train epoch:12, time: 135.849280(s), rec_loss: 5.3230, tra_kl_loss: 6.2656, time_kl_loss: 2.6360, dis_kl_loss: 4.8163, contra_loss: 17082.6751
Test epoch:12, time: 148.046018(s), Recall (@2: 0.1492, @5: 0.2363, @10: 0.3027), NDCG (@2: 0.1283, @5: 0.1671, @10: 0.1885)

Train epoch:13, time: 148.046018(s), rec_loss: 5.2703, tra_kl_loss: 6.3118, time_kl_loss: 2.5518, dis_kl_loss: 4.7932, contra_loss: 16486.0464
Test epoch:13, time: 160.225727(s), Recall (@2: 0.1529, @5: 0.2417, @10: 0.3180), NDCG (@2: 0.1303, @5: 0.1703, @10: 0.1949)

Train epoch:14, time: 160.225727(s), rec_loss: 5.2255, tra_kl_loss: 6.2479, time_kl_loss: 2.6101, dis_kl_loss: 4.7986, contra_loss: 16148.9702
Test epoch:14, time: 173.002075(s), Recall (@2: 0.1464, @5: 0.2335, @10: 0.3096), NDCG (@2: 0.1266, @5: 0.1658, @10: 0.1904)

Train epoch:15, time: 173.002075(s), rec_loss: 5.1840, tra_kl_loss: 6.2907, time_kl_loss: 2.5373, dis_kl_loss: 4.7791, contra_loss: 15421.0009
Test epoch:15, time: 185.832339(s), Recall (@2: 0.1486, @5: 0.2344, @10: 0.3085), NDCG (@2: 0.1274, @5: 0.1660, @10: 0.1902)

Train epoch:16, time: 185.832339(s), rec_loss: 5.1498, tra_kl_loss: 6.2343, time_kl_loss: 2.5341, dis_kl_loss: 4.8194, contra_loss: 14637.1841
Test epoch:16, time: 198.451775(s), Recall (@2: 0.1496, @5: 0.2389, @10: 0.3100), NDCG (@2: 0.1294, @5: 0.1696, @10: 0.1925)

Train epoch:17, time: 198.451775(s), rec_loss: 5.1144, tra_kl_loss: 6.2351, time_kl_loss: 2.4894, dis_kl_loss: 4.7772, contra_loss: 13933.9168
Test epoch:17, time: 211.087998(s), Recall (@2: 0.1546, @5: 0.2449, @10: 0.3195), NDCG (@2: 0.1333, @5: 0.1743, @10: 0.1984)

Train epoch:18, time: 211.087998(s), rec_loss: 5.0932, tra_kl_loss: 6.3383, time_kl_loss: 2.5399, dis_kl_loss: 4.7997, contra_loss: 13868.8433
Test epoch:18, time: 223.425783(s), Recall (@2: 0.1567, @5: 0.2376, @10: 0.3105), NDCG (@2: 0.1350, @5: 0.1714, @10: 0.1951)

Train epoch:19, time: 223.425783(s), rec_loss: 5.0654, tra_kl_loss: 6.1936, time_kl_loss: 2.5273, dis_kl_loss: 4.7883, contra_loss: 12983.2246
Test epoch:19, time: 235.832669(s), Recall (@2: 0.1522, @5: 0.2439, @10: 0.3221), NDCG (@2: 0.1327, @5: 0.1739, @10: 0.1991)

Train epoch:20, time: 235.832669(s), rec_loss: 5.0477, tra_kl_loss: 6.2828, time_kl_loss: 2.4892, dis_kl_loss: 4.7786, contra_loss: 12748.9370
Test epoch:20, time: 248.252175(s), Recall (@2: 0.1494, @5: 0.2372, @10: 0.3081), NDCG (@2: 0.1295, @5: 0.1689, @10: 0.1920)

Train epoch:21, time: 248.252175(s), rec_loss: 5.0184, tra_kl_loss: 6.2823, time_kl_loss: 2.5210, dis_kl_loss: 4.7800, contra_loss: 12562.4145
Test epoch:21, time: 260.493433(s), Recall (@2: 0.1539, @5: 0.2456, @10: 0.3154), NDCG (@2: 0.1341, @5: 0.1750, @10: 0.1976)

Train epoch:22, time: 260.493433(s), rec_loss: 5.0011, tra_kl_loss: 6.2286, time_kl_loss: 2.5035, dis_kl_loss: 4.7634, contra_loss: 11764.7158
Test epoch:22, time: 273.445635(s), Recall (@2: 0.1621, @5: 0.2505, @10: 0.3275), NDCG (@2: 0.1399, @5: 0.1797, @10: 0.2045)

Train epoch:23, time: 273.445635(s), rec_loss: 4.9905, tra_kl_loss: 6.3236, time_kl_loss: 2.4735, dis_kl_loss: 4.7673, contra_loss: 11957.0267
Test epoch:23, time: 285.586909(s), Recall (@2: 0.1496, @5: 0.2363, @10: 0.3135), NDCG (@2: 0.1293, @5: 0.1684, @10: 0.1933)

Train epoch:24, time: 285.586909(s), rec_loss: 4.9646, tra_kl_loss: 6.2393, time_kl_loss: 2.4831, dis_kl_loss: 4.7790, contra_loss: 11366.0005
Test epoch:24, time: 297.662322(s), Recall (@2: 0.1570, @5: 0.2460, @10: 0.3176), NDCG (@2: 0.1361, @5: 0.1762, @10: 0.1993)

Train epoch:25, time: 297.662322(s), rec_loss: 4.9567, tra_kl_loss: 6.3818, time_kl_loss: 2.5231, dis_kl_loss: 4.7748, contra_loss: 11444.6702
Test epoch:25, time: 309.682921(s), Recall (@2: 0.1576, @5: 0.2462, @10: 0.3258), NDCG (@2: 0.1376, @5: 0.1777, @10: 0.2034)

Train epoch:26, time: 309.682921(s), rec_loss: 4.9413, tra_kl_loss: 6.2276, time_kl_loss: 2.5031, dis_kl_loss: 4.7736, contra_loss: 10764.7416
Test epoch:26, time: 322.440409(s), Recall (@2: 0.1412, @5: 0.2283, @10: 0.3003), NDCG (@2: 0.1248, @5: 0.1638, @10: 0.1869)

Train epoch:27, time: 322.440409(s), rec_loss: 4.9314, tra_kl_loss: 6.2752, time_kl_loss: 2.4555, dis_kl_loss: 4.7687, contra_loss: 10242.4622
Test epoch:27, time: 334.866013(s), Recall (@2: 0.1669, @5: 0.2577, @10: 0.3316), NDCG (@2: 0.1436, @5: 0.1844, @10: 0.2082)

Train epoch:28, time: 334.866013(s), rec_loss: 4.9220, tra_kl_loss: 6.2800, time_kl_loss: 2.4996, dis_kl_loss: 4.8006, contra_loss: 10148.4676
Test epoch:28, time: 347.330418(s), Recall (@2: 0.1492, @5: 0.2344, @10: 0.3060), NDCG (@2: 0.1304, @5: 0.1687, @10: 0.1918)

Train epoch:29, time: 347.330418(s), rec_loss: 4.9044, tra_kl_loss: 6.2354, time_kl_loss: 2.4649, dis_kl_loss: 4.7559, contra_loss: 9731.8261
Test epoch:29, time: 359.734377(s), Recall (@2: 0.1578, @5: 0.2441, @10: 0.3139), NDCG (@2: 0.1375, @5: 0.1767, @10: 0.1993)

Train epoch:30, time: 359.734377(s), rec_loss: 4.8939, tra_kl_loss: 6.3042, time_kl_loss: 2.5970, dis_kl_loss: 4.7787, contra_loss: 9792.4115
Test epoch:30, time: 372.388840(s), Recall (@2: 0.1572, @5: 0.2469, @10: 0.3215), NDCG (@2: 0.1385, @5: 0.1788, @10: 0.2028)

Train epoch:31, time: 372.388840(s), rec_loss: 4.8833, tra_kl_loss: 6.2649, time_kl_loss: 2.5022, dis_kl_loss: 4.7765, contra_loss: 9500.9110
Test epoch:31, time: 384.945822(s), Recall (@2: 0.1559, @5: 0.2385, @10: 0.3159), NDCG (@2: 0.1358, @5: 0.1725, @10: 0.1975)

Train epoch:32, time: 384.945822(s), rec_loss: 4.8732, tra_kl_loss: 6.3017, time_kl_loss: 2.5001, dis_kl_loss: 4.7769, contra_loss: 9289.7690
Test epoch:32, time: 397.791909(s), Recall (@2: 0.1533, @5: 0.2460, @10: 0.3200), NDCG (@2: 0.1336, @5: 0.1755, @10: 0.1992)

Train epoch:33, time: 397.791909(s), rec_loss: 4.8632, tra_kl_loss: 6.3042, time_kl_loss: 2.4788, dis_kl_loss: 4.7762, contra_loss: 8983.3082
Test epoch:33, time: 410.508694(s), Recall (@2: 0.1473, @5: 0.2337, @10: 0.3072), NDCG (@2: 0.1286, @5: 0.1677, @10: 0.1915)

Train epoch:34, time: 410.508694(s), rec_loss: 4.8589, tra_kl_loss: 6.2116, time_kl_loss: 2.6097, dis_kl_loss: 4.7543, contra_loss: 8683.0160
Test epoch:34, time: 423.185761(s), Recall (@2: 0.1503, @5: 0.2339, @10: 0.3072), NDCG (@2: 0.1315, @5: 0.1688, @10: 0.1925)

Train epoch:35, time: 423.185761(s), rec_loss: 4.8407, tra_kl_loss: 6.2518, time_kl_loss: 2.4928, dis_kl_loss: 4.7608, contra_loss: 8303.2850
Test epoch:35, time: 435.603840(s), Recall (@2: 0.1643, @5: 0.2512, @10: 0.3241), NDCG (@2: 0.1427, @5: 0.1819, @10: 0.2053)

Train epoch:36, time: 435.603840(s), rec_loss: 4.8367, tra_kl_loss: 6.2564, time_kl_loss: 2.4223, dis_kl_loss: 4.7583, contra_loss: 8380.0946
Test epoch:36, time: 448.112580(s), Recall (@2: 0.1522, @5: 0.2376, @10: 0.3124), NDCG (@2: 0.1340, @5: 0.1726, @10: 0.1967)

Train epoch:37, time: 448.112580(s), rec_loss: 4.8266, tra_kl_loss: 6.1239, time_kl_loss: 2.5908, dis_kl_loss: 4.7297, contra_loss: 7636.5302
Test epoch:37, time: 460.394255(s), Recall (@2: 0.1516, @5: 0.2344, @10: 0.3083), NDCG (@2: 0.1311, @5: 0.1685, @10: 0.1924)

Train epoch:38, time: 460.394255(s), rec_loss: 4.8230, tra_kl_loss: 6.3120, time_kl_loss: 2.5139, dis_kl_loss: 4.7537, contra_loss: 7856.4273
Test epoch:38, time: 472.586860(s), Recall (@2: 0.1559, @5: 0.2361, @10: 0.3122), NDCG (@2: 0.1362, @5: 0.1722, @10: 0.1967)

Train epoch:39, time: 472.586860(s), rec_loss: 4.8059, tra_kl_loss: 6.2782, time_kl_loss: 2.5254, dis_kl_loss: 4.7835, contra_loss: 7516.4126
Test epoch:39, time: 484.822154(s), Recall (@2: 0.1522, @5: 0.2408, @10: 0.3144), NDCG (@2: 0.1330, @5: 0.1731, @10: 0.1967)

Train epoch:40, time: 484.822154(s), rec_loss: 4.7979, tra_kl_loss: 6.2981, time_kl_loss: 2.4926, dis_kl_loss: 4.7869, contra_loss: 7337.2978
Test epoch:40, time: 497.097677(s), Recall (@2: 0.1468, @5: 0.2257, @10: 0.2975), NDCG (@2: 0.1280, @5: 0.1636, @10: 0.1868)

Train epoch:41, time: 497.097677(s), rec_loss: 4.7915, tra_kl_loss: 6.2852, time_kl_loss: 2.5183, dis_kl_loss: 4.7556, contra_loss: 7281.3243
Test epoch:41, time: 509.568534(s), Recall (@2: 0.1537, @5: 0.2404, @10: 0.3131), NDCG (@2: 0.1334, @5: 0.1726, @10: 0.1960)

Train epoch:42, time: 509.568534(s), rec_loss: 4.7934, tra_kl_loss: 6.3242, time_kl_loss: 2.5333, dis_kl_loss: 4.7664, contra_loss: 7140.0000
Test epoch:42, time: 522.339903(s), Recall (@2: 0.1533, @5: 0.2413, @10: 0.3141), NDCG (@2: 0.1340, @5: 0.1733, @10: 0.1968)

Train epoch:43, time: 522.339903(s), rec_loss: 4.7732, tra_kl_loss: 6.2765, time_kl_loss: 2.5843, dis_kl_loss: 4.7427, contra_loss: 6902.0950
Test epoch:43, time: 534.688431(s), Recall (@2: 0.1490, @5: 0.2322, @10: 0.3031), NDCG (@2: 0.1308, @5: 0.1681, @10: 0.1910)

Train epoch:44, time: 534.688431(s), rec_loss: 4.7724, tra_kl_loss: 6.3221, time_kl_loss: 2.6155, dis_kl_loss: 4.7502, contra_loss: 6817.7865
Test epoch:44, time: 547.036521(s), Recall (@2: 0.1516, @5: 0.2385, @10: 0.3129), NDCG (@2: 0.1323, @5: 0.1715, @10: 0.1955)

Train epoch:45, time: 547.036521(s), rec_loss: 4.7704, tra_kl_loss: 6.2881, time_kl_loss: 2.5946, dis_kl_loss: 4.7622, contra_loss: 6707.6951
Test epoch:45, time: 560.256895(s), Recall (@2: 0.1486, @5: 0.2354, @10: 0.3085), NDCG (@2: 0.1300, @5: 0.1696, @10: 0.1931)

Train epoch:46, time: 560.256895(s), rec_loss: 4.7566, tra_kl_loss: 6.1471, time_kl_loss: 2.6243, dis_kl_loss: 4.7896, contra_loss: 6437.8322
Test epoch:46, time: 572.720923(s), Recall (@2: 0.1542, @5: 0.2439, @10: 0.3120), NDCG (@2: 0.1354, @5: 0.1753, @10: 0.1973)

Train epoch:47, time: 572.720923(s), rec_loss: 4.7505, tra_kl_loss: 6.2663, time_kl_loss: 2.5958, dis_kl_loss: 4.7666, contra_loss: 6400.2099
Test epoch:47, time: 585.320898(s), Recall (@2: 0.1572, @5: 0.2462, @10: 0.3163), NDCG (@2: 0.1366, @5: 0.1767, @10: 0.1994)

Train epoch:48, time: 585.320898(s), rec_loss: 4.7456, tra_kl_loss: 6.3363, time_kl_loss: 2.6224, dis_kl_loss: 4.7644, contra_loss: 6482.2010
Test epoch:48, time: 597.933969(s), Recall (@2: 0.1507, @5: 0.2318, @10: 0.3044), NDCG (@2: 0.1320, @5: 0.1685, @10: 0.1920)

Train epoch:49, time: 597.933969(s), rec_loss: 4.7401, tra_kl_loss: 6.2408, time_kl_loss: 2.6037, dis_kl_loss: 4.7387, contra_loss: 6228.9809
Test epoch:49, time: 610.789292(s), Recall (@2: 0.1542, @5: 0.2370, @10: 0.3053), NDCG (@2: 0.1355, @5: 0.1728, @10: 0.1949)

Train epoch:50, time: 610.789292(s), rec_loss: 4.7309, tra_kl_loss: 6.2144, time_kl_loss: 2.6796, dis_kl_loss: 4.7557, contra_loss: 6313.7677
Test epoch:50, time: 623.407985(s), Recall (@2: 0.1531, @5: 0.2376, @10: 0.3133), NDCG (@2: 0.1334, @5: 0.1713, @10: 0.1956)
