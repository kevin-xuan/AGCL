dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:3
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.4
tem_delta:0.0
dis_delta:0.0
valid_epoch:1
device:cuda:3
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0994, tra_kl_loss: 7.1343, time_kl_loss: 6.0741, dis_kl_loss: 6.0492, contra_loss: 15787.5904
Test epoch:1, time: 13.784705(s), Recall (@2: 0.1085, @5: 0.1626, @10: 0.2201), NDCG (@2: 0.0956, @5: 0.1196, @10: 0.1380)

Train epoch:2, time: 13.784705(s), rec_loss: 7.3488, tra_kl_loss: 12.2757, time_kl_loss: 5.7322, dis_kl_loss: 5.7465, contra_loss: 26548.4034
Test epoch:2, time: 26.903292(s), Recall (@2: 0.1130, @5: 0.1925, @10: 0.2533), NDCG (@2: 0.0998, @5: 0.1349, @10: 0.1547)

Train epoch:3, time: 26.903292(s), rec_loss: 6.8011, tra_kl_loss: 12.3616, time_kl_loss: 5.0975, dis_kl_loss: 5.1181, contra_loss: 23950.5840
Test epoch:3, time: 40.008286(s), Recall (@2: 0.1097, @5: 0.1869, @10: 0.2613), NDCG (@2: 0.0955, @5: 0.1300, @10: 0.1539)

Train epoch:4, time: 40.008286(s), rec_loss: 6.4084, tra_kl_loss: 12.4802, time_kl_loss: 4.9330, dis_kl_loss: 4.9498, contra_loss: 23450.1436
Test epoch:4, time: 53.036822(s), Recall (@2: 0.1223, @5: 0.2035, @10: 0.2792), NDCG (@2: 0.1058, @5: 0.1424, @10: 0.1669)

Train epoch:5, time: 53.036822(s), rec_loss: 6.1282, tra_kl_loss: 12.2220, time_kl_loss: 4.8361, dis_kl_loss: 4.8421, contra_loss: 23312.4662
Test epoch:5, time: 65.861709(s), Recall (@2: 0.1233, @5: 0.2063, @10: 0.2775), NDCG (@2: 0.1066, @5: 0.1439, @10: 0.1668)

Train epoch:6, time: 65.861709(s), rec_loss: 5.9327, tra_kl_loss: 12.4864, time_kl_loss: 4.8117, dis_kl_loss: 4.7878, contra_loss: 21689.9695
Test epoch:6, time: 78.567853(s), Recall (@2: 0.1373, @5: 0.2197, @10: 0.2958), NDCG (@2: 0.1168, @5: 0.1539, @10: 0.1785)

Train epoch:7, time: 78.567853(s), rec_loss: 5.7831, tra_kl_loss: 12.0558, time_kl_loss: 4.7708, dis_kl_loss: 4.8200, contra_loss: 19242.6415
Test epoch:7, time: 91.546185(s), Recall (@2: 0.1367, @5: 0.2247, @10: 0.2984), NDCG (@2: 0.1173, @5: 0.1568, @10: 0.1805)

Train epoch:8, time: 91.546185(s), rec_loss: 5.6558, tra_kl_loss: 12.0517, time_kl_loss: 4.7710, dis_kl_loss: 4.7890, contra_loss: 17550.2472
Test epoch:8, time: 104.813473(s), Recall (@2: 0.1412, @5: 0.2288, @10: 0.3014), NDCG (@2: 0.1207, @5: 0.1599, @10: 0.1833)

Train epoch:9, time: 104.813473(s), rec_loss: 5.5531, tra_kl_loss: 12.1564, time_kl_loss: 4.7478, dis_kl_loss: 4.7930, contra_loss: 16469.4297
Test epoch:9, time: 117.529248(s), Recall (@2: 0.1455, @5: 0.2346, @10: 0.3057), NDCG (@2: 0.1250, @5: 0.1649, @10: 0.1879)

Train epoch:10, time: 117.529248(s), rec_loss: 5.4639, tra_kl_loss: 12.1685, time_kl_loss: 4.7764, dis_kl_loss: 4.7257, contra_loss: 14585.6883
Test epoch:10, time: 130.406222(s), Recall (@2: 0.1436, @5: 0.2273, @10: 0.3036), NDCG (@2: 0.1231, @5: 0.1607, @10: 0.1854)

Train epoch:11, time: 130.406222(s), rec_loss: 5.3888, tra_kl_loss: 12.1509, time_kl_loss: 4.7450, dis_kl_loss: 4.6954, contra_loss: 14645.9925
Test epoch:11, time: 143.152857(s), Recall (@2: 0.1436, @5: 0.2370, @10: 0.3066), NDCG (@2: 0.1246, @5: 0.1666, @10: 0.1890)

Train epoch:12, time: 143.152857(s), rec_loss: 5.3356, tra_kl_loss: 12.1317, time_kl_loss: 4.7167, dis_kl_loss: 4.7142, contra_loss: 13554.6606
Test epoch:12, time: 155.594616(s), Recall (@2: 0.1458, @5: 0.2316, @10: 0.3055), NDCG (@2: 0.1250, @5: 0.1631, @10: 0.1871)

Train epoch:13, time: 155.594616(s), rec_loss: 5.2913, tra_kl_loss: 11.9188, time_kl_loss: 4.7161, dis_kl_loss: 4.6881, contra_loss: 13517.2188
Test epoch:13, time: 168.007079(s), Recall (@2: 0.1529, @5: 0.2458, @10: 0.3230), NDCG (@2: 0.1318, @5: 0.1734, @10: 0.1982)

Train epoch:14, time: 168.007079(s), rec_loss: 5.2470, tra_kl_loss: 11.4463, time_kl_loss: 4.6869, dis_kl_loss: 4.6781, contra_loss: 13721.3292
Test epoch:14, time: 180.500565(s), Recall (@2: 0.1496, @5: 0.2367, @10: 0.3129), NDCG (@2: 0.1295, @5: 0.1687, @10: 0.1933)

Train epoch:15, time: 180.500565(s), rec_loss: 5.2041, tra_kl_loss: 11.6248, time_kl_loss: 4.6756, dis_kl_loss: 4.6660, contra_loss: 12948.7627
Test epoch:15, time: 192.769228(s), Recall (@2: 0.1490, @5: 0.2335, @10: 0.3122), NDCG (@2: 0.1285, @5: 0.1664, @10: 0.1918)

Train epoch:16, time: 192.769228(s), rec_loss: 5.1727, tra_kl_loss: 11.9392, time_kl_loss: 4.6770, dis_kl_loss: 4.6681, contra_loss: 13376.4849
Test epoch:16, time: 205.083054(s), Recall (@2: 0.1539, @5: 0.2432, @10: 0.3122), NDCG (@2: 0.1333, @5: 0.1733, @10: 0.1957)

Train epoch:17, time: 205.083054(s), rec_loss: 5.1328, tra_kl_loss: 11.8071, time_kl_loss: 4.6800, dis_kl_loss: 4.6752, contra_loss: 13295.2788
Test epoch:17, time: 217.355279(s), Recall (@2: 0.1591, @5: 0.2471, @10: 0.3251), NDCG (@2: 0.1365, @5: 0.1761, @10: 0.2012)

Train epoch:18, time: 217.355279(s), rec_loss: 5.1037, tra_kl_loss: 11.8056, time_kl_loss: 4.6901, dis_kl_loss: 4.7003, contra_loss: 13284.4021
Test epoch:18, time: 230.112028(s), Recall (@2: 0.1585, @5: 0.2451, @10: 0.3195), NDCG (@2: 0.1363, @5: 0.1750, @10: 0.1990)

Train epoch:19, time: 230.112028(s), rec_loss: 5.0729, tra_kl_loss: 11.4567, time_kl_loss: 4.6337, dis_kl_loss: 4.6773, contra_loss: 12669.5033
Test epoch:19, time: 242.806846(s), Recall (@2: 0.1567, @5: 0.2475, @10: 0.3206), NDCG (@2: 0.1352, @5: 0.1759, @10: 0.1996)

Train epoch:20, time: 242.806846(s), rec_loss: 5.0565, tra_kl_loss: 11.4467, time_kl_loss: 4.6931, dis_kl_loss: 4.6656, contra_loss: 12555.4971
Test epoch:20, time: 255.822935(s), Recall (@2: 0.1527, @5: 0.2413, @10: 0.3206), NDCG (@2: 0.1320, @5: 0.1715, @10: 0.1972)

Train epoch:21, time: 255.822935(s), rec_loss: 5.0181, tra_kl_loss: 11.5190, time_kl_loss: 4.6748, dis_kl_loss: 4.6557, contra_loss: 13007.3256
Test epoch:21, time: 268.535737(s), Recall (@2: 0.1604, @5: 0.2499, @10: 0.3262), NDCG (@2: 0.1392, @5: 0.1789, @10: 0.2036)

Train epoch:22, time: 268.535737(s), rec_loss: 4.9978, tra_kl_loss: 11.7789, time_kl_loss: 4.6400, dis_kl_loss: 4.6474, contra_loss: 13098.4909
Test epoch:22, time: 281.252499(s), Recall (@2: 0.1617, @5: 0.2475, @10: 0.3256), NDCG (@2: 0.1396, @5: 0.1780, @10: 0.2033)

Train epoch:23, time: 281.252499(s), rec_loss: 4.9876, tra_kl_loss: 11.5601, time_kl_loss: 4.6523, dis_kl_loss: 4.6595, contra_loss: 12844.6127
Test epoch:23, time: 294.077101(s), Recall (@2: 0.1537, @5: 0.2361, @10: 0.3129), NDCG (@2: 0.1347, @5: 0.1716, @10: 0.1964)

Train epoch:24, time: 294.077101(s), rec_loss: 4.9585, tra_kl_loss: 11.6974, time_kl_loss: 4.6519, dis_kl_loss: 4.6497, contra_loss: 12911.1404
Test epoch:24, time: 306.653897(s), Recall (@2: 0.1593, @5: 0.2482, @10: 0.3226), NDCG (@2: 0.1386, @5: 0.1787, @10: 0.2028)

Train epoch:25, time: 306.653897(s), rec_loss: 4.9442, tra_kl_loss: 11.8920, time_kl_loss: 4.6689, dis_kl_loss: 4.6584, contra_loss: 12732.3481
Test epoch:25, time: 319.329327(s), Recall (@2: 0.1548, @5: 0.2443, @10: 0.3152), NDCG (@2: 0.1355, @5: 0.1758, @10: 0.1989)

Train epoch:26, time: 319.329327(s), rec_loss: 4.9265, tra_kl_loss: 11.7612, time_kl_loss: 4.6636, dis_kl_loss: 4.6778, contra_loss: 12598.5099
Test epoch:26, time: 332.298402(s), Recall (@2: 0.1468, @5: 0.2268, @10: 0.3047), NDCG (@2: 0.1296, @5: 0.1658, @10: 0.1910)

Train epoch:27, time: 332.298402(s), rec_loss: 4.9115, tra_kl_loss: 11.6796, time_kl_loss: 4.6433, dis_kl_loss: 4.6421, contra_loss: 11949.0313
Test epoch:27, time: 344.853207(s), Recall (@2: 0.1701, @5: 0.2622, @10: 0.3323), NDCG (@2: 0.1461, @5: 0.1874, @10: 0.2101)

Train epoch:28, time: 344.853207(s), rec_loss: 4.9070, tra_kl_loss: 11.6734, time_kl_loss: 4.6665, dis_kl_loss: 4.6600, contra_loss: 11560.0800
Test epoch:28, time: 357.432585(s), Recall (@2: 0.1555, @5: 0.2281, @10: 0.3096), NDCG (@2: 0.1351, @5: 0.1677, @10: 0.1939)

Train epoch:29, time: 357.432585(s), rec_loss: 4.8829, tra_kl_loss: 11.6198, time_kl_loss: 4.6944, dis_kl_loss: 4.6556, contra_loss: 11673.6762
Test epoch:29, time: 370.530436(s), Recall (@2: 0.1589, @5: 0.2475, @10: 0.3208), NDCG (@2: 0.1380, @5: 0.1777, @10: 0.2013)

Train epoch:30, time: 370.530436(s), rec_loss: 4.8689, tra_kl_loss: 11.7593, time_kl_loss: 4.6599, dis_kl_loss: 4.6416, contra_loss: 12223.9913
Test epoch:30, time: 383.286012(s), Recall (@2: 0.1548, @5: 0.2434, @10: 0.3165), NDCG (@2: 0.1356, @5: 0.1755, @10: 0.1992)

Train epoch:31, time: 383.286012(s), rec_loss: 4.8500, tra_kl_loss: 11.7355, time_kl_loss: 4.6411, dis_kl_loss: 4.6545, contra_loss: 11636.4376
Test epoch:31, time: 396.155860(s), Recall (@2: 0.1533, @5: 0.2357, @10: 0.3109), NDCG (@2: 0.1356, @5: 0.1725, @10: 0.1968)

Train epoch:32, time: 396.155860(s), rec_loss: 4.8435, tra_kl_loss: 11.8958, time_kl_loss: 4.6703, dis_kl_loss: 4.6562, contra_loss: 11452.6407
Test epoch:32, time: 408.684056(s), Recall (@2: 0.1546, @5: 0.2385, @10: 0.3120), NDCG (@2: 0.1342, @5: 0.1715, @10: 0.1955)

Train epoch:33, time: 408.684056(s), rec_loss: 4.8322, tra_kl_loss: 11.6071, time_kl_loss: 4.6665, dis_kl_loss: 4.6498, contra_loss: 11782.3395
Test epoch:33, time: 421.044575(s), Recall (@2: 0.1509, @5: 0.2316, @10: 0.3023), NDCG (@2: 0.1332, @5: 0.1696, @10: 0.1926)

Train epoch:34, time: 421.044575(s), rec_loss: 4.8210, tra_kl_loss: 11.4341, time_kl_loss: 4.6788, dis_kl_loss: 4.6419, contra_loss: 11209.0519
Test epoch:34, time: 433.649376(s), Recall (@2: 0.1505, @5: 0.2339, @10: 0.3081), NDCG (@2: 0.1316, @5: 0.1692, @10: 0.1932)

Train epoch:35, time: 433.649376(s), rec_loss: 4.8078, tra_kl_loss: 11.7389, time_kl_loss: 4.6440, dis_kl_loss: 4.6459, contra_loss: 10615.0780
Test epoch:35, time: 446.143989(s), Recall (@2: 0.1602, @5: 0.2469, @10: 0.3226), NDCG (@2: 0.1409, @5: 0.1797, @10: 0.2040)

Train epoch:36, time: 446.143989(s), rec_loss: 4.8036, tra_kl_loss: 11.4269, time_kl_loss: 4.6221, dis_kl_loss: 4.6697, contra_loss: 11214.0244
Test epoch:36, time: 459.289728(s), Recall (@2: 0.1524, @5: 0.2376, @10: 0.3126), NDCG (@2: 0.1333, @5: 0.1713, @10: 0.1955)

Train epoch:37, time: 459.289728(s), rec_loss: 4.7847, tra_kl_loss: 11.6614, time_kl_loss: 4.6334, dis_kl_loss: 4.6512, contra_loss: 10710.9409
Test epoch:37, time: 472.027186(s), Recall (@2: 0.1514, @5: 0.2378, @10: 0.3135), NDCG (@2: 0.1315, @5: 0.1701, @10: 0.1945)

Train epoch:38, time: 472.027186(s), rec_loss: 4.7818, tra_kl_loss: 11.6211, time_kl_loss: 4.6762, dis_kl_loss: 4.6415, contra_loss: 10650.4604
Test epoch:38, time: 484.935373(s), Recall (@2: 0.1516, @5: 0.2361, @10: 0.3060), NDCG (@2: 0.1338, @5: 0.1717, @10: 0.1945)

Train epoch:39, time: 484.935373(s), rec_loss: 4.7632, tra_kl_loss: 11.6941, time_kl_loss: 4.6337, dis_kl_loss: 4.6808, contra_loss: 9912.5101
Test epoch:39, time: 497.801889(s), Recall (@2: 0.1561, @5: 0.2380, @10: 0.3126), NDCG (@2: 0.1356, @5: 0.1722, @10: 0.1962)

Train epoch:40, time: 497.801889(s), rec_loss: 4.7560, tra_kl_loss: 11.5215, time_kl_loss: 4.6677, dis_kl_loss: 4.6685, contra_loss: 9778.5742
Test epoch:40, time: 510.875197(s), Recall (@2: 0.1518, @5: 0.2257, @10: 0.3019), NDCG (@2: 0.1333, @5: 0.1666, @10: 0.1913)

Train epoch:41, time: 510.875197(s), rec_loss: 4.7537, tra_kl_loss: 11.3332, time_kl_loss: 4.6603, dis_kl_loss: 4.6590, contra_loss: 9762.5297
Test epoch:41, time: 524.287165(s), Recall (@2: 0.1520, @5: 0.2404, @10: 0.3129), NDCG (@2: 0.1346, @5: 0.1739, @10: 0.1973)

Train epoch:42, time: 524.287165(s), rec_loss: 4.7544, tra_kl_loss: 11.2361, time_kl_loss: 4.6733, dis_kl_loss: 4.6625, contra_loss: 9601.3794
Test epoch:42, time: 537.320010(s), Recall (@2: 0.1511, @5: 0.2346, @10: 0.3105), NDCG (@2: 0.1340, @5: 0.1713, @10: 0.1959)

Train epoch:43, time: 537.320010(s), rec_loss: 4.7368, tra_kl_loss: 11.7937, time_kl_loss: 4.7129, dis_kl_loss: 4.6485, contra_loss: 9456.4680
Test epoch:43, time: 550.887978(s), Recall (@2: 0.1544, @5: 0.2333, @10: 0.3049), NDCG (@2: 0.1365, @5: 0.1718, @10: 0.1949)

Train epoch:44, time: 550.887978(s), rec_loss: 4.7319, tra_kl_loss: 11.8820, time_kl_loss: 4.6775, dis_kl_loss: 4.6905, contra_loss: 9173.3018
Test epoch:44, time: 564.208374(s), Recall (@2: 0.1550, @5: 0.2294, @10: 0.3064), NDCG (@2: 0.1355, @5: 0.1686, @10: 0.1936)

Train epoch:45, time: 564.208374(s), rec_loss: 4.7306, tra_kl_loss: 11.6161, time_kl_loss: 4.6638, dis_kl_loss: 4.6491, contra_loss: 8941.4072
Test epoch:45, time: 577.735067(s), Recall (@2: 0.1535, @5: 0.2305, @10: 0.3049), NDCG (@2: 0.1337, @5: 0.1682, @10: 0.1922)

Train epoch:46, time: 577.735067(s), rec_loss: 4.7184, tra_kl_loss: 11.6843, time_kl_loss: 4.6614, dis_kl_loss: 4.6785, contra_loss: 8895.1238
Test epoch:46, time: 591.060521(s), Recall (@2: 0.1524, @5: 0.2344, @10: 0.3085), NDCG (@2: 0.1334, @5: 0.1700, @10: 0.1941)

Train epoch:47, time: 591.060521(s), rec_loss: 4.7139, tra_kl_loss: 11.4468, time_kl_loss: 4.6728, dis_kl_loss: 4.7065, contra_loss: 8667.4644
Test epoch:47, time: 604.772879(s), Recall (@2: 0.1539, @5: 0.2382, @10: 0.3109), NDCG (@2: 0.1355, @5: 0.1733, @10: 0.1968)

Train epoch:48, time: 604.772879(s), rec_loss: 4.7050, tra_kl_loss: 11.6615, time_kl_loss: 4.6857, dis_kl_loss: 4.6771, contra_loss: 8805.0963
Test epoch:48, time: 617.037072(s), Recall (@2: 0.1563, @5: 0.2326, @10: 0.3081), NDCG (@2: 0.1384, @5: 0.1725, @10: 0.1970)

Train epoch:49, time: 617.037072(s), rec_loss: 4.7012, tra_kl_loss: 11.9134, time_kl_loss: 4.7061, dis_kl_loss: 4.6576, contra_loss: 8919.1383
Test epoch:49, time: 629.036449(s), Recall (@2: 0.1617, @5: 0.2426, @10: 0.3172), NDCG (@2: 0.1418, @5: 0.1780, @10: 0.2020)

Train epoch:50, time: 629.036449(s), rec_loss: 4.6896, tra_kl_loss: 11.4481, time_kl_loss: 4.6877, dis_kl_loss: 4.6635, contra_loss: 8641.6784
Test epoch:50, time: 641.077506(s), Recall (@2: 0.1505, @5: 0.2242, @10: 0.2950), NDCG (@2: 0.1329, @5: 0.1656, @10: 0.1883)
