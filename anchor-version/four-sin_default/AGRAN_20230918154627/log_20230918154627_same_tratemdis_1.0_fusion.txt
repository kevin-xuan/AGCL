dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:0
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.0
dis_delta:0.0
valid_epoch:1
device:cuda:0
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0943, tra_kl_loss: 6.6441, time_kl_loss: 5.9625, dis_kl_loss: 5.9512, contra_loss: 14437.8171
Test epoch:1, time: 11.325332(s), Recall (@2: 0.1117, @5: 0.1645, @10: 0.2171), NDCG (@2: 0.0978, @5: 0.1215, @10: 0.1385)

Train epoch:2, time: 11.325332(s), rec_loss: 7.3501, tra_kl_loss: 7.3951, time_kl_loss: 5.8308, dis_kl_loss: 5.8236, contra_loss: 28482.3296
Test epoch:2, time: 22.313115(s), Recall (@2: 0.1113, @5: 0.1919, @10: 0.2510), NDCG (@2: 0.0971, @5: 0.1327, @10: 0.1521)

Train epoch:3, time: 22.313115(s), rec_loss: 6.8465, tra_kl_loss: 6.8145, time_kl_loss: 5.1569, dis_kl_loss: 5.1463, contra_loss: 29519.0247
Test epoch:3, time: 33.583302(s), Recall (@2: 0.1119, @5: 0.1803, @10: 0.2529), NDCG (@2: 0.0978, @5: 0.1284, @10: 0.1517)

Train epoch:4, time: 33.583302(s), rec_loss: 6.4833, tra_kl_loss: 6.5862, time_kl_loss: 4.9196, dis_kl_loss: 4.9221, contra_loss: 28551.9446
Test epoch:4, time: 45.100218(s), Recall (@2: 0.1238, @5: 0.2076, @10: 0.2796), NDCG (@2: 0.1073, @5: 0.1445, @10: 0.1677)

Train epoch:5, time: 45.100218(s), rec_loss: 6.2084, tra_kl_loss: 6.5106, time_kl_loss: 4.8878, dis_kl_loss: 4.8847, contra_loss: 27526.7276
Test epoch:5, time: 56.543046(s), Recall (@2: 0.1266, @5: 0.2089, @10: 0.2788), NDCG (@2: 0.1089, @5: 0.1455, @10: 0.1680)

Train epoch:6, time: 56.543046(s), rec_loss: 5.9911, tra_kl_loss: 6.4413, time_kl_loss: 4.8139, dis_kl_loss: 4.8095, contra_loss: 25681.9132
Test epoch:6, time: 67.722415(s), Recall (@2: 0.1322, @5: 0.2167, @10: 0.2909), NDCG (@2: 0.1143, @5: 0.1522, @10: 0.1763)

Train epoch:7, time: 67.722415(s), rec_loss: 5.8079, tra_kl_loss: 6.4751, time_kl_loss: 4.8074, dis_kl_loss: 4.8090, contra_loss: 25317.1669
Test epoch:7, time: 78.852387(s), Recall (@2: 0.1350, @5: 0.2199, @10: 0.2952), NDCG (@2: 0.1159, @5: 0.1542, @10: 0.1784)

Train epoch:8, time: 78.852387(s), rec_loss: 5.6599, tra_kl_loss: 6.4595, time_kl_loss: 4.8035, dis_kl_loss: 4.8008, contra_loss: 23412.1305
Test epoch:8, time: 90.159093(s), Recall (@2: 0.1382, @5: 0.2268, @10: 0.3060), NDCG (@2: 0.1186, @5: 0.1585, @10: 0.1841)

Train epoch:9, time: 90.159093(s), rec_loss: 5.5494, tra_kl_loss: 6.4233, time_kl_loss: 4.7858, dis_kl_loss: 4.7816, contra_loss: 22753.2657
Test epoch:9, time: 101.534925(s), Recall (@2: 0.1436, @5: 0.2273, @10: 0.3034), NDCG (@2: 0.1229, @5: 0.1606, @10: 0.1850)

Train epoch:10, time: 101.534925(s), rec_loss: 5.4402, tra_kl_loss: 6.3343, time_kl_loss: 4.7217, dis_kl_loss: 4.7198, contra_loss: 20471.0340
Test epoch:10, time: 112.985859(s), Recall (@2: 0.1453, @5: 0.2296, @10: 0.2980), NDCG (@2: 0.1243, @5: 0.1623, @10: 0.1844)

Train epoch:11, time: 112.985859(s), rec_loss: 5.3656, tra_kl_loss: 6.3749, time_kl_loss: 4.7638, dis_kl_loss: 4.7623, contra_loss: 20896.9265
Test epoch:11, time: 124.149298(s), Recall (@2: 0.1455, @5: 0.2305, @10: 0.3083), NDCG (@2: 0.1258, @5: 0.1639, @10: 0.1890)

Train epoch:12, time: 124.149298(s), rec_loss: 5.3020, tra_kl_loss: 6.3116, time_kl_loss: 4.7103, dis_kl_loss: 4.7054, contra_loss: 19488.5635
Test epoch:12, time: 135.759409(s), Recall (@2: 0.1466, @5: 0.2329, @10: 0.3021), NDCG (@2: 0.1259, @5: 0.1647, @10: 0.1871)

Train epoch:13, time: 135.759409(s), rec_loss: 5.2448, tra_kl_loss: 6.3645, time_kl_loss: 4.7257, dis_kl_loss: 4.7262, contra_loss: 19430.1875
Test epoch:13, time: 147.131094(s), Recall (@2: 0.1483, @5: 0.2372, @10: 0.3083), NDCG (@2: 0.1269, @5: 0.1667, @10: 0.1897)

Train epoch:14, time: 147.131094(s), rec_loss: 5.1958, tra_kl_loss: 6.3393, time_kl_loss: 4.6833, dis_kl_loss: 4.6781, contra_loss: 19078.6431
Test epoch:14, time: 158.710915(s), Recall (@2: 0.1466, @5: 0.2316, @10: 0.3021), NDCG (@2: 0.1270, @5: 0.1650, @10: 0.1879)

Train epoch:15, time: 158.710915(s), rec_loss: 5.1527, tra_kl_loss: 6.2666, time_kl_loss: 4.6840, dis_kl_loss: 4.6826, contra_loss: 18579.5688
Test epoch:15, time: 170.354437(s), Recall (@2: 0.1453, @5: 0.2329, @10: 0.3012), NDCG (@2: 0.1260, @5: 0.1650, @10: 0.1870)

Train epoch:16, time: 170.354437(s), rec_loss: 5.1220, tra_kl_loss: 6.2837, time_kl_loss: 4.6714, dis_kl_loss: 4.6679, contra_loss: 18065.4891
Test epoch:16, time: 181.878582(s), Recall (@2: 0.1470, @5: 0.2357, @10: 0.3077), NDCG (@2: 0.1275, @5: 0.1672, @10: 0.1904)

Train epoch:17, time: 181.878582(s), rec_loss: 5.0805, tra_kl_loss: 6.2894, time_kl_loss: 4.7292, dis_kl_loss: 4.7274, contra_loss: 17854.3889
Test epoch:17, time: 193.570818(s), Recall (@2: 0.1511, @5: 0.2462, @10: 0.3150), NDCG (@2: 0.1312, @5: 0.1739, @10: 0.1962)

Train epoch:18, time: 193.570818(s), rec_loss: 5.0565, tra_kl_loss: 6.4029, time_kl_loss: 4.7155, dis_kl_loss: 4.7135, contra_loss: 18029.7152
Test epoch:18, time: 205.029440(s), Recall (@2: 0.1505, @5: 0.2398, @10: 0.3118), NDCG (@2: 0.1308, @5: 0.1707, @10: 0.1938)

Train epoch:19, time: 205.029440(s), rec_loss: 5.0258, tra_kl_loss: 6.1860, time_kl_loss: 4.6156, dis_kl_loss: 4.6159, contra_loss: 17426.5413
Test epoch:19, time: 216.523065(s), Recall (@2: 0.1524, @5: 0.2434, @10: 0.3204), NDCG (@2: 0.1322, @5: 0.1726, @10: 0.1974)

Train epoch:20, time: 216.523065(s), rec_loss: 5.0048, tra_kl_loss: 6.3524, time_kl_loss: 4.6533, dis_kl_loss: 4.6519, contra_loss: 17680.7009
Test epoch:20, time: 227.794611(s), Recall (@2: 0.1475, @5: 0.2398, @10: 0.3131), NDCG (@2: 0.1288, @5: 0.1702, @10: 0.1937)

Train epoch:21, time: 227.794611(s), rec_loss: 4.9774, tra_kl_loss: 6.3892, time_kl_loss: 4.6185, dis_kl_loss: 4.6185, contra_loss: 17729.8103
Test epoch:21, time: 239.290229(s), Recall (@2: 0.1529, @5: 0.2393, @10: 0.3141), NDCG (@2: 0.1346, @5: 0.1731, @10: 0.1974)

Train epoch:22, time: 239.290229(s), rec_loss: 4.9551, tra_kl_loss: 6.3226, time_kl_loss: 4.6281, dis_kl_loss: 4.6304, contra_loss: 16897.4099
Test epoch:22, time: 250.511972(s), Recall (@2: 0.1570, @5: 0.2544, @10: 0.3249), NDCG (@2: 0.1374, @5: 0.1809, @10: 0.2038)

Train epoch:23, time: 250.511972(s), rec_loss: 4.9433, tra_kl_loss: 6.3794, time_kl_loss: 4.6886, dis_kl_loss: 4.6908, contra_loss: 18231.9714
Test epoch:23, time: 261.858302(s), Recall (@2: 0.1477, @5: 0.2378, @10: 0.3077), NDCG (@2: 0.1283, @5: 0.1690, @10: 0.1915)

Train epoch:24, time: 261.858302(s), rec_loss: 4.9140, tra_kl_loss: 6.2172, time_kl_loss: 4.6320, dis_kl_loss: 4.6283, contra_loss: 17198.3913
Test epoch:24, time: 273.273841(s), Recall (@2: 0.1537, @5: 0.2428, @10: 0.3185), NDCG (@2: 0.1349, @5: 0.1746, @10: 0.1991)

Train epoch:25, time: 273.273841(s), rec_loss: 4.9031, tra_kl_loss: 6.4650, time_kl_loss: 4.6824, dis_kl_loss: 4.6853, contra_loss: 17995.4424
Test epoch:25, time: 284.445070(s), Recall (@2: 0.1520, @5: 0.2389, @10: 0.3185), NDCG (@2: 0.1330, @5: 0.1719, @10: 0.1976)

Train epoch:26, time: 284.445070(s), rec_loss: 4.8885, tra_kl_loss: 6.3171, time_kl_loss: 4.6366, dis_kl_loss: 4.6327, contra_loss: 17284.2170
Test epoch:26, time: 295.673296(s), Recall (@2: 0.1423, @5: 0.2273, @10: 0.2975), NDCG (@2: 0.1261, @5: 0.1640, @10: 0.1867)

Train epoch:27, time: 295.673296(s), rec_loss: 4.8729, tra_kl_loss: 6.3180, time_kl_loss: 4.6901, dis_kl_loss: 4.6867, contra_loss: 17157.6634
Test epoch:27, time: 306.915216(s), Recall (@2: 0.1660, @5: 0.2639, @10: 0.3340), NDCG (@2: 0.1436, @5: 0.1876, @10: 0.2102)

Train epoch:28, time: 306.915216(s), rec_loss: 4.8664, tra_kl_loss: 6.3344, time_kl_loss: 4.6779, dis_kl_loss: 4.6732, contra_loss: 17454.8159
Test epoch:28, time: 318.331868(s), Recall (@2: 0.1475, @5: 0.2311, @10: 0.3038), NDCG (@2: 0.1296, @5: 0.1671, @10: 0.1906)

Train epoch:29, time: 318.331868(s), rec_loss: 4.8453, tra_kl_loss: 6.2811, time_kl_loss: 4.6701, dis_kl_loss: 4.6659, contra_loss: 17378.8964
Test epoch:29, time: 329.777665(s), Recall (@2: 0.1503, @5: 0.2423, @10: 0.3129), NDCG (@2: 0.1315, @5: 0.1730, @10: 0.1960)

Train epoch:30, time: 329.777665(s), rec_loss: 4.8334, tra_kl_loss: 6.3455, time_kl_loss: 4.6693, dis_kl_loss: 4.6702, contra_loss: 17085.4320
Test epoch:30, time: 341.004508(s), Recall (@2: 0.1552, @5: 0.2490, @10: 0.3159), NDCG (@2: 0.1365, @5: 0.1786, @10: 0.2001)

Train epoch:31, time: 341.004508(s), rec_loss: 4.8204, tra_kl_loss: 6.2826, time_kl_loss: 4.5792, dis_kl_loss: 4.5730, contra_loss: 17114.7068
Test epoch:31, time: 352.490147(s), Recall (@2: 0.1494, @5: 0.2352, @10: 0.3094), NDCG (@2: 0.1310, @5: 0.1696, @10: 0.1936)

Train epoch:32, time: 352.490147(s), rec_loss: 4.8074, tra_kl_loss: 6.3403, time_kl_loss: 4.6729, dis_kl_loss: 4.6751, contra_loss: 16854.0119
Test epoch:32, time: 364.025833(s), Recall (@2: 0.1483, @5: 0.2342, @10: 0.3070), NDCG (@2: 0.1314, @5: 0.1699, @10: 0.1935)

Train epoch:33, time: 364.025833(s), rec_loss: 4.8000, tra_kl_loss: 6.3328, time_kl_loss: 4.5873, dis_kl_loss: 4.5860, contra_loss: 16528.7506
Test epoch:33, time: 375.321606(s), Recall (@2: 0.1466, @5: 0.2288, @10: 0.2965), NDCG (@2: 0.1285, @5: 0.1656, @10: 0.1872)

Train epoch:34, time: 375.321606(s), rec_loss: 4.7882, tra_kl_loss: 6.2666, time_kl_loss: 4.6513, dis_kl_loss: 4.6515, contra_loss: 15988.1008
Test epoch:34, time: 386.771745(s), Recall (@2: 0.1449, @5: 0.2288, @10: 0.2928), NDCG (@2: 0.1276, @5: 0.1651, @10: 0.1857)

Train epoch:35, time: 386.771745(s), rec_loss: 4.7745, tra_kl_loss: 6.2735, time_kl_loss: 4.6574, dis_kl_loss: 4.6557, contra_loss: 15696.4582
Test epoch:35, time: 398.241059(s), Recall (@2: 0.1531, @5: 0.2423, @10: 0.3141), NDCG (@2: 0.1330, @5: 0.1735, @10: 0.1968)

Train epoch:36, time: 398.241059(s), rec_loss: 4.7700, tra_kl_loss: 6.3077, time_kl_loss: 4.6146, dis_kl_loss: 4.6208, contra_loss: 16253.8901
Test epoch:36, time: 409.735765(s), Recall (@2: 0.1483, @5: 0.2322, @10: 0.3064), NDCG (@2: 0.1296, @5: 0.1675, @10: 0.1915)

Train epoch:37, time: 409.735765(s), rec_loss: 4.7552, tra_kl_loss: 6.1971, time_kl_loss: 4.6466, dis_kl_loss: 4.6470, contra_loss: 14986.8972
Test epoch:37, time: 421.076965(s), Recall (@2: 0.1490, @5: 0.2337, @10: 0.3036), NDCG (@2: 0.1285, @5: 0.1666, @10: 0.1891)

Train epoch:38, time: 421.076965(s), rec_loss: 4.7518, tra_kl_loss: 6.3374, time_kl_loss: 4.6766, dis_kl_loss: 4.6787, contra_loss: 15587.3969
Test epoch:38, time: 432.395597(s), Recall (@2: 0.1479, @5: 0.2346, @10: 0.3049), NDCG (@2: 0.1307, @5: 0.1696, @10: 0.1923)

Train epoch:39, time: 432.395597(s), rec_loss: 4.7337, tra_kl_loss: 6.3234, time_kl_loss: 4.6697, dis_kl_loss: 4.6654, contra_loss: 14924.7432
Test epoch:39, time: 443.733286(s), Recall (@2: 0.1503, @5: 0.2311, @10: 0.3055), NDCG (@2: 0.1308, @5: 0.1672, @10: 0.1913)

Train epoch:40, time: 443.733286(s), rec_loss: 4.7291, tra_kl_loss: 6.2722, time_kl_loss: 4.6582, dis_kl_loss: 4.6552, contra_loss: 14615.5738
Test epoch:40, time: 455.042015(s), Recall (@2: 0.1445, @5: 0.2268, @10: 0.2952), NDCG (@2: 0.1261, @5: 0.1628, @10: 0.1848)

Train epoch:41, time: 455.042015(s), rec_loss: 4.7288, tra_kl_loss: 6.3555, time_kl_loss: 4.6772, dis_kl_loss: 4.6796, contra_loss: 14865.6562
Test epoch:41, time: 466.507802(s), Recall (@2: 0.1488, @5: 0.2331, @10: 0.3049), NDCG (@2: 0.1308, @5: 0.1688, @10: 0.1919)

Train epoch:42, time: 466.507802(s), rec_loss: 4.7217, tra_kl_loss: 6.3789, time_kl_loss: 4.7080, dis_kl_loss: 4.7088, contra_loss: 14808.9828
Test epoch:42, time: 477.739343(s), Recall (@2: 0.1494, @5: 0.2301, @10: 0.3014), NDCG (@2: 0.1305, @5: 0.1663, @10: 0.1893)

Train epoch:43, time: 477.739343(s), rec_loss: 4.7004, tra_kl_loss: 6.3190, time_kl_loss: 4.6271, dis_kl_loss: 4.6291, contra_loss: 13974.3091
Test epoch:43, time: 489.172425(s), Recall (@2: 0.1436, @5: 0.2283, @10: 0.2986), NDCG (@2: 0.1258, @5: 0.1638, @10: 0.1865)

Train epoch:44, time: 489.172425(s), rec_loss: 4.6965, tra_kl_loss: 6.3774, time_kl_loss: 4.5870, dis_kl_loss: 4.5860, contra_loss: 13873.4941
Test epoch:44, time: 500.613394(s), Recall (@2: 0.1477, @5: 0.2294, @10: 0.3049), NDCG (@2: 0.1293, @5: 0.1661, @10: 0.1903)

Train epoch:45, time: 500.613394(s), rec_loss: 4.6910, tra_kl_loss: 6.3003, time_kl_loss: 4.6781, dis_kl_loss: 4.6763, contra_loss: 13363.3286
Test epoch:45, time: 512.130581(s), Recall (@2: 0.1481, @5: 0.2324, @10: 0.3075), NDCG (@2: 0.1320, @5: 0.1699, @10: 0.1943)

Train epoch:46, time: 512.130581(s), rec_loss: 4.6846, tra_kl_loss: 6.2196, time_kl_loss: 4.6715, dis_kl_loss: 4.6676, contra_loss: 13261.8239
Test epoch:46, time: 523.626714(s), Recall (@2: 0.1464, @5: 0.2260, @10: 0.2978), NDCG (@2: 0.1290, @5: 0.1644, @10: 0.1877)

Train epoch:47, time: 523.626714(s), rec_loss: 4.6774, tra_kl_loss: 6.2729, time_kl_loss: 4.5649, dis_kl_loss: 4.5669, contra_loss: 12828.3837
Test epoch:47, time: 535.177988(s), Recall (@2: 0.1533, @5: 0.2417, @10: 0.3133), NDCG (@2: 0.1333, @5: 0.1729, @10: 0.1960)

Train epoch:48, time: 535.177988(s), rec_loss: 4.6653, tra_kl_loss: 6.3355, time_kl_loss: 4.6174, dis_kl_loss: 4.6161, contra_loss: 12899.0188
Test epoch:48, time: 546.623076(s), Recall (@2: 0.1432, @5: 0.2232, @10: 0.3008), NDCG (@2: 0.1261, @5: 0.1619, @10: 0.1870)

Train epoch:49, time: 546.623076(s), rec_loss: 4.6649, tra_kl_loss: 6.3165, time_kl_loss: 4.6677, dis_kl_loss: 4.6679, contra_loss: 12269.9554
Test epoch:49, time: 557.974955(s), Recall (@2: 0.1492, @5: 0.2322, @10: 0.3029), NDCG (@2: 0.1311, @5: 0.1680, @10: 0.1908)

Train epoch:50, time: 557.974955(s), rec_loss: 4.6558, tra_kl_loss: 6.2576, time_kl_loss: 4.6749, dis_kl_loss: 4.6773, contra_loss: 12452.2741
Test epoch:50, time: 569.238620(s), Recall (@2: 0.1451, @5: 0.2316, @10: 0.3038), NDCG (@2: 0.1281, @5: 0.1670, @10: 0.1903)
