dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:0
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
recon_reg:1.0
tra_delta:0.0
tem_delta:0.4
dis_delta:0.0
valid_epoch:1
device:cuda:0
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0672, tra_kl_loss: 6.5883, time_kl_loss: 6.2593, dis_kl_loss: 6.0679, contra_loss: 16943.6131, recon_loss: 0.0000
Test epoch:1, time: 15.571975(s), Recall (@2: 0.0880, @5: 0.1511, @10: 0.2104), NDCG (@2: 0.0791, @5: 0.1071, @10: 0.1263)

Train epoch:2, time: 15.571975(s), rec_loss: 7.2972, tra_kl_loss: 7.0195, time_kl_loss: 8.8376, dis_kl_loss: 5.9289, contra_loss: 26816.7757, recon_loss: 0.0000
Test epoch:2, time: 30.391622(s), Recall (@2: 0.1190, @5: 0.1958, @10: 0.2594), NDCG (@2: 0.1035, @5: 0.1380, @10: 0.1587)

Train epoch:3, time: 30.391622(s), rec_loss: 6.7358, tra_kl_loss: 6.7266, time_kl_loss: 6.4092, dis_kl_loss: 5.3809, contra_loss: 30823.3890, recon_loss: 0.0000
Test epoch:3, time: 45.125909(s), Recall (@2: 0.1158, @5: 0.1912, @10: 0.2628), NDCG (@2: 0.1002, @5: 0.1340, @10: 0.1572)

Train epoch:4, time: 45.125909(s), rec_loss: 6.3593, tra_kl_loss: 6.4851, time_kl_loss: 5.0822, dis_kl_loss: 5.1350, contra_loss: 31615.4547, recon_loss: 0.0000
Test epoch:4, time: 59.989713(s), Recall (@2: 0.1261, @5: 0.2070, @10: 0.2796), NDCG (@2: 0.1086, @5: 0.1450, @10: 0.1684)

Train epoch:5, time: 59.989713(s), rec_loss: 6.0982, tra_kl_loss: 6.4541, time_kl_loss: 4.2991, dis_kl_loss: 4.9984, contra_loss: 30930.7976, recon_loss: 0.0000
Test epoch:5, time: 74.777843(s), Recall (@2: 0.1261, @5: 0.2020, @10: 0.2762), NDCG (@2: 0.1076, @5: 0.1415, @10: 0.1655)

Train epoch:6, time: 74.777843(s), rec_loss: 5.9099, tra_kl_loss: 6.4266, time_kl_loss: 3.9058, dis_kl_loss: 4.9012, contra_loss: 27479.2900, recon_loss: 0.0000
Test epoch:6, time: 89.599164(s), Recall (@2: 0.1350, @5: 0.2165, @10: 0.2922), NDCG (@2: 0.1148, @5: 0.1508, @10: 0.1752)

Train epoch:7, time: 89.599164(s), rec_loss: 5.7608, tra_kl_loss: 6.3790, time_kl_loss: 3.7365, dis_kl_loss: 4.9002, contra_loss: 25601.1165, recon_loss: 0.0000
Test epoch:7, time: 104.852459(s), Recall (@2: 0.1378, @5: 0.2268, @10: 0.2995), NDCG (@2: 0.1187, @5: 0.1586, @10: 0.1820)

Train epoch:8, time: 104.852459(s), rec_loss: 5.6361, tra_kl_loss: 6.4185, time_kl_loss: 3.3333, dis_kl_loss: 4.8592, contra_loss: 23144.4470, recon_loss: 0.0000
Test epoch:8, time: 119.581219(s), Recall (@2: 0.1445, @5: 0.2268, @10: 0.3066), NDCG (@2: 0.1239, @5: 0.1611, @10: 0.1868)

Train epoch:9, time: 119.581219(s), rec_loss: 5.5368, tra_kl_loss: 6.3532, time_kl_loss: 3.0624, dis_kl_loss: 4.8570, contra_loss: 21185.9937, recon_loss: 0.0000
Test epoch:9, time: 134.510768(s), Recall (@2: 0.1404, @5: 0.2221, @10: 0.3025), NDCG (@2: 0.1211, @5: 0.1579, @10: 0.1839)

Train epoch:10, time: 134.510768(s), rec_loss: 5.4421, tra_kl_loss: 6.3074, time_kl_loss: 2.9872, dis_kl_loss: 4.8198, contra_loss: 18937.9629, recon_loss: 0.0000
Test epoch:10, time: 149.440071(s), Recall (@2: 0.1458, @5: 0.2311, @10: 0.3116), NDCG (@2: 0.1245, @5: 0.1629, @10: 0.1888)

Train epoch:11, time: 149.440071(s), rec_loss: 5.3678, tra_kl_loss: 6.3093, time_kl_loss: 2.9636, dis_kl_loss: 4.7866, contra_loss: 17245.6074, recon_loss: 0.0000
Test epoch:11, time: 164.208539(s), Recall (@2: 0.1451, @5: 0.2260, @10: 0.3040), NDCG (@2: 0.1255, @5: 0.1619, @10: 0.1871)

Train epoch:12, time: 164.208539(s), rec_loss: 5.3128, tra_kl_loss: 6.2549, time_kl_loss: 2.8504, dis_kl_loss: 4.8105, contra_loss: 15257.4960, recon_loss: 0.0000
Test epoch:12, time: 178.965871(s), Recall (@2: 0.1436, @5: 0.2279, @10: 0.3088), NDCG (@2: 0.1239, @5: 0.1622, @10: 0.1881)

Train epoch:13, time: 178.965871(s), rec_loss: 5.2591, tra_kl_loss: 6.2771, time_kl_loss: 2.8351, dis_kl_loss: 4.7909, contra_loss: 13844.0486, recon_loss: 0.0000
Test epoch:13, time: 193.888089(s), Recall (@2: 0.1511, @5: 0.2417, @10: 0.3187), NDCG (@2: 0.1291, @5: 0.1698, @10: 0.1946)

Train epoch:14, time: 193.888089(s), rec_loss: 5.2130, tra_kl_loss: 6.2802, time_kl_loss: 2.9613, dis_kl_loss: 4.7755, contra_loss: 12725.9606, recon_loss: 0.0000
Test epoch:14, time: 208.563440(s), Recall (@2: 0.1453, @5: 0.2305, @10: 0.3053), NDCG (@2: 0.1263, @5: 0.1644, @10: 0.1885)

Train epoch:15, time: 208.563440(s), rec_loss: 5.1734, tra_kl_loss: 6.2315, time_kl_loss: 2.7633, dis_kl_loss: 4.7599, contra_loss: 11295.8847, recon_loss: 0.0000
Test epoch:15, time: 223.364619(s), Recall (@2: 0.1470, @5: 0.2374, @10: 0.3085), NDCG (@2: 0.1279, @5: 0.1683, @10: 0.1912)

Train epoch:16, time: 223.364619(s), rec_loss: 5.1428, tra_kl_loss: 6.2226, time_kl_loss: 2.7862, dis_kl_loss: 4.7787, contra_loss: 10006.1330, recon_loss: 0.0000
Test epoch:16, time: 238.407274(s), Recall (@2: 0.1462, @5: 0.2292, @10: 0.3016), NDCG (@2: 0.1260, @5: 0.1633, @10: 0.1868)

Train epoch:17, time: 238.407274(s), rec_loss: 5.1076, tra_kl_loss: 6.2423, time_kl_loss: 2.7649, dis_kl_loss: 4.7944, contra_loss: 9069.2578, recon_loss: 0.0000
Test epoch:17, time: 253.362702(s), Recall (@2: 0.1539, @5: 0.2441, @10: 0.3174), NDCG (@2: 0.1319, @5: 0.1725, @10: 0.1961)

Train epoch:18, time: 253.362702(s), rec_loss: 5.0890, tra_kl_loss: 6.2781, time_kl_loss: 2.7820, dis_kl_loss: 4.8026, contra_loss: 8344.0773, recon_loss: 0.0000
Test epoch:18, time: 268.052204(s), Recall (@2: 0.1496, @5: 0.2367, @10: 0.3072), NDCG (@2: 0.1297, @5: 0.1688, @10: 0.1915)

Train epoch:19, time: 268.052204(s), rec_loss: 5.0635, tra_kl_loss: 6.1483, time_kl_loss: 2.7911, dis_kl_loss: 4.7771, contra_loss: 7259.1724, recon_loss: 0.0000
Test epoch:19, time: 282.803098(s), Recall (@2: 0.1516, @5: 0.2378, @10: 0.3120), NDCG (@2: 0.1314, @5: 0.1701, @10: 0.1940)

Train epoch:20, time: 282.803098(s), rec_loss: 5.0418, tra_kl_loss: 6.2823, time_kl_loss: 2.5027, dis_kl_loss: 4.7675, contra_loss: 6876.0482, recon_loss: 0.0000
Test epoch:20, time: 297.762141(s), Recall (@2: 0.1498, @5: 0.2389, @10: 0.3137), NDCG (@2: 0.1301, @5: 0.1701, @10: 0.1942)

Train epoch:21, time: 297.762141(s), rec_loss: 5.0206, tra_kl_loss: 6.2514, time_kl_loss: 2.5569, dis_kl_loss: 4.7578, contra_loss: 6398.3984, recon_loss: 0.0000
Test epoch:21, time: 312.697413(s), Recall (@2: 0.1535, @5: 0.2434, @10: 0.3172), NDCG (@2: 0.1325, @5: 0.1727, @10: 0.1965)

Train epoch:22, time: 312.697413(s), rec_loss: 5.0015, tra_kl_loss: 6.2190, time_kl_loss: 2.7163, dis_kl_loss: 4.7275, contra_loss: 5844.9931, recon_loss: 0.0000
Test epoch:22, time: 327.488605(s), Recall (@2: 0.1652, @5: 0.2592, @10: 0.3338), NDCG (@2: 0.1414, @5: 0.1839, @10: 0.2080)

Train epoch:23, time: 327.488605(s), rec_loss: 4.9960, tra_kl_loss: 6.2533, time_kl_loss: 2.5505, dis_kl_loss: 4.7655, contra_loss: 5660.8362, recon_loss: 0.0000
Test epoch:23, time: 342.156230(s), Recall (@2: 0.1492, @5: 0.2320, @10: 0.3060), NDCG (@2: 0.1293, @5: 0.1665, @10: 0.1904)

Train epoch:24, time: 342.156230(s), rec_loss: 4.9684, tra_kl_loss: 6.2203, time_kl_loss: 2.5261, dis_kl_loss: 4.7711, contra_loss: 5314.4779, recon_loss: 0.0000
Test epoch:24, time: 356.720751(s), Recall (@2: 0.1531, @5: 0.2411, @10: 0.3165), NDCG (@2: 0.1331, @5: 0.1724, @10: 0.1968)

Train epoch:25, time: 356.720751(s), rec_loss: 4.9600, tra_kl_loss: 6.3580, time_kl_loss: 2.5356, dis_kl_loss: 4.7485, contra_loss: 5297.1116, recon_loss: 0.0000
Test epoch:25, time: 371.199411(s), Recall (@2: 0.1527, @5: 0.2400, @10: 0.3113), NDCG (@2: 0.1308, @5: 0.1697, @10: 0.1929)

Train epoch:26, time: 371.199411(s), rec_loss: 4.9440, tra_kl_loss: 6.1972, time_kl_loss: 2.7137, dis_kl_loss: 4.7564, contra_loss: 5024.1933, recon_loss: 0.0000
Test epoch:26, time: 385.944564(s), Recall (@2: 0.1445, @5: 0.2255, @10: 0.3010), NDCG (@2: 0.1259, @5: 0.1621, @10: 0.1865)

Train epoch:27, time: 385.944564(s), rec_loss: 4.9330, tra_kl_loss: 6.2162, time_kl_loss: 2.5389, dis_kl_loss: 4.7374, contra_loss: 4803.2117, recon_loss: 0.0000
Test epoch:27, time: 400.757111(s), Recall (@2: 0.1630, @5: 0.2557, @10: 0.3335), NDCG (@2: 0.1407, @5: 0.1825, @10: 0.2077)

Train epoch:28, time: 400.757111(s), rec_loss: 4.9312, tra_kl_loss: 6.2670, time_kl_loss: 2.5952, dis_kl_loss: 4.7344, contra_loss: 4687.3257, recon_loss: 0.0000
Test epoch:28, time: 415.472996(s), Recall (@2: 0.1490, @5: 0.2322, @10: 0.3083), NDCG (@2: 0.1295, @5: 0.1669, @10: 0.1914)

Train epoch:29, time: 415.472996(s), rec_loss: 4.9124, tra_kl_loss: 6.2038, time_kl_loss: 2.5531, dis_kl_loss: 4.7242, contra_loss: 4489.0277, recon_loss: 0.0000
Test epoch:29, time: 430.443308(s), Recall (@2: 0.1524, @5: 0.2406, @10: 0.3169), NDCG (@2: 0.1328, @5: 0.1724, @10: 0.1973)

Train epoch:30, time: 430.443308(s), rec_loss: 4.8970, tra_kl_loss: 6.2904, time_kl_loss: 2.6607, dis_kl_loss: 4.7583, contra_loss: 4460.8758, recon_loss: 0.0000
Test epoch:30, time: 445.353256(s), Recall (@2: 0.1591, @5: 0.2495, @10: 0.3241), NDCG (@2: 0.1384, @5: 0.1787, @10: 0.2029)

Train epoch:31, time: 445.353256(s), rec_loss: 4.8929, tra_kl_loss: 6.2399, time_kl_loss: 2.5833, dis_kl_loss: 4.7495, contra_loss: 4358.3088, recon_loss: 0.0000
Test epoch:31, time: 461.300663(s), Recall (@2: 0.1514, @5: 0.2335, @10: 0.3126), NDCG (@2: 0.1301, @5: 0.1670, @10: 0.1927)

Train epoch:32, time: 461.300663(s), rec_loss: 4.8775, tra_kl_loss: 6.3110, time_kl_loss: 2.4819, dis_kl_loss: 4.7247, contra_loss: 4326.9563, recon_loss: 0.0000
Test epoch:32, time: 477.282004(s), Recall (@2: 0.1529, @5: 0.2350, @10: 0.3111), NDCG (@2: 0.1328, @5: 0.1697, @10: 0.1943)

Train epoch:33, time: 477.282004(s), rec_loss: 4.8701, tra_kl_loss: 6.3059, time_kl_loss: 2.5474, dis_kl_loss: 4.7499, contra_loss: 4210.0632, recon_loss: 0.0000
Test epoch:33, time: 493.246835(s), Recall (@2: 0.1473, @5: 0.2279, @10: 0.2999), NDCG (@2: 0.1274, @5: 0.1636, @10: 0.1868)

Train epoch:34, time: 493.246835(s), rec_loss: 4.8646, tra_kl_loss: 6.1783, time_kl_loss: 2.7138, dis_kl_loss: 4.7354, contra_loss: 4082.6689, recon_loss: 0.0000
Test epoch:34, time: 509.215890(s), Recall (@2: 0.1524, @5: 0.2305, @10: 0.3051), NDCG (@2: 0.1333, @5: 0.1681, @10: 0.1923)

Train epoch:35, time: 509.215890(s), rec_loss: 4.8483, tra_kl_loss: 6.2497, time_kl_loss: 2.6369, dis_kl_loss: 4.7325, contra_loss: 4020.8025, recon_loss: 0.0000
Test epoch:35, time: 524.787040(s), Recall (@2: 0.1544, @5: 0.2467, @10: 0.3238), NDCG (@2: 0.1350, @5: 0.1764, @10: 0.2013)

Train epoch:36, time: 524.787040(s), rec_loss: 4.8440, tra_kl_loss: 6.2116, time_kl_loss: 2.4294, dis_kl_loss: 4.7401, contra_loss: 4063.2319, recon_loss: 0.0000
Test epoch:36, time: 539.565570(s), Recall (@2: 0.1505, @5: 0.2277, @10: 0.3047), NDCG (@2: 0.1309, @5: 0.1657, @10: 0.1905)

Train epoch:37, time: 539.565570(s), rec_loss: 4.8324, tra_kl_loss: 6.1769, time_kl_loss: 2.7158, dis_kl_loss: 4.7148, contra_loss: 3874.9652, recon_loss: 0.0000
Test epoch:37, time: 554.363809(s), Recall (@2: 0.1490, @5: 0.2357, @10: 0.3144), NDCG (@2: 0.1300, @5: 0.1691, @10: 0.1944)

Train epoch:38, time: 554.363809(s), rec_loss: 4.8296, tra_kl_loss: 6.2705, time_kl_loss: 2.6495, dis_kl_loss: 4.7249, contra_loss: 3988.1512, recon_loss: 0.0000
Test epoch:38, time: 568.416088(s), Recall (@2: 0.1520, @5: 0.2359, @10: 0.3085), NDCG (@2: 0.1317, @5: 0.1693, @10: 0.1929)

Train epoch:39, time: 568.416088(s), rec_loss: 4.8168, tra_kl_loss: 6.2766, time_kl_loss: 2.6265, dis_kl_loss: 4.7510, contra_loss: 3912.4522, recon_loss: 0.0000
Test epoch:39, time: 582.572076(s), Recall (@2: 0.1542, @5: 0.2462, @10: 0.3161), NDCG (@2: 0.1326, @5: 0.1741, @10: 0.1968)

Train epoch:40, time: 582.572076(s), rec_loss: 4.8081, tra_kl_loss: 6.2134, time_kl_loss: 2.5340, dis_kl_loss: 4.7335, contra_loss: 3934.1632, recon_loss: 0.0000
Test epoch:40, time: 596.706761(s), Recall (@2: 0.1442, @5: 0.2210, @10: 0.2930), NDCG (@2: 0.1249, @5: 0.1597, @10: 0.1829)

Train epoch:41, time: 596.706761(s), rec_loss: 4.8031, tra_kl_loss: 6.2272, time_kl_loss: 2.5560, dis_kl_loss: 4.7210, contra_loss: 3941.0846, recon_loss: 0.0000
Test epoch:41, time: 611.277607(s), Recall (@2: 0.1531, @5: 0.2346, @10: 0.3090), NDCG (@2: 0.1333, @5: 0.1693, @10: 0.1934)

Train epoch:42, time: 611.277607(s), rec_loss: 4.8031, tra_kl_loss: 6.2495, time_kl_loss: 2.5661, dis_kl_loss: 4.7463, contra_loss: 3989.7095, recon_loss: 0.0000
Test epoch:42, time: 625.742069(s), Recall (@2: 0.1516, @5: 0.2316, @10: 0.3075), NDCG (@2: 0.1316, @5: 0.1676, @10: 0.1922)

Train epoch:43, time: 625.742069(s), rec_loss: 4.7879, tra_kl_loss: 6.2646, time_kl_loss: 2.5717, dis_kl_loss: 4.6827, contra_loss: 3972.8753, recon_loss: 0.0000
Test epoch:43, time: 640.389801(s), Recall (@2: 0.1531, @5: 0.2326, @10: 0.3027), NDCG (@2: 0.1336, @5: 0.1690, @10: 0.1917)

Train epoch:44, time: 640.389801(s), rec_loss: 4.7820, tra_kl_loss: 6.3230, time_kl_loss: 2.5842, dis_kl_loss: 4.7321, contra_loss: 4023.0160, recon_loss: 0.0000
Test epoch:44, time: 654.569219(s), Recall (@2: 0.1501, @5: 0.2342, @10: 0.3083), NDCG (@2: 0.1314, @5: 0.1690, @10: 0.1929)

Train epoch:45, time: 654.569219(s), rec_loss: 4.7815, tra_kl_loss: 6.2484, time_kl_loss: 2.6721, dis_kl_loss: 4.7766, contra_loss: 3989.0265, recon_loss: 0.0000
Test epoch:45, time: 668.769120(s), Recall (@2: 0.1514, @5: 0.2365, @10: 0.3083), NDCG (@2: 0.1322, @5: 0.1700, @10: 0.1930)

Train epoch:46, time: 668.769120(s), rec_loss: 4.7692, tra_kl_loss: 6.1086, time_kl_loss: 2.6077, dis_kl_loss: 4.7481, contra_loss: 4084.5047, recon_loss: 0.0000
Test epoch:46, time: 682.676952(s), Recall (@2: 0.1516, @5: 0.2367, @10: 0.3137), NDCG (@2: 0.1313, @5: 0.1694, @10: 0.1942)

Train epoch:47, time: 682.676952(s), rec_loss: 4.7628, tra_kl_loss: 6.1472, time_kl_loss: 2.6105, dis_kl_loss: 4.7528, contra_loss: 4009.1596, recon_loss: 0.0000
Test epoch:47, time: 696.343156(s), Recall (@2: 0.1529, @5: 0.2389, @10: 0.3146), NDCG (@2: 0.1335, @5: 0.1718, @10: 0.1961)

Train epoch:48, time: 696.343156(s), rec_loss: 4.7560, tra_kl_loss: 6.2537, time_kl_loss: 2.6840, dis_kl_loss: 4.7421, contra_loss: 4098.1376, recon_loss: 0.0000
Test epoch:48, time: 710.171052(s), Recall (@2: 0.1516, @5: 0.2393, @10: 0.3122), NDCG (@2: 0.1322, @5: 0.1711, @10: 0.1946)

Train epoch:49, time: 710.171052(s), rec_loss: 4.7538, tra_kl_loss: 6.2164, time_kl_loss: 2.6175, dis_kl_loss: 4.7506, contra_loss: 4064.9082, recon_loss: 0.0000
Test epoch:49, time: 724.289445(s), Recall (@2: 0.1507, @5: 0.2344, @10: 0.3075), NDCG (@2: 0.1318, @5: 0.1692, @10: 0.1929)

Train epoch:50, time: 724.289445(s), rec_loss: 4.7422, tra_kl_loss: 6.1833, time_kl_loss: 2.7152, dis_kl_loss: 4.7236, contra_loss: 4177.4766, recon_loss: 0.0000
Test epoch:50, time: 738.096261(s), Recall (@2: 0.1490, @5: 0.2348, @10: 0.3090), NDCG (@2: 0.1316, @5: 0.1702, @10: 0.1942)
