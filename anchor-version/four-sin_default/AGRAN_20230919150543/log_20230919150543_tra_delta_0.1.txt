dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:0
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.1
tem_delta:0.0
dis_delta:0.0
valid_epoch:1
device:cuda:0
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0965, tra_kl_loss: 6.7007, time_kl_loss: 6.0757, dis_kl_loss: 6.0520, contra_loss: 15626.0366
Test epoch:1, time: 11.063201(s), Recall (@2: 0.1102, @5: 0.1636, @10: 0.2204), NDCG (@2: 0.0969, @5: 0.1206, @10: 0.1388)

Train epoch:2, time: 11.063201(s), rec_loss: 7.3545, tra_kl_loss: 7.8375, time_kl_loss: 5.7591, dis_kl_loss: 5.7816, contra_loss: 28128.0199
Test epoch:2, time: 21.657228(s), Recall (@2: 0.1119, @5: 0.1947, @10: 0.2566), NDCG (@2: 0.0992, @5: 0.1360, @10: 0.1561)

Train epoch:3, time: 21.657228(s), rec_loss: 6.8419, tra_kl_loss: 7.2008, time_kl_loss: 5.0743, dis_kl_loss: 5.1174, contra_loss: 27659.9372
Test epoch:3, time: 34.053235(s), Recall (@2: 0.1125, @5: 0.1865, @10: 0.2605), NDCG (@2: 0.0978, @5: 0.1309, @10: 0.1546)

Train epoch:4, time: 34.053235(s), rec_loss: 6.4674, tra_kl_loss: 6.7608, time_kl_loss: 4.9402, dis_kl_loss: 4.9370, contra_loss: 25970.1207
Test epoch:4, time: 46.901905(s), Recall (@2: 0.1244, @5: 0.2033, @10: 0.2809), NDCG (@2: 0.1071, @5: 0.1425, @10: 0.1676)

Train epoch:5, time: 46.901905(s), rec_loss: 6.1876, tra_kl_loss: 6.6531, time_kl_loss: 4.8334, dis_kl_loss: 4.8489, contra_loss: 24687.9589
Test epoch:5, time: 59.382282(s), Recall (@2: 0.1233, @5: 0.2091, @10: 0.2799), NDCG (@2: 0.1062, @5: 0.1448, @10: 0.1677)

Train epoch:6, time: 59.382282(s), rec_loss: 5.9681, tra_kl_loss: 6.5706, time_kl_loss: 4.7920, dis_kl_loss: 4.7934, contra_loss: 23046.3669
Test epoch:6, time: 71.956947(s), Recall (@2: 0.1332, @5: 0.2195, @10: 0.3001), NDCG (@2: 0.1137, @5: 0.1524, @10: 0.1785)

Train epoch:7, time: 71.956947(s), rec_loss: 5.7837, tra_kl_loss: 6.5596, time_kl_loss: 4.7793, dis_kl_loss: 4.7991, contra_loss: 21770.8584
Test epoch:7, time: 84.372710(s), Recall (@2: 0.1361, @5: 0.2186, @10: 0.3025), NDCG (@2: 0.1162, @5: 0.1534, @10: 0.1804)

Train epoch:8, time: 84.372710(s), rec_loss: 5.6401, tra_kl_loss: 6.6641, time_kl_loss: 4.7733, dis_kl_loss: 4.7904, contra_loss: 20309.8333
Test epoch:8, time: 97.417719(s), Recall (@2: 0.1417, @5: 0.2324, @10: 0.3072), NDCG (@2: 0.1215, @5: 0.1623, @10: 0.1863)

Train epoch:9, time: 97.417719(s), rec_loss: 5.5277, tra_kl_loss: 6.5747, time_kl_loss: 4.7475, dis_kl_loss: 4.7475, contra_loss: 19244.1067
Test epoch:9, time: 110.128173(s), Recall (@2: 0.1417, @5: 0.2305, @10: 0.3006), NDCG (@2: 0.1216, @5: 0.1617, @10: 0.1843)

Train epoch:10, time: 110.128173(s), rec_loss: 5.4233, tra_kl_loss: 6.3893, time_kl_loss: 4.7449, dis_kl_loss: 4.7199, contra_loss: 17259.9446
Test epoch:10, time: 123.095380(s), Recall (@2: 0.1466, @5: 0.2342, @10: 0.3014), NDCG (@2: 0.1252, @5: 0.1646, @10: 0.1865)

Train epoch:11, time: 123.095380(s), rec_loss: 5.3507, tra_kl_loss: 6.4392, time_kl_loss: 4.7410, dis_kl_loss: 4.6815, contra_loss: 16766.2453
Test epoch:11, time: 135.990432(s), Recall (@2: 0.1483, @5: 0.2430, @10: 0.3113), NDCG (@2: 0.1271, @5: 0.1693, @10: 0.1913)

Train epoch:12, time: 135.990432(s), rec_loss: 5.2893, tra_kl_loss: 6.5186, time_kl_loss: 4.7033, dis_kl_loss: 4.7164, contra_loss: 15658.1865
Test epoch:12, time: 148.912859(s), Recall (@2: 0.1468, @5: 0.2370, @10: 0.3092), NDCG (@2: 0.1271, @5: 0.1676, @10: 0.1908)

Train epoch:13, time: 148.912859(s), rec_loss: 5.2348, tra_kl_loss: 6.4011, time_kl_loss: 4.7009, dis_kl_loss: 4.6748, contra_loss: 14948.3031
Test epoch:13, time: 162.277420(s), Recall (@2: 0.1546, @5: 0.2473, @10: 0.3219), NDCG (@2: 0.1323, @5: 0.1740, @10: 0.1982)

Train epoch:14, time: 162.277420(s), rec_loss: 5.1892, tra_kl_loss: 6.3133, time_kl_loss: 4.7047, dis_kl_loss: 4.7011, contra_loss: 14394.6792
Test epoch:14, time: 175.116653(s), Recall (@2: 0.1460, @5: 0.2333, @10: 0.3036), NDCG (@2: 0.1255, @5: 0.1651, @10: 0.1879)

Train epoch:15, time: 175.116653(s), rec_loss: 5.1448, tra_kl_loss: 6.3836, time_kl_loss: 4.6816, dis_kl_loss: 4.6722, contra_loss: 13712.7725
Test epoch:15, time: 187.702194(s), Recall (@2: 0.1473, @5: 0.2335, @10: 0.3053), NDCG (@2: 0.1271, @5: 0.1659, @10: 0.1890)

Train epoch:16, time: 187.702194(s), rec_loss: 5.1112, tra_kl_loss: 6.3451, time_kl_loss: 4.6785, dis_kl_loss: 4.6789, contra_loss: 12780.1513
Test epoch:16, time: 199.912981(s), Recall (@2: 0.1518, @5: 0.2423, @10: 0.3118), NDCG (@2: 0.1313, @5: 0.1720, @10: 0.1945)

Train epoch:17, time: 199.912981(s), rec_loss: 5.0755, tra_kl_loss: 6.4755, time_kl_loss: 4.6486, dis_kl_loss: 4.6758, contra_loss: 12270.6488
Test epoch:17, time: 211.954144(s), Recall (@2: 0.1589, @5: 0.2488, @10: 0.3206), NDCG (@2: 0.1369, @5: 0.1770, @10: 0.2001)

Train epoch:18, time: 211.954144(s), rec_loss: 5.0518, tra_kl_loss: 6.4159, time_kl_loss: 4.7320, dis_kl_loss: 4.7041, contra_loss: 11882.7723
Test epoch:18, time: 223.920647(s), Recall (@2: 0.1546, @5: 0.2382, @10: 0.3135), NDCG (@2: 0.1350, @5: 0.1727, @10: 0.1969)

Train epoch:19, time: 223.920647(s), rec_loss: 5.0250, tra_kl_loss: 6.3350, time_kl_loss: 4.5898, dis_kl_loss: 4.6555, contra_loss: 11132.1892
Test epoch:19, time: 235.819743(s), Recall (@2: 0.1552, @5: 0.2419, @10: 0.3141), NDCG (@2: 0.1338, @5: 0.1729, @10: 0.1963)

Train epoch:20, time: 235.819743(s), rec_loss: 5.0073, tra_kl_loss: 6.4072, time_kl_loss: 4.6723, dis_kl_loss: 4.6910, contra_loss: 10970.2112
Test epoch:20, time: 247.843894(s), Recall (@2: 0.1527, @5: 0.2387, @10: 0.3103), NDCG (@2: 0.1326, @5: 0.1714, @10: 0.1945)

Train epoch:21, time: 247.843894(s), rec_loss: 4.9738, tra_kl_loss: 6.3819, time_kl_loss: 4.6495, dis_kl_loss: 4.6389, contra_loss: 10638.4781
Test epoch:21, time: 260.041126(s), Recall (@2: 0.1583, @5: 0.2439, @10: 0.3154), NDCG (@2: 0.1375, @5: 0.1755, @10: 0.1987)

Train epoch:22, time: 260.041126(s), rec_loss: 4.9553, tra_kl_loss: 6.3526, time_kl_loss: 4.6327, dis_kl_loss: 4.6903, contra_loss: 10121.0077
Test epoch:22, time: 272.245915(s), Recall (@2: 0.1589, @5: 0.2488, @10: 0.3230), NDCG (@2: 0.1377, @5: 0.1783, @10: 0.2022)

Train epoch:23, time: 272.245915(s), rec_loss: 4.9432, tra_kl_loss: 6.3627, time_kl_loss: 4.6832, dis_kl_loss: 4.6737, contra_loss: 10076.4675
Test epoch:23, time: 284.524022(s), Recall (@2: 0.1496, @5: 0.2393, @10: 0.3096), NDCG (@2: 0.1289, @5: 0.1692, @10: 0.1920)

Train epoch:24, time: 284.524022(s), rec_loss: 4.9200, tra_kl_loss: 6.3938, time_kl_loss: 4.6246, dis_kl_loss: 4.6721, contra_loss: 9719.7491
Test epoch:24, time: 296.883930(s), Recall (@2: 0.1578, @5: 0.2471, @10: 0.3157), NDCG (@2: 0.1376, @5: 0.1777, @10: 0.1998)

Train epoch:25, time: 296.883930(s), rec_loss: 4.9049, tra_kl_loss: 6.5406, time_kl_loss: 4.6400, dis_kl_loss: 4.6584, contra_loss: 9697.8276
Test epoch:25, time: 309.070045(s), Recall (@2: 0.1563, @5: 0.2428, @10: 0.3191), NDCG (@2: 0.1356, @5: 0.1744, @10: 0.1991)

Train epoch:26, time: 309.070045(s), rec_loss: 4.8912, tra_kl_loss: 6.3540, time_kl_loss: 4.6517, dis_kl_loss: 4.6751, contra_loss: 9192.8715
Test epoch:26, time: 321.846304(s), Recall (@2: 0.1455, @5: 0.2281, @10: 0.3029), NDCG (@2: 0.1272, @5: 0.1642, @10: 0.1885)

Train epoch:27, time: 321.846304(s), rec_loss: 4.8785, tra_kl_loss: 6.4021, time_kl_loss: 4.6149, dis_kl_loss: 4.6582, contra_loss: 8742.1010
Test epoch:27, time: 334.283744(s), Recall (@2: 0.1701, @5: 0.2566, @10: 0.3351), NDCG (@2: 0.1461, @5: 0.1851, @10: 0.2105)

Train epoch:28, time: 334.283744(s), rec_loss: 4.8659, tra_kl_loss: 6.3984, time_kl_loss: 4.6369, dis_kl_loss: 4.6705, contra_loss: 8546.6358
Test epoch:28, time: 346.876188(s), Recall (@2: 0.1501, @5: 0.2337, @10: 0.3001), NDCG (@2: 0.1306, @5: 0.1680, @10: 0.1896)

Train epoch:29, time: 346.876188(s), rec_loss: 4.8482, tra_kl_loss: 6.4046, time_kl_loss: 4.6194, dis_kl_loss: 4.6577, contra_loss: 8152.5372
Test epoch:29, time: 359.868809(s), Recall (@2: 0.1565, @5: 0.2430, @10: 0.3154), NDCG (@2: 0.1358, @5: 0.1747, @10: 0.1981)

Train epoch:30, time: 359.868809(s), rec_loss: 4.8368, tra_kl_loss: 6.4310, time_kl_loss: 4.6679, dis_kl_loss: 4.5927, contra_loss: 8174.3511
Test epoch:30, time: 373.260607(s), Recall (@2: 0.1565, @5: 0.2434, @10: 0.3206), NDCG (@2: 0.1363, @5: 0.1755, @10: 0.2004)

Train epoch:31, time: 373.260607(s), rec_loss: 4.8257, tra_kl_loss: 6.4531, time_kl_loss: 4.6646, dis_kl_loss: 4.6632, contra_loss: 8055.5562
Test epoch:31, time: 386.530870(s), Recall (@2: 0.1546, @5: 0.2393, @10: 0.3131), NDCG (@2: 0.1346, @5: 0.1725, @10: 0.1960)

Train epoch:32, time: 386.530870(s), rec_loss: 4.8141, tra_kl_loss: 6.4666, time_kl_loss: 4.6305, dis_kl_loss: 4.6855, contra_loss: 7912.8317
Test epoch:32, time: 399.882321(s), Recall (@2: 0.1570, @5: 0.2421, @10: 0.3226), NDCG (@2: 0.1375, @5: 0.1757, @10: 0.2018)

Train epoch:33, time: 399.882321(s), rec_loss: 4.8055, tra_kl_loss: 6.4958, time_kl_loss: 4.6690, dis_kl_loss: 4.6757, contra_loss: 7589.4464
Test epoch:33, time: 413.178191(s), Recall (@2: 0.1501, @5: 0.2329, @10: 0.3014), NDCG (@2: 0.1306, @5: 0.1679, @10: 0.1901)

Train epoch:34, time: 413.178191(s), rec_loss: 4.7913, tra_kl_loss: 6.2912, time_kl_loss: 4.6579, dis_kl_loss: 4.6677, contra_loss: 7212.4026
Test epoch:34, time: 427.332657(s), Recall (@2: 0.1537, @5: 0.2363, @10: 0.3116), NDCG (@2: 0.1347, @5: 0.1715, @10: 0.1958)

Train epoch:35, time: 427.332657(s), rec_loss: 4.7818, tra_kl_loss: 6.3850, time_kl_loss: 4.6424, dis_kl_loss: 4.6254, contra_loss: 6922.3115
Test epoch:35, time: 441.676321(s), Recall (@2: 0.1600, @5: 0.2477, @10: 0.3243), NDCG (@2: 0.1396, @5: 0.1790, @10: 0.2037)

Train epoch:36, time: 441.676321(s), rec_loss: 4.7759, tra_kl_loss: 6.4201, time_kl_loss: 4.6352, dis_kl_loss: 4.6904, contra_loss: 6976.9740
Test epoch:36, time: 455.436638(s), Recall (@2: 0.1527, @5: 0.2389, @10: 0.3062), NDCG (@2: 0.1331, @5: 0.1718, @10: 0.1934)

Train epoch:37, time: 455.436638(s), rec_loss: 4.7606, tra_kl_loss: 6.2921, time_kl_loss: 4.6308, dis_kl_loss: 4.6436, contra_loss: 6446.4218
Test epoch:37, time: 469.475573(s), Recall (@2: 0.1514, @5: 0.2346, @10: 0.3079), NDCG (@2: 0.1320, @5: 0.1693, @10: 0.1929)

Train epoch:38, time: 469.475573(s), rec_loss: 4.7646, tra_kl_loss: 6.4570, time_kl_loss: 4.6603, dis_kl_loss: 4.6554, contra_loss: 6659.3294
Test epoch:38, time: 482.609604(s), Recall (@2: 0.1520, @5: 0.2344, @10: 0.3081), NDCG (@2: 0.1331, @5: 0.1702, @10: 0.1941)

Train epoch:39, time: 482.609604(s), rec_loss: 4.7462, tra_kl_loss: 6.3928, time_kl_loss: 4.6612, dis_kl_loss: 4.6730, contra_loss: 6360.0094
Test epoch:39, time: 497.057380(s), Recall (@2: 0.1537, @5: 0.2370, @10: 0.3100), NDCG (@2: 0.1352, @5: 0.1725, @10: 0.1961)

Train epoch:40, time: 497.057380(s), rec_loss: 4.7357, tra_kl_loss: 6.4665, time_kl_loss: 4.6592, dis_kl_loss: 4.6621, contra_loss: 6236.0249
Test epoch:40, time: 510.276296(s), Recall (@2: 0.1451, @5: 0.2225, @10: 0.2950), NDCG (@2: 0.1277, @5: 0.1624, @10: 0.1856)

Train epoch:41, time: 510.276296(s), rec_loss: 4.7319, tra_kl_loss: 6.3447, time_kl_loss: 4.6484, dis_kl_loss: 4.6575, contra_loss: 6216.6431
Test epoch:41, time: 523.590804(s), Recall (@2: 0.1567, @5: 0.2402, @10: 0.3049), NDCG (@2: 0.1370, @5: 0.1742, @10: 0.1950)

Train epoch:42, time: 523.590804(s), rec_loss: 4.7299, tra_kl_loss: 6.4112, time_kl_loss: 4.6633, dis_kl_loss: 4.6597, contra_loss: 6142.6342
Test epoch:42, time: 536.896399(s), Recall (@2: 0.1509, @5: 0.2318, @10: 0.3075), NDCG (@2: 0.1330, @5: 0.1693, @10: 0.1938)

Train epoch:43, time: 536.896399(s), rec_loss: 4.7171, tra_kl_loss: 6.4455, time_kl_loss: 4.6963, dis_kl_loss: 4.6595, contra_loss: 6011.6292
Test epoch:43, time: 550.079268(s), Recall (@2: 0.1468, @5: 0.2288, @10: 0.3019), NDCG (@2: 0.1289, @5: 0.1662, @10: 0.1899)

Train epoch:44, time: 550.079268(s), rec_loss: 4.7118, tra_kl_loss: 6.4750, time_kl_loss: 4.6386, dis_kl_loss: 4.6854, contra_loss: 5983.0844
Test epoch:44, time: 563.117978(s), Recall (@2: 0.1576, @5: 0.2342, @10: 0.3103), NDCG (@2: 0.1390, @5: 0.1732, @10: 0.1977)

Train epoch:45, time: 563.117978(s), rec_loss: 4.7065, tra_kl_loss: 6.3583, time_kl_loss: 4.6208, dis_kl_loss: 4.6340, contra_loss: 5787.7774
Test epoch:45, time: 576.306407(s), Recall (@2: 0.1542, @5: 0.2294, @10: 0.3010), NDCG (@2: 0.1339, @5: 0.1676, @10: 0.1908)

Train epoch:46, time: 576.306407(s), rec_loss: 4.6971, tra_kl_loss: 6.3065, time_kl_loss: 4.6514, dis_kl_loss: 4.7141, contra_loss: 5775.6934
Test epoch:46, time: 589.485807(s), Recall (@2: 0.1522, @5: 0.2320, @10: 0.3068), NDCG (@2: 0.1344, @5: 0.1703, @10: 0.1946)

Train epoch:47, time: 589.485807(s), rec_loss: 4.6921, tra_kl_loss: 6.4152, time_kl_loss: 4.6693, dis_kl_loss: 4.6955, contra_loss: 5600.0212
Test epoch:47, time: 602.722074(s), Recall (@2: 0.1544, @5: 0.2363, @10: 0.3148), NDCG (@2: 0.1358, @5: 0.1728, @10: 0.1981)

Train epoch:48, time: 602.722074(s), rec_loss: 4.6831, tra_kl_loss: 6.5290, time_kl_loss: 4.6364, dis_kl_loss: 4.7025, contra_loss: 5599.8448
Test epoch:48, time: 615.969654(s), Recall (@2: 0.1559, @5: 0.2316, @10: 0.3094), NDCG (@2: 0.1372, @5: 0.1712, @10: 0.1964)

Train epoch:49, time: 615.969654(s), rec_loss: 4.6799, tra_kl_loss: 6.5248, time_kl_loss: 4.6759, dis_kl_loss: 4.6169, contra_loss: 5495.1623
Test epoch:49, time: 629.516491(s), Recall (@2: 0.1580, @5: 0.2326, @10: 0.3105), NDCG (@2: 0.1373, @5: 0.1707, @10: 0.1957)

Train epoch:50, time: 629.516491(s), rec_loss: 4.6698, tra_kl_loss: 6.3656, time_kl_loss: 4.6887, dis_kl_loss: 4.6733, contra_loss: 5517.2772
Test epoch:50, time: 643.275524(s), Recall (@2: 0.1542, @5: 0.2273, @10: 0.3006), NDCG (@2: 0.1352, @5: 0.1680, @10: 0.1916)
