dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:2
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.4
dis_delta:0.3
valid_epoch:1
device:cuda:2
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0962, tra_kl_loss: 6.5843, time_kl_loss: 6.1922, dis_kl_loss: 6.1565, contra_loss: 15062.3382
Test epoch:1, time: 17.880064(s), Recall (@2: 0.1100, @5: 0.1645, @10: 0.2191), NDCG (@2: 0.0968, @5: 0.1211, @10: 0.1385)

Train epoch:2, time: 17.880064(s), rec_loss: 7.3413, tra_kl_loss: 7.0588, time_kl_loss: 9.0721, dis_kl_loss: 7.8945, contra_loss: 22882.4774
Test epoch:2, time: 35.720902(s), Recall (@2: 0.1085, @5: 0.1900, @10: 0.2527), NDCG (@2: 0.0956, @5: 0.1318, @10: 0.1523)

Train epoch:3, time: 35.720902(s), rec_loss: 6.7871, tra_kl_loss: 6.7991, time_kl_loss: 7.8096, dis_kl_loss: 7.0264, contra_loss: 23520.2871
Test epoch:3, time: 53.838078(s), Recall (@2: 0.1128, @5: 0.1867, @10: 0.2605), NDCG (@2: 0.0979, @5: 0.1310, @10: 0.1547)

Train epoch:4, time: 53.838078(s), rec_loss: 6.3992, tra_kl_loss: 6.4816, time_kl_loss: 7.2491, dis_kl_loss: 6.5199, contra_loss: 23808.4044
Test epoch:4, time: 71.861312(s), Recall (@2: 0.1253, @5: 0.2081, @10: 0.2768), NDCG (@2: 0.1078, @5: 0.1450, @10: 0.1671)

Train epoch:5, time: 71.861312(s), rec_loss: 6.1259, tra_kl_loss: 6.4089, time_kl_loss: 6.2525, dis_kl_loss: 5.6876, contra_loss: 24369.7071
Test epoch:5, time: 89.591413(s), Recall (@2: 0.1229, @5: 0.2025, @10: 0.2747), NDCG (@2: 0.1070, @5: 0.1429, @10: 0.1662)

Train epoch:6, time: 89.591413(s), rec_loss: 5.9293, tra_kl_loss: 6.3923, time_kl_loss: 6.2507, dis_kl_loss: 5.1377, contra_loss: 23551.1008
Test epoch:6, time: 107.557356(s), Recall (@2: 0.1335, @5: 0.2167, @10: 0.2922), NDCG (@2: 0.1154, @5: 0.1528, @10: 0.1772)

Train epoch:7, time: 107.557356(s), rec_loss: 5.7723, tra_kl_loss: 6.3713, time_kl_loss: 5.6590, dis_kl_loss: 4.8724, contra_loss: 22574.1154
Test epoch:7, time: 125.373744(s), Recall (@2: 0.1395, @5: 0.2184, @10: 0.2962), NDCG (@2: 0.1195, @5: 0.1551, @10: 0.1800)

Train epoch:8, time: 125.373744(s), rec_loss: 5.6448, tra_kl_loss: 6.4692, time_kl_loss: 5.1352, dis_kl_loss: 4.6289, contra_loss: 22258.9955
Test epoch:8, time: 143.198445(s), Recall (@2: 0.1378, @5: 0.2288, @10: 0.3038), NDCG (@2: 0.1193, @5: 0.1602, @10: 0.1843)

Train epoch:9, time: 143.198445(s), rec_loss: 5.5477, tra_kl_loss: 6.3304, time_kl_loss: 4.8937, dis_kl_loss: 4.4581, contra_loss: 21539.7136
Test epoch:9, time: 160.878009(s), Recall (@2: 0.1419, @5: 0.2273, @10: 0.2999), NDCG (@2: 0.1224, @5: 0.1605, @10: 0.1839)

Train epoch:10, time: 160.878009(s), rec_loss: 5.4518, tra_kl_loss: 6.3033, time_kl_loss: 4.5534, dis_kl_loss: 4.7661, contra_loss: 20426.3669
Test epoch:10, time: 178.920250(s), Recall (@2: 0.1460, @5: 0.2350, @10: 0.3081), NDCG (@2: 0.1248, @5: 0.1647, @10: 0.1882)

Train epoch:11, time: 178.920250(s), rec_loss: 5.3821, tra_kl_loss: 6.3540, time_kl_loss: 4.6535, dis_kl_loss: 4.0900, contra_loss: 20302.6741
Test epoch:11, time: 196.955619(s), Recall (@2: 0.1462, @5: 0.2326, @10: 0.3031), NDCG (@2: 0.1255, @5: 0.1643, @10: 0.1872)

Train epoch:12, time: 196.955619(s), rec_loss: 5.3250, tra_kl_loss: 6.2409, time_kl_loss: 4.4529, dis_kl_loss: 4.0530, contra_loss: 19109.1883
Test epoch:12, time: 214.908465(s), Recall (@2: 0.1490, @5: 0.2339, @10: 0.3083), NDCG (@2: 0.1279, @5: 0.1660, @10: 0.1899)

Train epoch:13, time: 214.908465(s), rec_loss: 5.2738, tra_kl_loss: 6.3165, time_kl_loss: 4.0333, dis_kl_loss: 3.7214, contra_loss: 18698.8296
Test epoch:13, time: 232.688204(s), Recall (@2: 0.1531, @5: 0.2398, @10: 0.3157), NDCG (@2: 0.1309, @5: 0.1699, @10: 0.1943)

Train epoch:14, time: 232.688204(s), rec_loss: 5.2298, tra_kl_loss: 6.2821, time_kl_loss: 4.0980, dis_kl_loss: 4.0755, contra_loss: 18972.4593
Test epoch:14, time: 250.532881(s), Recall (@2: 0.1524, @5: 0.2389, @10: 0.3105), NDCG (@2: 0.1310, @5: 0.1696, @10: 0.1927)

Train epoch:15, time: 250.532881(s), rec_loss: 5.1890, tra_kl_loss: 6.2540, time_kl_loss: 4.3114, dis_kl_loss: 3.7389, contra_loss: 18101.3182
Test epoch:15, time: 268.200861(s), Recall (@2: 0.1507, @5: 0.2398, @10: 0.3098), NDCG (@2: 0.1296, @5: 0.1697, @10: 0.1923)

Train epoch:16, time: 268.200861(s), rec_loss: 5.1587, tra_kl_loss: 6.2022, time_kl_loss: 3.9676, dis_kl_loss: 3.8502, contra_loss: 16889.2145
Test epoch:16, time: 286.004230(s), Recall (@2: 0.1488, @5: 0.2389, @10: 0.3092), NDCG (@2: 0.1280, @5: 0.1688, @10: 0.1914)

Train epoch:17, time: 286.004230(s), rec_loss: 5.1224, tra_kl_loss: 6.2480, time_kl_loss: 4.0179, dis_kl_loss: 3.8147, contra_loss: 16262.4919
Test epoch:17, time: 303.656322(s), Recall (@2: 0.1563, @5: 0.2488, @10: 0.3206), NDCG (@2: 0.1337, @5: 0.1754, @10: 0.1985)

Train epoch:18, time: 303.656322(s), rec_loss: 5.1008, tra_kl_loss: 6.3001, time_kl_loss: 4.0501, dis_kl_loss: 3.8180, contra_loss: 16397.3828
Test epoch:18, time: 321.618939(s), Recall (@2: 0.1529, @5: 0.2344, @10: 0.3083), NDCG (@2: 0.1323, @5: 0.1690, @10: 0.1929)

Train epoch:19, time: 321.618939(s), rec_loss: 5.0736, tra_kl_loss: 6.1452, time_kl_loss: 3.8876, dis_kl_loss: 3.7165, contra_loss: 14925.2283
Test epoch:19, time: 339.415732(s), Recall (@2: 0.1578, @5: 0.2475, @10: 0.3204), NDCG (@2: 0.1371, @5: 0.1773, @10: 0.2007)

Train epoch:20, time: 339.415732(s), rec_loss: 5.0549, tra_kl_loss: 6.2733, time_kl_loss: 3.4639, dis_kl_loss: 3.5775, contra_loss: 15159.9472
Test epoch:20, time: 357.297285(s), Recall (@2: 0.1509, @5: 0.2382, @10: 0.3157), NDCG (@2: 0.1317, @5: 0.1710, @10: 0.1960)

Train epoch:21, time: 357.297285(s), rec_loss: 5.0265, tra_kl_loss: 6.2793, time_kl_loss: 3.4069, dis_kl_loss: 3.4121, contra_loss: 14684.7121
Test epoch:21, time: 375.224900(s), Recall (@2: 0.1567, @5: 0.2469, @10: 0.3215), NDCG (@2: 0.1370, @5: 0.1770, @10: 0.2011)

Train epoch:22, time: 375.224900(s), rec_loss: 5.0101, tra_kl_loss: 6.2303, time_kl_loss: 3.4489, dis_kl_loss: 3.5687, contra_loss: 13430.7760
Test epoch:22, time: 393.249347(s), Recall (@2: 0.1589, @5: 0.2490, @10: 0.3251), NDCG (@2: 0.1378, @5: 0.1781, @10: 0.2026)

Train epoch:23, time: 393.249347(s), rec_loss: 5.0036, tra_kl_loss: 6.3028, time_kl_loss: 3.6946, dis_kl_loss: 3.6529, contra_loss: 13836.7589
Test epoch:23, time: 411.109384(s), Recall (@2: 0.1507, @5: 0.2361, @10: 0.3109), NDCG (@2: 0.1308, @5: 0.1689, @10: 0.1930)

Train epoch:24, time: 411.109384(s), rec_loss: 4.9752, tra_kl_loss: 6.2129, time_kl_loss: 3.4136, dis_kl_loss: 3.7308, contra_loss: 13091.3034
Test epoch:24, time: 428.986007(s), Recall (@2: 0.1572, @5: 0.2436, @10: 0.3150), NDCG (@2: 0.1366, @5: 0.1754, @10: 0.1985)

Train epoch:25, time: 428.986007(s), rec_loss: 4.9633, tra_kl_loss: 6.3450, time_kl_loss: 3.2097, dis_kl_loss: 3.4420, contra_loss: 13431.1242
Test epoch:25, time: 447.259440(s), Recall (@2: 0.1606, @5: 0.2512, @10: 0.3245), NDCG (@2: 0.1389, @5: 0.1791, @10: 0.2028)

Train epoch:26, time: 447.259440(s), rec_loss: 4.9490, tra_kl_loss: 6.2482, time_kl_loss: 3.5314, dis_kl_loss: 3.3189, contra_loss: 12823.0827
Test epoch:26, time: 465.233315(s), Recall (@2: 0.1470, @5: 0.2311, @10: 0.3044), NDCG (@2: 0.1273, @5: 0.1649, @10: 0.1886)

Train epoch:27, time: 465.233315(s), rec_loss: 4.9371, tra_kl_loss: 6.2797, time_kl_loss: 3.3639, dis_kl_loss: 3.2564, contra_loss: 12344.7484
Test epoch:27, time: 483.295338(s), Recall (@2: 0.1697, @5: 0.2635, @10: 0.3379), NDCG (@2: 0.1472, @5: 0.1894, @10: 0.2136)

Train epoch:28, time: 483.295338(s), rec_loss: 4.9298, tra_kl_loss: 6.2853, time_kl_loss: 3.2708, dis_kl_loss: 3.5130, contra_loss: 12147.9636
Test epoch:28, time: 501.406560(s), Recall (@2: 0.1514, @5: 0.2357, @10: 0.3120), NDCG (@2: 0.1320, @5: 0.1700, @10: 0.1946)

Train epoch:29, time: 501.406560(s), rec_loss: 4.9101, tra_kl_loss: 6.2706, time_kl_loss: 3.4924, dis_kl_loss: 3.3404, contra_loss: 11957.1050
Test epoch:29, time: 519.058491(s), Recall (@2: 0.1539, @5: 0.2436, @10: 0.3150), NDCG (@2: 0.1341, @5: 0.1745, @10: 0.1974)

Train epoch:30, time: 519.058491(s), rec_loss: 4.8981, tra_kl_loss: 6.3359, time_kl_loss: 3.5300, dis_kl_loss: 3.5987, contra_loss: 11893.4301
Test epoch:30, time: 536.839188(s), Recall (@2: 0.1559, @5: 0.2404, @10: 0.3154), NDCG (@2: 0.1370, @5: 0.1751, @10: 0.1994)

Train epoch:31, time: 536.839188(s), rec_loss: 4.8893, tra_kl_loss: 6.3075, time_kl_loss: 3.1637, dis_kl_loss: 3.3934, contra_loss: 11420.6997
Test epoch:31, time: 554.454864(s), Recall (@2: 0.1570, @5: 0.2404, @10: 0.3185), NDCG (@2: 0.1376, @5: 0.1752, @10: 0.2003)

Train epoch:32, time: 554.454864(s), rec_loss: 4.8773, tra_kl_loss: 6.2995, time_kl_loss: 3.1793, dis_kl_loss: 3.2515, contra_loss: 11098.2185
Test epoch:32, time: 572.413721(s), Recall (@2: 0.1527, @5: 0.2395, @10: 0.3126), NDCG (@2: 0.1340, @5: 0.1728, @10: 0.1963)

Train epoch:33, time: 572.413721(s), rec_loss: 4.8677, tra_kl_loss: 6.2933, time_kl_loss: 2.9816, dis_kl_loss: 3.2313, contra_loss: 10851.5049
Test epoch:33, time: 590.562061(s), Recall (@2: 0.1511, @5: 0.2326, @10: 0.3027), NDCG (@2: 0.1320, @5: 0.1685, @10: 0.1911)

Train epoch:34, time: 590.562061(s), rec_loss: 4.8615, tra_kl_loss: 6.2178, time_kl_loss: 3.2794, dis_kl_loss: 3.2492, contra_loss: 10510.6259
Test epoch:34, time: 608.154298(s), Recall (@2: 0.1490, @5: 0.2339, @10: 0.3051), NDCG (@2: 0.1295, @5: 0.1677, @10: 0.1905)

Train epoch:35, time: 608.154298(s), rec_loss: 4.8453, tra_kl_loss: 6.2862, time_kl_loss: 3.1001, dis_kl_loss: 3.2079, contra_loss: 10099.3211
Test epoch:35, time: 625.920980(s), Recall (@2: 0.1555, @5: 0.2430, @10: 0.3174), NDCG (@2: 0.1372, @5: 0.1765, @10: 0.2004)

Train epoch:36, time: 625.920980(s), rec_loss: 4.8422, tra_kl_loss: 6.2617, time_kl_loss: 2.8485, dis_kl_loss: 3.2626, contra_loss: 10157.4637
Test epoch:36, time: 643.646679(s), Recall (@2: 0.1544, @5: 0.2348, @10: 0.3085), NDCG (@2: 0.1342, @5: 0.1701, @10: 0.1939)

Train epoch:37, time: 643.646679(s), rec_loss: 4.8277, tra_kl_loss: 6.1471, time_kl_loss: 3.1828, dis_kl_loss: 3.2217, contra_loss: 9228.8471
Test epoch:37, time: 661.286925(s), Recall (@2: 0.1486, @5: 0.2270, @10: 0.3029), NDCG (@2: 0.1299, @5: 0.1653, @10: 0.1897)

Train epoch:38, time: 661.286925(s), rec_loss: 4.8246, tra_kl_loss: 6.3127, time_kl_loss: 2.8786, dis_kl_loss: 3.1829, contra_loss: 9562.4103
Test epoch:38, time: 678.599136(s), Recall (@2: 0.1477, @5: 0.2311, @10: 0.3042), NDCG (@2: 0.1303, @5: 0.1677, @10: 0.1913)

Train epoch:39, time: 678.599136(s), rec_loss: 4.8155, tra_kl_loss: 6.2713, time_kl_loss: 3.0407, dis_kl_loss: 3.3135, contra_loss: 9187.6490
Test epoch:39, time: 696.482893(s), Recall (@2: 0.1494, @5: 0.2372, @10: 0.3150), NDCG (@2: 0.1293, @5: 0.1688, @10: 0.1939)

Train epoch:40, time: 696.482893(s), rec_loss: 4.8016, tra_kl_loss: 6.2869, time_kl_loss: 2.8967, dis_kl_loss: 3.3152, contra_loss: 8922.9340
Test epoch:40, time: 714.054920(s), Recall (@2: 0.1451, @5: 0.2249, @10: 0.2965), NDCG (@2: 0.1270, @5: 0.1628, @10: 0.1858)

Train epoch:41, time: 714.054920(s), rec_loss: 4.7967, tra_kl_loss: 6.2845, time_kl_loss: 2.8455, dis_kl_loss: 3.3299, contra_loss: 8859.7671
Test epoch:41, time: 731.975305(s), Recall (@2: 0.1548, @5: 0.2400, @10: 0.3144), NDCG (@2: 0.1351, @5: 0.1731, @10: 0.1971)

Train epoch:42, time: 731.975305(s), rec_loss: 4.7942, tra_kl_loss: 6.3100, time_kl_loss: 2.8159, dis_kl_loss: 3.3112, contra_loss: 8874.7641
Test epoch:42, time: 749.566102(s), Recall (@2: 0.1563, @5: 0.2434, @10: 0.3176), NDCG (@2: 0.1372, @5: 0.1764, @10: 0.2002)

Train epoch:43, time: 749.566102(s), rec_loss: 4.7809, tra_kl_loss: 6.2483, time_kl_loss: 2.8911, dis_kl_loss: 3.0300, contra_loss: 8535.9531
Test epoch:43, time: 767.175416(s), Recall (@2: 0.1498, @5: 0.2352, @10: 0.3085), NDCG (@2: 0.1310, @5: 0.1692, @10: 0.1928)

Train epoch:44, time: 767.175416(s), rec_loss: 4.7785, tra_kl_loss: 6.2932, time_kl_loss: 3.1280, dis_kl_loss: 3.1619, contra_loss: 8674.1793
Test epoch:44, time: 784.944915(s), Recall (@2: 0.1527, @5: 0.2350, @10: 0.3077), NDCG (@2: 0.1330, @5: 0.1697, @10: 0.1932)

Train epoch:45, time: 784.944915(s), rec_loss: 4.7730, tra_kl_loss: 6.2803, time_kl_loss: 2.8596, dis_kl_loss: 3.2662, contra_loss: 8482.1215
Test epoch:45, time: 802.569873(s), Recall (@2: 0.1516, @5: 0.2398, @10: 0.3129), NDCG (@2: 0.1334, @5: 0.1732, @10: 0.1968)

Train epoch:46, time: 802.569873(s), rec_loss: 4.7649, tra_kl_loss: 6.1701, time_kl_loss: 2.7923, dis_kl_loss: 3.2557, contra_loss: 8378.2106
Test epoch:46, time: 820.151402(s), Recall (@2: 0.1509, @5: 0.2365, @10: 0.3100), NDCG (@2: 0.1314, @5: 0.1702, @10: 0.1941)

Train epoch:47, time: 820.151402(s), rec_loss: 4.7587, tra_kl_loss: 6.2404, time_kl_loss: 2.9793, dis_kl_loss: 3.4385, contra_loss: 8118.1417
Test epoch:47, time: 837.611550(s), Recall (@2: 0.1624, @5: 0.2484, @10: 0.3210), NDCG (@2: 0.1421, @5: 0.1804, @10: 0.2038)

Train epoch:48, time: 837.611550(s), rec_loss: 4.7492, tra_kl_loss: 6.3123, time_kl_loss: 2.9777, dis_kl_loss: 3.4173, contra_loss: 8110.1908
Test epoch:48, time: 855.218672(s), Recall (@2: 0.1516, @5: 0.2342, @10: 0.3081), NDCG (@2: 0.1341, @5: 0.1712, @10: 0.1951)

Train epoch:49, time: 855.218672(s), rec_loss: 4.7439, tra_kl_loss: 6.2354, time_kl_loss: 2.9826, dis_kl_loss: 3.2282, contra_loss: 8080.0935
Test epoch:49, time: 872.093882(s), Recall (@2: 0.1535, @5: 0.2380, @10: 0.3098), NDCG (@2: 0.1356, @5: 0.1737, @10: 0.1970)

Train epoch:50, time: 872.093882(s), rec_loss: 4.7333, tra_kl_loss: 6.1813, time_kl_loss: 2.9977, dis_kl_loss: 3.3577, contra_loss: 7975.4219
Test epoch:50, time: 888.978383(s), Recall (@2: 0.1529, @5: 0.2404, @10: 0.3120), NDCG (@2: 0.1344, @5: 0.1737, @10: 0.1967)
