dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:1
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
recon_reg:1.0
tra_delta:0.0
tem_delta:0.4
dis_delta:0.0
valid_epoch:1
device:cuda:1
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.1016, tra_kl_loss: 6.7503, time_kl_loss: 6.1568, dis_kl_loss: 6.1660, contra_loss: 22139.8005, recon_loss: 0.2159
Test epoch:1, time: 39.145867(s), Recall (@2: 0.0595, @5: 0.1296, @10: 0.1988), NDCG (@2: 0.0520, @5: 0.0828, @10: 0.1055)

Train epoch:2, time: 39.145867(s), rec_loss: 7.5254, tra_kl_loss: 6.4203, time_kl_loss: 5.5073, dis_kl_loss: 5.7469, contra_loss: 17557.2259, recon_loss: 0.2840
Test epoch:2, time: 57.793298(s), Recall (@2: 0.1104, @5: 0.1787, @10: 0.2354), NDCG (@2: 0.0968, @5: 0.1272, @10: 0.1457)

Train epoch:3, time: 57.793298(s), rec_loss: 6.9855, tra_kl_loss: 7.2755, time_kl_loss: 6.0648, dis_kl_loss: 5.3998, contra_loss: 3139.6104, recon_loss: 0.1141
Test epoch:3, time: 76.945259(s), Recall (@2: 0.1117, @5: 0.1818, @10: 0.2484), NDCG (@2: 0.0982, @5: 0.1296, @10: 0.1511)

Train epoch:4, time: 76.945259(s), rec_loss: 6.5256, tra_kl_loss: 6.6015, time_kl_loss: 4.9968, dis_kl_loss: 5.0668, contra_loss: 2458.5815, recon_loss: 0.0752
Test epoch:4, time: 96.243579(s), Recall (@2: 0.1216, @5: 0.1986, @10: 0.2736), NDCG (@2: 0.1055, @5: 0.1398, @10: 0.1642)

Train epoch:5, time: 96.243579(s), rec_loss: 6.2063, tra_kl_loss: 6.4630, time_kl_loss: 3.9223, dis_kl_loss: 4.9967, contra_loss: 2497.4591, recon_loss: 0.0692
Test epoch:5, time: 115.390449(s), Recall (@2: 0.1218, @5: 0.2005, @10: 0.2727), NDCG (@2: 0.1050, @5: 0.1400, @10: 0.1634)

Train epoch:6, time: 115.390449(s), rec_loss: 5.9758, tra_kl_loss: 6.3308, time_kl_loss: 3.3935, dis_kl_loss: 4.9297, contra_loss: 2576.8956, recon_loss: 0.0687
Test epoch:6, time: 201.828165(s), Recall (@2: 0.1313, @5: 0.2167, @10: 0.2859), NDCG (@2: 0.1128, @5: 0.1511, @10: 0.1735)

Train epoch:7, time: 201.828165(s), rec_loss: 5.7951, tra_kl_loss: 6.3475, time_kl_loss: 3.4823, dis_kl_loss: 4.8763, contra_loss: 2816.2047, recon_loss: 0.0666
Test epoch:7, time: 221.620081(s), Recall (@2: 0.1365, @5: 0.2229, @10: 0.2999), NDCG (@2: 0.1167, @5: 0.1555, @10: 0.1803)

Train epoch:8, time: 221.620081(s), rec_loss: 5.6529, tra_kl_loss: 6.3380, time_kl_loss: 2.9842, dis_kl_loss: 4.8879, contra_loss: 2962.8663, recon_loss: 0.0666
Test epoch:8, time: 241.869031(s), Recall (@2: 0.1421, @5: 0.2311, @10: 0.3029), NDCG (@2: 0.1227, @5: 0.1624, @10: 0.1857)

Train epoch:9, time: 241.869031(s), rec_loss: 5.5418, tra_kl_loss: 6.2535, time_kl_loss: 2.8596, dis_kl_loss: 4.9211, contra_loss: 3168.2938, recon_loss: 0.0650
Test epoch:9, time: 260.989564(s), Recall (@2: 0.1470, @5: 0.2285, @10: 0.3040), NDCG (@2: 0.1255, @5: 0.1617, @10: 0.1860)

Train epoch:10, time: 260.989564(s), rec_loss: 5.4408, tra_kl_loss: 6.1878, time_kl_loss: 2.6425, dis_kl_loss: 4.8469, contra_loss: 3266.0384, recon_loss: 0.0656
Test epoch:10, time: 280.345145(s), Recall (@2: 0.1468, @5: 0.2348, @10: 0.3051), NDCG (@2: 0.1261, @5: 0.1655, @10: 0.1882)

Train epoch:11, time: 280.345145(s), rec_loss: 5.3623, tra_kl_loss: 6.2156, time_kl_loss: 2.8944, dis_kl_loss: 4.8266, contra_loss: 3321.4880, recon_loss: 0.0641
Test epoch:11, time: 299.654643(s), Recall (@2: 0.1432, @5: 0.2320, @10: 0.3044), NDCG (@2: 0.1227, @5: 0.1624, @10: 0.1859)

Train epoch:12, time: 299.654643(s), rec_loss: 5.3007, tra_kl_loss: 6.1445, time_kl_loss: 2.6534, dis_kl_loss: 4.8408, contra_loss: 3344.9988, recon_loss: 0.0649
Test epoch:12, time: 655.081453(s), Recall (@2: 0.1462, @5: 0.2363, @10: 0.3135), NDCG (@2: 0.1265, @5: 0.1671, @10: 0.1919)

Train epoch:13, time: 655.081453(s), rec_loss: 5.2443, tra_kl_loss: 6.2112, time_kl_loss: 2.5141, dis_kl_loss: 4.7993, contra_loss: 3402.9736, recon_loss: 0.0648
Test epoch:13, time: 674.313571(s), Recall (@2: 0.1488, @5: 0.2480, @10: 0.3213), NDCG (@2: 0.1270, @5: 0.1716, @10: 0.1952)

Train epoch:14, time: 674.313571(s), rec_loss: 5.1962, tra_kl_loss: 6.2285, time_kl_loss: 2.6400, dis_kl_loss: 4.8145, contra_loss: 3377.1146, recon_loss: 0.0644
Test epoch:14, time: 693.569712(s), Recall (@2: 0.1466, @5: 0.2318, @10: 0.2986), NDCG (@2: 0.1271, @5: 0.1653, @10: 0.1867)

Train epoch:15, time: 693.569712(s), rec_loss: 5.1519, tra_kl_loss: 6.1634, time_kl_loss: 2.5626, dis_kl_loss: 4.8183, contra_loss: 3360.0308, recon_loss: 0.0648
Test epoch:15, time: 1346.388519(s), Recall (@2: 0.1442, @5: 0.2329, @10: 0.3040), NDCG (@2: 0.1253, @5: 0.1652, @10: 0.1881)

Train epoch:16, time: 1346.388519(s), rec_loss: 5.1194, tra_kl_loss: 6.1357, time_kl_loss: 2.5935, dis_kl_loss: 4.8242, contra_loss: 3358.5718, recon_loss: 0.0656
Test epoch:16, time: 1365.522385(s), Recall (@2: 0.1494, @5: 0.2350, @10: 0.3047), NDCG (@2: 0.1300, @5: 0.1684, @10: 0.1910)

Train epoch:17, time: 1365.522385(s), rec_loss: 5.0848, tra_kl_loss: 6.1348, time_kl_loss: 2.5249, dis_kl_loss: 4.7965, contra_loss: 3350.8397, recon_loss: 0.0659
Test epoch:17, time: 1384.635143(s), Recall (@2: 0.1518, @5: 0.2434, @10: 0.3167), NDCG (@2: 0.1316, @5: 0.1723, @10: 0.1959)

Train epoch:18, time: 1384.635143(s), rec_loss: 5.0611, tra_kl_loss: 6.2470, time_kl_loss: 2.5786, dis_kl_loss: 4.8273, contra_loss: 3423.1054, recon_loss: 0.0661
Test epoch:18, time: 1561.424526(s), Recall (@2: 0.1518, @5: 0.2419, @10: 0.3079), NDCG (@2: 0.1317, @5: 0.1722, @10: 0.1936)

Train epoch:19, time: 1561.424526(s), rec_loss: 5.0332, tra_kl_loss: 6.0670, time_kl_loss: 2.6254, dis_kl_loss: 4.8016, contra_loss: 3355.7067, recon_loss: 0.0656
Test epoch:19, time: 1580.886227(s), Recall (@2: 0.1520, @5: 0.2408, @10: 0.3129), NDCG (@2: 0.1329, @5: 0.1726, @10: 0.1959)

Train epoch:20, time: 1580.886227(s), rec_loss: 5.0101, tra_kl_loss: 6.1537, time_kl_loss: 2.3921, dis_kl_loss: 4.7873, contra_loss: 3372.0534, recon_loss: 0.0663
Test epoch:20, time: 1600.077713(s), Recall (@2: 0.1522, @5: 0.2374, @10: 0.3103), NDCG (@2: 0.1318, @5: 0.1700, @10: 0.1935)

Train epoch:21, time: 1600.077713(s), rec_loss: 4.9813, tra_kl_loss: 6.1457, time_kl_loss: 2.4424, dis_kl_loss: 4.7762, contra_loss: 3395.5090, recon_loss: 0.0650
Test epoch:21, time: 1619.402357(s), Recall (@2: 0.1539, @5: 0.2449, @10: 0.3202), NDCG (@2: 0.1341, @5: 0.1750, @10: 0.1995)

Train epoch:22, time: 1619.402357(s), rec_loss: 4.9626, tra_kl_loss: 6.1782, time_kl_loss: 2.4963, dis_kl_loss: 4.7753, contra_loss: 3432.0054, recon_loss: 0.0648
Test epoch:22, time: 1658.387019(s), Recall (@2: 0.1624, @5: 0.2518, @10: 0.3254), NDCG (@2: 0.1407, @5: 0.1806, @10: 0.2043)

Train epoch:23, time: 1658.387019(s), rec_loss: 4.9517, tra_kl_loss: 6.1364, time_kl_loss: 2.5933, dis_kl_loss: 4.7808, contra_loss: 3396.8243, recon_loss: 0.0644
Test epoch:23, time: 1677.519714(s), Recall (@2: 0.1516, @5: 0.2385, @10: 0.3122), NDCG (@2: 0.1320, @5: 0.1712, @10: 0.1949)

Train epoch:24, time: 1677.519714(s), rec_loss: 4.9248, tra_kl_loss: 6.1652, time_kl_loss: 2.4354, dis_kl_loss: 4.7821, contra_loss: 3479.2653, recon_loss: 0.0644
Test epoch:24, time: 1696.666105(s), Recall (@2: 0.1572, @5: 0.2467, @10: 0.3180), NDCG (@2: 0.1365, @5: 0.1770, @10: 0.2000)

Train epoch:25, time: 1696.666105(s), rec_loss: 4.9103, tra_kl_loss: 6.2631, time_kl_loss: 2.5068, dis_kl_loss: 4.7846, contra_loss: 3487.0167, recon_loss: 0.0654
Test epoch:25, time: 3171.582620(s), Recall (@2: 0.1570, @5: 0.2443, @10: 0.3189), NDCG (@2: 0.1368, @5: 0.1757, @10: 0.1998)

Train epoch:26, time: 3171.582620(s), rec_loss: 4.8943, tra_kl_loss: 6.1605, time_kl_loss: 2.5360, dis_kl_loss: 4.7901, contra_loss: 3518.6637, recon_loss: 0.0648
Test epoch:26, time: 3190.918108(s), Recall (@2: 0.1449, @5: 0.2288, @10: 0.3016), NDCG (@2: 0.1267, @5: 0.1644, @10: 0.1878)

Train epoch:27, time: 3190.918108(s), rec_loss: 4.8847, tra_kl_loss: 6.1893, time_kl_loss: 2.4516, dis_kl_loss: 4.7771, contra_loss: 3475.1195, recon_loss: 0.0651
Test epoch:27, time: 3209.043544(s), Recall (@2: 0.1658, @5: 0.2598, @10: 0.3374), NDCG (@2: 0.1438, @5: 0.1861, @10: 0.2112)

Train epoch:28, time: 3209.043544(s), rec_loss: 4.8756, tra_kl_loss: 6.2345, time_kl_loss: 2.4096, dis_kl_loss: 4.8093, contra_loss: 3551.7862, recon_loss: 0.0655
Test epoch:28, time: 3228.279288(s), Recall (@2: 0.1516, @5: 0.2361, @10: 0.3053), NDCG (@2: 0.1322, @5: 0.1699, @10: 0.1923)

Train epoch:29, time: 3228.279288(s), rec_loss: 4.8570, tra_kl_loss: 6.1279, time_kl_loss: 2.5010, dis_kl_loss: 4.7956, contra_loss: 3514.9138, recon_loss: 0.0645
Test epoch:29, time: 3247.553245(s), Recall (@2: 0.1555, @5: 0.2428, @10: 0.3090), NDCG (@2: 0.1359, @5: 0.1750, @10: 0.1964)

Train epoch:30, time: 3247.553245(s), rec_loss: 4.8425, tra_kl_loss: 6.2113, time_kl_loss: 2.6757, dis_kl_loss: 4.7849, contra_loss: 3484.8537, recon_loss: 0.0651
Test epoch:30, time: 3266.935613(s), Recall (@2: 0.1641, @5: 0.2480, @10: 0.3226), NDCG (@2: 0.1437, @5: 0.1811, @10: 0.2053)

Train epoch:31, time: 3266.935613(s), rec_loss: 4.8367, tra_kl_loss: 6.1953, time_kl_loss: 2.4566, dis_kl_loss: 4.7718, contra_loss: 3548.0240, recon_loss: 0.0649
Test epoch:31, time: 3286.431913(s), Recall (@2: 0.1552, @5: 0.2428, @10: 0.3169), NDCG (@2: 0.1357, @5: 0.1754, @10: 0.1993)

Train epoch:32, time: 3286.431913(s), rec_loss: 4.8248, tra_kl_loss: 6.1988, time_kl_loss: 2.5899, dis_kl_loss: 4.7492, contra_loss: 3554.1951, recon_loss: 0.0638
Test epoch:32, time: 3305.658342(s), Recall (@2: 0.1524, @5: 0.2376, @10: 0.3051), NDCG (@2: 0.1329, @5: 0.1710, @10: 0.1927)

Train epoch:33, time: 3305.658342(s), rec_loss: 4.8145, tra_kl_loss: 6.2330, time_kl_loss: 2.4297, dis_kl_loss: 4.7881, contra_loss: 3576.1157, recon_loss: 0.0640
Test epoch:33, time: 3325.973149(s), Recall (@2: 0.1516, @5: 0.2352, @10: 0.3006), NDCG (@2: 0.1341, @5: 0.1713, @10: 0.1924)

Train epoch:34, time: 3325.973149(s), rec_loss: 4.8054, tra_kl_loss: 6.1496, time_kl_loss: 2.6479, dis_kl_loss: 4.7594, contra_loss: 3582.5712, recon_loss: 0.0642
Test epoch:34, time: 3345.341881(s), Recall (@2: 0.1507, @5: 0.2337, @10: 0.3040), NDCG (@2: 0.1314, @5: 0.1688, @10: 0.1914)

Train epoch:35, time: 3345.341881(s), rec_loss: 4.7893, tra_kl_loss: 6.1630, time_kl_loss: 2.4998, dis_kl_loss: 4.7648, contra_loss: 3544.4168, recon_loss: 0.0644
Test epoch:35, time: 3364.534460(s), Recall (@2: 0.1611, @5: 0.2484, @10: 0.3195), NDCG (@2: 0.1408, @5: 0.1798, @10: 0.2028)

Train epoch:36, time: 3364.534460(s), rec_loss: 4.7876, tra_kl_loss: 6.1713, time_kl_loss: 2.4498, dis_kl_loss: 4.7524, contra_loss: 3562.9877, recon_loss: 0.0642
Test epoch:36, time: 3383.922740(s), Recall (@2: 0.1555, @5: 0.2350, @10: 0.3064), NDCG (@2: 0.1352, @5: 0.1711, @10: 0.1942)

Train epoch:37, time: 3383.922740(s), rec_loss: 4.7757, tra_kl_loss: 6.1126, time_kl_loss: 2.6440, dis_kl_loss: 4.7169, contra_loss: 3576.1636, recon_loss: 0.0638
Test epoch:37, time: 3403.133029(s), Recall (@2: 0.1511, @5: 0.2337, @10: 0.3094), NDCG (@2: 0.1328, @5: 0.1700, @10: 0.1944)

Train epoch:38, time: 3403.133029(s), rec_loss: 4.7752, tra_kl_loss: 6.2258, time_kl_loss: 2.4594, dis_kl_loss: 4.7294, contra_loss: 3606.0721, recon_loss: 0.0645
Test epoch:38, time: 3422.413514(s), Recall (@2: 0.1559, @5: 0.2370, @10: 0.3038), NDCG (@2: 0.1376, @5: 0.1739, @10: 0.1956)

Train epoch:39, time: 3422.413514(s), rec_loss: 4.7605, tra_kl_loss: 6.2479, time_kl_loss: 2.5326, dis_kl_loss: 4.7712, contra_loss: 3591.0591, recon_loss: 0.0638
Test epoch:39, time: 3442.158836(s), Recall (@2: 0.1546, @5: 0.2361, @10: 0.3116), NDCG (@2: 0.1357, @5: 0.1722, @10: 0.1966)

Train epoch:40, time: 3442.158836(s), rec_loss: 4.7504, tra_kl_loss: 6.1606, time_kl_loss: 2.5710, dis_kl_loss: 4.7595, contra_loss: 3613.0687, recon_loss: 0.0642
Test epoch:40, time: 3461.469503(s), Recall (@2: 0.1486, @5: 0.2273, @10: 0.2937), NDCG (@2: 0.1314, @5: 0.1664, @10: 0.1879)

Train epoch:41, time: 3461.469503(s), rec_loss: 4.7472, tra_kl_loss: 6.1814, time_kl_loss: 2.5342, dis_kl_loss: 4.7689, contra_loss: 3604.9351, recon_loss: 0.0638
Test epoch:41, time: 3480.693219(s), Recall (@2: 0.1518, @5: 0.2378, @10: 0.3057), NDCG (@2: 0.1331, @5: 0.1716, @10: 0.1937)

Train epoch:42, time: 3480.693219(s), rec_loss: 4.7416, tra_kl_loss: 6.2337, time_kl_loss: 2.5256, dis_kl_loss: 4.7567, contra_loss: 3663.4679, recon_loss: 0.0637
Test epoch:42, time: 3499.995123(s), Recall (@2: 0.1572, @5: 0.2382, @10: 0.3090), NDCG (@2: 0.1376, @5: 0.1739, @10: 0.1967)

Train epoch:43, time: 3499.995123(s), rec_loss: 4.7298, tra_kl_loss: 6.2428, time_kl_loss: 2.6235, dis_kl_loss: 4.7594, contra_loss: 3626.2057, recon_loss: 0.0636
Test epoch:43, time: 3519.165603(s), Recall (@2: 0.1522, @5: 0.2339, @10: 0.3021), NDCG (@2: 0.1342, @5: 0.1708, @10: 0.1928)

Train epoch:44, time: 3519.165603(s), rec_loss: 4.7257, tra_kl_loss: 6.2700, time_kl_loss: 2.5302, dis_kl_loss: 4.7336, contra_loss: 3686.2301, recon_loss: 0.0632
Test epoch:44, time: 3538.544610(s), Recall (@2: 0.1546, @5: 0.2370, @10: 0.3081), NDCG (@2: 0.1359, @5: 0.1731, @10: 0.1959)

Train epoch:45, time: 3538.544610(s), rec_loss: 4.7188, tra_kl_loss: 6.2598, time_kl_loss: 2.5245, dis_kl_loss: 4.7607, contra_loss: 3695.4285, recon_loss: 0.0635
Test epoch:45, time: 3558.243231(s), Recall (@2: 0.1470, @5: 0.2335, @10: 0.3029), NDCG (@2: 0.1306, @5: 0.1694, @10: 0.1918)

Train epoch:46, time: 3558.243231(s), rec_loss: 4.7113, tra_kl_loss: 6.1227, time_kl_loss: 2.5247, dis_kl_loss: 4.7600, contra_loss: 3713.8331, recon_loss: 0.0636
Test epoch:46, time: 3578.172692(s), Recall (@2: 0.1542, @5: 0.2393, @10: 0.3055), NDCG (@2: 0.1358, @5: 0.1737, @10: 0.1949)

Train epoch:47, time: 3578.172692(s), rec_loss: 4.7048, tra_kl_loss: 6.2205, time_kl_loss: 2.5384, dis_kl_loss: 4.7729, contra_loss: 3735.1874, recon_loss: 0.0633
Test epoch:47, time: 3597.651178(s), Recall (@2: 0.1600, @5: 0.2434, @10: 0.3113), NDCG (@2: 0.1391, @5: 0.1761, @10: 0.1980)

Train epoch:48, time: 3597.651178(s), rec_loss: 4.7000, tra_kl_loss: 6.2574, time_kl_loss: 2.6354, dis_kl_loss: 4.7828, contra_loss: 3727.9123, recon_loss: 0.0641
Test epoch:48, time: 3616.259233(s), Recall (@2: 0.1537, @5: 0.2320, @10: 0.3019), NDCG (@2: 0.1361, @5: 0.1716, @10: 0.1940)

Train epoch:49, time: 3616.259233(s), rec_loss: 4.6947, tra_kl_loss: 6.2276, time_kl_loss: 2.5485, dis_kl_loss: 4.7268, contra_loss: 3755.4308, recon_loss: 0.0632
Test epoch:49, time: 3635.660999(s), Recall (@2: 0.1587, @5: 0.2406, @10: 0.3189), NDCG (@2: 0.1386, @5: 0.1753, @10: 0.2004)

Train epoch:50, time: 3635.660999(s), rec_loss: 4.6835, tra_kl_loss: 6.1582, time_kl_loss: 2.6241, dis_kl_loss: 4.7315, contra_loss: 3769.1521, recon_loss: 0.0636
Test epoch:50, time: 3654.753930(s), Recall (@2: 0.1533, @5: 0.2348, @10: 0.3077), NDCG (@2: 0.1343, @5: 0.1709, @10: 0.1944)
