dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:1
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.4
dis_delta:0.0
valid_epoch:1
device:cuda:1
In total: 737729 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0971, tra_kl_loss: 6.5458, time_kl_loss: 6.2138, dis_kl_loss: 6.0679, contra_loss: 15166.5507
Test epoch:1, time: 19.716262(s), Recall (@2: 0.0776, @5: 0.1313, @10: 0.2040), NDCG (@2: 0.0677, @5: 0.0915, @10: 0.1148)

Train epoch:2, time: 19.716262(s), rec_loss: 7.3635, tra_kl_loss: 7.0461, time_kl_loss: 8.3024, dis_kl_loss: 5.9175, contra_loss: 24795.6543
Test epoch:2, time: 38.335379(s), Recall (@2: 0.0996, @5: 0.1686, @10: 0.2359), NDCG (@2: 0.0871, @5: 0.1178, @10: 0.1396)

Train epoch:3, time: 38.335379(s), rec_loss: 6.8326, tra_kl_loss: 6.8366, time_kl_loss: 6.5984, dis_kl_loss: 5.2697, contra_loss: 26786.3716
Test epoch:3, time: 57.893022(s), Recall (@2: 0.1110, @5: 0.1824, @10: 0.2505), NDCG (@2: 0.0958, @5: 0.1276, @10: 0.1496)

Train epoch:4, time: 57.893022(s), rec_loss: 6.4458, tra_kl_loss: 6.5655, time_kl_loss: 4.9424, dis_kl_loss: 5.0178, contra_loss: 27246.1616
Test epoch:4, time: 77.005721(s), Recall (@2: 0.1229, @5: 0.1984, @10: 0.2715), NDCG (@2: 0.1059, @5: 0.1396, @10: 0.1632)

Train epoch:5, time: 77.005721(s), rec_loss: 6.1666, tra_kl_loss: 6.4690, time_kl_loss: 4.2107, dis_kl_loss: 4.9289, contra_loss: 27340.6457
Test epoch:5, time: 96.343781(s), Recall (@2: 0.1285, @5: 0.2022, @10: 0.2727), NDCG (@2: 0.1108, @5: 0.1437, @10: 0.1665)

Train epoch:6, time: 96.343781(s), rec_loss: 5.9558, tra_kl_loss: 6.3832, time_kl_loss: 3.9173, dis_kl_loss: 4.9695, contra_loss: 25570.2438
Test epoch:6, time: 1164.331544(s), Recall (@2: 0.1363, @5: 0.2188, @10: 0.2902), NDCG (@2: 0.1169, @5: 0.1537, @10: 0.1767)

Train epoch:7, time: 1164.331544(s), rec_loss: 5.7919, tra_kl_loss: 6.3779, time_kl_loss: 3.6011, dis_kl_loss: 4.9180, contra_loss: 24710.7159
Test epoch:7, time: 1183.739747(s), Recall (@2: 0.1369, @5: 0.2163, @10: 0.2844), NDCG (@2: 0.1180, @5: 0.1538, @10: 0.1758)

Train epoch:8, time: 1183.739747(s), rec_loss: 5.6524, tra_kl_loss: 6.4023, time_kl_loss: 3.5293, dis_kl_loss: 4.8548, contra_loss: 23713.0456
Test epoch:8, time: 1203.063620(s), Recall (@2: 0.1425, @5: 0.2292, @10: 0.2997), NDCG (@2: 0.1217, @5: 0.1607, @10: 0.1834)

Train epoch:9, time: 1203.063620(s), rec_loss: 5.5398, tra_kl_loss: 6.3403, time_kl_loss: 3.3849, dis_kl_loss: 4.8651, contra_loss: 22449.3151
Test epoch:9, time: 1222.349866(s), Recall (@2: 0.1494, @5: 0.2311, @10: 0.3075), NDCG (@2: 0.1269, @5: 0.1636, @10: 0.1884)

Train epoch:10, time: 1222.349866(s), rec_loss: 5.4560, tra_kl_loss: 6.2943, time_kl_loss: 3.2308, dis_kl_loss: 4.8694, contra_loss: 20767.4181
Test epoch:10, time: 1241.737279(s), Recall (@2: 0.1429, @5: 0.2268, @10: 0.2954), NDCG (@2: 0.1227, @5: 0.1604, @10: 0.1825)

Train epoch:11, time: 1241.737279(s), rec_loss: 5.3878, tra_kl_loss: 6.4028, time_kl_loss: 2.9923, dis_kl_loss: 4.8056, contra_loss: 20668.9302
Test epoch:11, time: 1470.125081(s), Recall (@2: 0.1447, @5: 0.2301, @10: 0.3019), NDCG (@2: 0.1247, @5: 0.1636, @10: 0.1868)

Train epoch:12, time: 1470.125081(s), rec_loss: 5.3103, tra_kl_loss: 6.3287, time_kl_loss: 3.1083, dis_kl_loss: 4.7954, contra_loss: 19755.3591
Test epoch:12, time: 1489.414885(s), Recall (@2: 0.1442, @5: 0.2357, @10: 0.3023), NDCG (@2: 0.1241, @5: 0.1652, @10: 0.1868)

Train epoch:13, time: 1489.414885(s), rec_loss: 5.2598, tra_kl_loss: 6.3039, time_kl_loss: 2.8914, dis_kl_loss: 4.7979, contra_loss: 18267.4496
Test epoch:13, time: 1509.515148(s), Recall (@2: 0.1520, @5: 0.2374, @10: 0.3083), NDCG (@2: 0.1297, @5: 0.1679, @10: 0.1908)

Train epoch:14, time: 1509.515148(s), rec_loss: 5.2211, tra_kl_loss: 6.3883, time_kl_loss: 2.9933, dis_kl_loss: 4.7953, contra_loss: 17537.3301
Test epoch:14, time: 1641.573389(s), Recall (@2: 0.1585, @5: 0.2503, @10: 0.3262), NDCG (@2: 0.1349, @5: 0.1762, @10: 0.2007)

Train epoch:15, time: 1641.573389(s), rec_loss: 5.1848, tra_kl_loss: 6.2692, time_kl_loss: 2.7269, dis_kl_loss: 4.8071, contra_loss: 16263.6577
Test epoch:15, time: 1661.539831(s), Recall (@2: 0.1386, @5: 0.2277, @10: 0.3014), NDCG (@2: 0.1207, @5: 0.1608, @10: 0.1847)

Train epoch:16, time: 1661.539831(s), rec_loss: 5.1451, tra_kl_loss: 6.2185, time_kl_loss: 2.8843, dis_kl_loss: 4.7802, contra_loss: 15639.9214
Test epoch:16, time: 1681.782755(s), Recall (@2: 0.1533, @5: 0.2490, @10: 0.3226), NDCG (@2: 0.1316, @5: 0.1744, @10: 0.1982)

Train epoch:17, time: 1681.782755(s), rec_loss: 5.1066, tra_kl_loss: 6.3030, time_kl_loss: 2.8606, dis_kl_loss: 4.7723, contra_loss: 15364.4341
Test epoch:17, time: 2219.956774(s), Recall (@2: 0.1462, @5: 0.2283, @10: 0.2962), NDCG (@2: 0.1260, @5: 0.1630, @10: 0.1849)

Train epoch:18, time: 2219.956774(s), rec_loss: 5.0868, tra_kl_loss: 6.2093, time_kl_loss: 2.6473, dis_kl_loss: 4.7530, contra_loss: 14110.5627
Test epoch:18, time: 2239.106887(s), Recall (@2: 0.1516, @5: 0.2454, @10: 0.3159), NDCG (@2: 0.1308, @5: 0.1727, @10: 0.1954)

Train epoch:19, time: 2239.106887(s), rec_loss: 5.0576, tra_kl_loss: 6.3200, time_kl_loss: 2.6586, dis_kl_loss: 4.7726, contra_loss: 13926.9613
Test epoch:19, time: 2259.150800(s), Recall (@2: 0.1557, @5: 0.2436, @10: 0.3150), NDCG (@2: 0.1343, @5: 0.1740, @10: 0.1969)

Train epoch:20, time: 2259.150800(s), rec_loss: 5.0410, tra_kl_loss: 6.3204, time_kl_loss: 2.8794, dis_kl_loss: 4.7533, contra_loss: 13322.9838
Test epoch:20, time: 2278.372868(s), Recall (@2: 0.1563, @5: 0.2408, @10: 0.3172), NDCG (@2: 0.1347, @5: 0.1725, @10: 0.1970)

Train epoch:21, time: 2278.372868(s), rec_loss: 5.0138, tra_kl_loss: 6.2035, time_kl_loss: 2.6713, dis_kl_loss: 4.7625, contra_loss: 12948.2216
Test epoch:21, time: 2297.605719(s), Recall (@2: 0.1574, @5: 0.2451, @10: 0.3226), NDCG (@2: 0.1338, @5: 0.1731, @10: 0.1979)

Train epoch:22, time: 2297.605719(s), rec_loss: 4.9929, tra_kl_loss: 6.2881, time_kl_loss: 2.5945, dis_kl_loss: 4.7721, contra_loss: 12418.2346
Test epoch:22, time: 3103.437837(s), Recall (@2: 0.1520, @5: 0.2357, @10: 0.3129), NDCG (@2: 0.1334, @5: 0.1711, @10: 0.1961)

Train epoch:23, time: 3103.437837(s), rec_loss: 4.9730, tra_kl_loss: 6.2802, time_kl_loss: 2.6588, dis_kl_loss: 4.7953, contra_loss: 12054.4088
Test epoch:23, time: 3122.972134(s), Recall (@2: 0.1503, @5: 0.2398, @10: 0.3129), NDCG (@2: 0.1313, @5: 0.1714, @10: 0.1950)

Train epoch:24, time: 3122.972134(s), rec_loss: 4.9558, tra_kl_loss: 6.4095, time_kl_loss: 2.6671, dis_kl_loss: 4.7420, contra_loss: 11821.9912
Test epoch:24, time: 3142.991760(s), Recall (@2: 0.1561, @5: 0.2389, @10: 0.3176), NDCG (@2: 0.1365, @5: 0.1737, @10: 0.1991)

Train epoch:25, time: 3142.991760(s), rec_loss: 4.9397, tra_kl_loss: 6.2342, time_kl_loss: 2.7068, dis_kl_loss: 4.7410, contra_loss: 11138.9725
Test epoch:25, time: 3162.553033(s), Recall (@2: 0.1565, @5: 0.2421, @10: 0.3180), NDCG (@2: 0.1349, @5: 0.1732, @10: 0.1977)

Train epoch:26, time: 3162.553033(s), rec_loss: 4.9309, tra_kl_loss: 6.2799, time_kl_loss: 2.6486, dis_kl_loss: 4.7116, contra_loss: 10693.4035
Test epoch:26, time: 3321.643264(s), Recall (@2: 0.1563, @5: 0.2449, @10: 0.3230), NDCG (@2: 0.1373, @5: 0.1773, @10: 0.2025)

Train epoch:27, time: 3321.643264(s), rec_loss: 4.9193, tra_kl_loss: 6.3583, time_kl_loss: 2.5850, dis_kl_loss: 4.7437, contra_loss: 10279.9799
Test epoch:27, time: 3341.165507(s), Recall (@2: 0.1498, @5: 0.2402, @10: 0.3141), NDCG (@2: 0.1302, @5: 0.1708, @10: 0.1947)

Train epoch:28, time: 3341.165507(s), rec_loss: 4.9008, tra_kl_loss: 6.3158, time_kl_loss: 2.6447, dis_kl_loss: 4.7319, contra_loss: 10009.9804
Test epoch:28, time: 3360.981186(s), Recall (@2: 0.1522, @5: 0.2408, @10: 0.3152), NDCG (@2: 0.1342, @5: 0.1739, @10: 0.1979)

Train epoch:29, time: 3360.981186(s), rec_loss: 4.8868, tra_kl_loss: 6.2182, time_kl_loss: 2.6158, dis_kl_loss: 4.7692, contra_loss: 9491.5644
Test epoch:29, time: 4125.572802(s), Recall (@2: 0.1552, @5: 0.2499, @10: 0.3234), NDCG (@2: 0.1338, @5: 0.1762, @10: 0.2001)

Train epoch:30, time: 4125.572802(s), rec_loss: 4.8713, tra_kl_loss: 6.2092, time_kl_loss: 2.5389, dis_kl_loss: 4.7693, contra_loss: 9144.5862
Test epoch:30, time: 4145.393008(s), Recall (@2: 0.1542, @5: 0.2380, @10: 0.3068), NDCG (@2: 0.1355, @5: 0.1732, @10: 0.1955)

Train epoch:31, time: 4145.393008(s), rec_loss: 4.8598, tra_kl_loss: 6.2096, time_kl_loss: 2.5280, dis_kl_loss: 4.7303, contra_loss: 9159.6217
Test epoch:31, time: 4164.407061(s), Recall (@2: 0.1567, @5: 0.2402, @10: 0.3094), NDCG (@2: 0.1366, @5: 0.1739, @10: 0.1963)

Train epoch:32, time: 4164.407061(s), rec_loss: 4.8477, tra_kl_loss: 6.2492, time_kl_loss: 2.5699, dis_kl_loss: 4.7167, contra_loss: 8889.3547
Test epoch:32, time: 4183.742094(s), Recall (@2: 0.1561, @5: 0.2486, @10: 0.3279), NDCG (@2: 0.1366, @5: 0.1777, @10: 0.2033)

Train epoch:33, time: 4183.742094(s), rec_loss: 4.8401, tra_kl_loss: 6.2092, time_kl_loss: 2.5666, dis_kl_loss: 4.7432, contra_loss: 8526.4787
Test epoch:33, time: 5114.745248(s), Recall (@2: 0.1574, @5: 0.2387, @10: 0.3189), NDCG (@2: 0.1352, @5: 0.1712, @10: 0.1971)

Train epoch:34, time: 5114.745248(s), rec_loss: 4.8341, tra_kl_loss: 6.3503, time_kl_loss: 2.4662, dis_kl_loss: 4.7696, contra_loss: 8617.0743
Test epoch:34, time: 5133.866374(s), Recall (@2: 0.1531, @5: 0.2352, @10: 0.3187), NDCG (@2: 0.1336, @5: 0.1703, @10: 0.1971)

Train epoch:35, time: 5133.866374(s), rec_loss: 4.8164, tra_kl_loss: 6.2903, time_kl_loss: 2.5343, dis_kl_loss: 4.7216, contra_loss: 8567.4745
Test epoch:35, time: 5153.110172(s), Recall (@2: 0.1578, @5: 0.2475, @10: 0.3262), NDCG (@2: 0.1373, @5: 0.1778, @10: 0.2030)

Train epoch:36, time: 5153.110172(s), rec_loss: 4.8142, tra_kl_loss: 6.2862, time_kl_loss: 2.5959, dis_kl_loss: 4.7979, contra_loss: 8336.2434
Test epoch:36, time: 5172.350930(s), Recall (@2: 0.1533, @5: 0.2370, @10: 0.3137), NDCG (@2: 0.1335, @5: 0.1711, @10: 0.1957)

Train epoch:37, time: 5172.350930(s), rec_loss: 4.7988, tra_kl_loss: 6.2532, time_kl_loss: 2.4817, dis_kl_loss: 4.7250, contra_loss: 8182.6277
Test epoch:37, time: 5191.444924(s), Recall (@2: 0.1535, @5: 0.2439, @10: 0.3176), NDCG (@2: 0.1330, @5: 0.1735, @10: 0.1973)

Train epoch:38, time: 5191.444924(s), rec_loss: 4.7886, tra_kl_loss: 6.3233, time_kl_loss: 2.6325, dis_kl_loss: 4.7501, contra_loss: 7920.2930
Test epoch:38, time: 5209.597953(s), Recall (@2: 0.1539, @5: 0.2367, @10: 0.3146), NDCG (@2: 0.1344, @5: 0.1717, @10: 0.1967)

Train epoch:39, time: 5209.597953(s), rec_loss: 4.7855, tra_kl_loss: 6.2061, time_kl_loss: 2.5721, dis_kl_loss: 4.6859, contra_loss: 7590.5516
Test epoch:39, time: 5228.789706(s), Recall (@2: 0.1490, @5: 0.2354, @10: 0.3109), NDCG (@2: 0.1304, @5: 0.1694, @10: 0.1936)

Train epoch:40, time: 5228.789706(s), rec_loss: 4.7751, tra_kl_loss: 6.1555, time_kl_loss: 2.5837, dis_kl_loss: 4.7743, contra_loss: 7349.0196
Test epoch:40, time: 5249.258531(s), Recall (@2: 0.1533, @5: 0.2372, @10: 0.3191), NDCG (@2: 0.1340, @5: 0.1718, @10: 0.1984)

Train epoch:41, time: 5249.258531(s), rec_loss: 4.7668, tra_kl_loss: 6.3105, time_kl_loss: 2.5156, dis_kl_loss: 4.7132, contra_loss: 7618.2135
Test epoch:41, time: 5268.403734(s), Recall (@2: 0.1503, @5: 0.2382, @10: 0.3135), NDCG (@2: 0.1316, @5: 0.1709, @10: 0.1951)

Train epoch:42, time: 5268.403734(s), rec_loss: 4.7550, tra_kl_loss: 6.2698, time_kl_loss: 2.6103, dis_kl_loss: 4.7353, contra_loss: 7312.1159
Test epoch:42, time: 5287.820401(s), Recall (@2: 0.1503, @5: 0.2342, @10: 0.3060), NDCG (@2: 0.1294, @5: 0.1670, @10: 0.1900)

Train epoch:43, time: 5287.820401(s), rec_loss: 4.7494, tra_kl_loss: 6.3430, time_kl_loss: 2.5574, dis_kl_loss: 4.7221, contra_loss: 7315.6346
Test epoch:43, time: 5655.554552(s), Recall (@2: 0.1460, @5: 0.2320, @10: 0.3051), NDCG (@2: 0.1272, @5: 0.1660, @10: 0.1896)

Train epoch:44, time: 5655.554552(s), rec_loss: 4.7430, tra_kl_loss: 6.2811, time_kl_loss: 2.6422, dis_kl_loss: 4.7082, contra_loss: 7043.1960
Test epoch:44, time: 5674.351949(s), Recall (@2: 0.1531, @5: 0.2393, @10: 0.3202), NDCG (@2: 0.1353, @5: 0.1741, @10: 0.2003)

Train epoch:45, time: 5674.351949(s), rec_loss: 4.7377, tra_kl_loss: 6.1525, time_kl_loss: 2.6123, dis_kl_loss: 4.7920, contra_loss: 6827.1702
Test epoch:45, time: 5693.343114(s), Recall (@2: 0.1488, @5: 0.2350, @10: 0.3137), NDCG (@2: 0.1298, @5: 0.1686, @10: 0.1941)

Train epoch:46, time: 5693.343114(s), rec_loss: 4.7317, tra_kl_loss: 6.2481, time_kl_loss: 2.6965, dis_kl_loss: 4.7609, contra_loss: 6762.2998
Test epoch:46, time: 5712.065306(s), Recall (@2: 0.1464, @5: 0.2296, @10: 0.3083), NDCG (@2: 0.1301, @5: 0.1676, @10: 0.1931)

Train epoch:47, time: 5712.065306(s), rec_loss: 4.7281, tra_kl_loss: 6.2497, time_kl_loss: 2.6131, dis_kl_loss: 4.7304, contra_loss: 6756.1667
Test epoch:47, time: 5731.250872(s), Recall (@2: 0.1514, @5: 0.2339, @10: 0.3107), NDCG (@2: 0.1325, @5: 0.1698, @10: 0.1945)

Train epoch:48, time: 5731.250872(s), rec_loss: 4.7219, tra_kl_loss: 6.2440, time_kl_loss: 2.6116, dis_kl_loss: 4.7684, contra_loss: 6826.4827
Test epoch:48, time: 5750.426159(s), Recall (@2: 0.1509, @5: 0.2292, @10: 0.3090), NDCG (@2: 0.1315, @5: 0.1666, @10: 0.1925)

Train epoch:49, time: 5750.426159(s), rec_loss: 4.7144, tra_kl_loss: 6.3194, time_kl_loss: 2.4939, dis_kl_loss: 4.7321, contra_loss: 6759.0613
Test epoch:49, time: 5769.357325(s), Recall (@2: 0.1486, @5: 0.2307, @10: 0.3068), NDCG (@2: 0.1294, @5: 0.1658, @10: 0.1905)

Train epoch:50, time: 5769.357325(s), rec_loss: 4.7106, tra_kl_loss: 6.2956, time_kl_loss: 2.4616, dis_kl_loss: 4.7288, contra_loss: 6597.2428
Test epoch:50, time: 5788.337013(s), Recall (@2: 0.1535, @5: 0.2344, @10: 0.3118), NDCG (@2: 0.1344, @5: 0.1708, @10: 0.1956)
