dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:3
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.0
dis_delta:0.0
valid_epoch:1
device:cuda:3
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0988, tra_kl_loss: 6.5788, time_kl_loss: 5.9969, dis_kl_loss: 5.9811, contra_loss: 14322.5547
Test epoch:1, time: 13.886564(s), Recall (@2: 0.1125, @5: 0.1660, @10: 0.2197), NDCG (@2: 0.0989, @5: 0.1227, @10: 0.1398)

Train epoch:2, time: 13.886564(s), rec_loss: 7.3774, tra_kl_loss: 7.3382, time_kl_loss: 6.4526, dis_kl_loss: 6.4785, contra_loss: 27750.2527
Test epoch:2, time: 26.897354(s), Recall (@2: 0.1171, @5: 0.1984, @10: 0.2579), NDCG (@2: 0.1033, @5: 0.1394, @10: 0.1587)

Train epoch:3, time: 26.897354(s), rec_loss: 6.8952, tra_kl_loss: 6.9660, time_kl_loss: 6.2738, dis_kl_loss: 6.2563, contra_loss: 30327.3611
Test epoch:3, time: 40.144227(s), Recall (@2: 0.1162, @5: 0.1902, @10: 0.2602), NDCG (@2: 0.1014, @5: 0.1344, @10: 0.1570)

Train epoch:4, time: 40.144227(s), rec_loss: 6.5239, tra_kl_loss: 6.5491, time_kl_loss: 6.0984, dis_kl_loss: 6.1002, contra_loss: 28804.2267
Test epoch:4, time: 53.659808(s), Recall (@2: 0.1270, @5: 0.2096, @10: 0.2779), NDCG (@2: 0.1098, @5: 0.1469, @10: 0.1691)

Train epoch:5, time: 53.659808(s), rec_loss: 6.2316, tra_kl_loss: 6.4471, time_kl_loss: 5.9240, dis_kl_loss: 5.9140, contra_loss: 27514.1650
Test epoch:5, time: 66.442211(s), Recall (@2: 0.1268, @5: 0.2083, @10: 0.2794), NDCG (@2: 0.1082, @5: 0.1447, @10: 0.1676)

Train epoch:6, time: 66.442211(s), rec_loss: 6.0068, tra_kl_loss: 6.4173, time_kl_loss: 6.0880, dis_kl_loss: 6.0848, contra_loss: 26497.5540
Test epoch:6, time: 79.535550(s), Recall (@2: 0.1337, @5: 0.2204, @10: 0.2937), NDCG (@2: 0.1145, @5: 0.1536, @10: 0.1774)

Train epoch:7, time: 79.535550(s), rec_loss: 5.8142, tra_kl_loss: 6.4531, time_kl_loss: 5.9787, dis_kl_loss: 5.9768, contra_loss: 25391.4746
Test epoch:7, time: 92.741377(s), Recall (@2: 0.1352, @5: 0.2210, @10: 0.2952), NDCG (@2: 0.1148, @5: 0.1537, @10: 0.1776)

Train epoch:8, time: 92.741377(s), rec_loss: 5.6654, tra_kl_loss: 6.4282, time_kl_loss: 6.0613, dis_kl_loss: 6.0620, contra_loss: 23341.9781
Test epoch:8, time: 105.534271(s), Recall (@2: 0.1423, @5: 0.2311, @10: 0.3057), NDCG (@2: 0.1214, @5: 0.1615, @10: 0.1859)

Train epoch:9, time: 105.534271(s), rec_loss: 5.5518, tra_kl_loss: 6.3928, time_kl_loss: 5.7652, dis_kl_loss: 5.7568, contra_loss: 22334.9622
Test epoch:9, time: 118.568499(s), Recall (@2: 0.1412, @5: 0.2264, @10: 0.3049), NDCG (@2: 0.1214, @5: 0.1594, @10: 0.1846)

Train epoch:10, time: 118.568499(s), rec_loss: 5.4476, tra_kl_loss: 6.3041, time_kl_loss: 5.7617, dis_kl_loss: 5.7632, contra_loss: 20071.9454
Test epoch:10, time: 131.589123(s), Recall (@2: 0.1440, @5: 0.2298, @10: 0.3006), NDCG (@2: 0.1243, @5: 0.1626, @10: 0.1854)

Train epoch:11, time: 131.589123(s), rec_loss: 5.3699, tra_kl_loss: 6.3465, time_kl_loss: 5.8183, dis_kl_loss: 5.8250, contra_loss: 20073.4100
Test epoch:11, time: 144.315606(s), Recall (@2: 0.1464, @5: 0.2378, @10: 0.3116), NDCG (@2: 0.1254, @5: 0.1661, @10: 0.1897)

Train epoch:12, time: 144.315606(s), rec_loss: 5.3065, tra_kl_loss: 6.2594, time_kl_loss: 5.6028, dis_kl_loss: 5.6113, contra_loss: 18672.8869
Test epoch:12, time: 157.056309(s), Recall (@2: 0.1481, @5: 0.2333, @10: 0.3075), NDCG (@2: 0.1278, @5: 0.1658, @10: 0.1897)

Train epoch:13, time: 157.056309(s), rec_loss: 5.2587, tra_kl_loss: 6.3551, time_kl_loss: 5.7523, dis_kl_loss: 5.7552, contra_loss: 18402.8614
Test epoch:13, time: 169.690222(s), Recall (@2: 0.1501, @5: 0.2417, @10: 0.3154), NDCG (@2: 0.1293, @5: 0.1706, @10: 0.1944)

Train epoch:14, time: 169.690222(s), rec_loss: 5.2063, tra_kl_loss: 6.2685, time_kl_loss: 5.6059, dis_kl_loss: 5.6098, contra_loss: 17620.5070
Test epoch:14, time: 182.197759(s), Recall (@2: 0.1481, @5: 0.2370, @10: 0.3083), NDCG (@2: 0.1284, @5: 0.1684, @10: 0.1914)

Train epoch:15, time: 182.197759(s), rec_loss: 5.1607, tra_kl_loss: 6.2627, time_kl_loss: 5.5565, dis_kl_loss: 5.5547, contra_loss: 16845.5109
Test epoch:15, time: 194.954560(s), Recall (@2: 0.1481, @5: 0.2354, @10: 0.3079), NDCG (@2: 0.1286, @5: 0.1679, @10: 0.1914)

Train epoch:16, time: 194.954560(s), rec_loss: 5.1287, tra_kl_loss: 6.2453, time_kl_loss: 5.6836, dis_kl_loss: 5.6730, contra_loss: 15926.0570
Test epoch:16, time: 207.443670(s), Recall (@2: 0.1503, @5: 0.2393, @10: 0.3094), NDCG (@2: 0.1303, @5: 0.1705, @10: 0.1932)

Train epoch:17, time: 207.443670(s), rec_loss: 5.0910, tra_kl_loss: 6.2508, time_kl_loss: 5.6496, dis_kl_loss: 5.6478, contra_loss: 15264.2288
Test epoch:17, time: 220.378057(s), Recall (@2: 0.1507, @5: 0.2421, @10: 0.3157), NDCG (@2: 0.1299, @5: 0.1711, @10: 0.1948)

Train epoch:18, time: 220.378057(s), rec_loss: 5.0658, tra_kl_loss: 6.3024, time_kl_loss: 5.7234, dis_kl_loss: 5.7160, contra_loss: 14845.1753
Test epoch:18, time: 233.055886(s), Recall (@2: 0.1520, @5: 0.2354, @10: 0.3031), NDCG (@2: 0.1328, @5: 0.1702, @10: 0.1921)

Train epoch:19, time: 233.055886(s), rec_loss: 5.0354, tra_kl_loss: 6.1818, time_kl_loss: 5.5641, dis_kl_loss: 5.5687, contra_loss: 13892.0479
Test epoch:19, time: 245.638736(s), Recall (@2: 0.1550, @5: 0.2408, @10: 0.3137), NDCG (@2: 0.1342, @5: 0.1728, @10: 0.1965)

Train epoch:20, time: 245.638736(s), rec_loss: 5.0138, tra_kl_loss: 6.2687, time_kl_loss: 5.5212, dis_kl_loss: 5.5128, contra_loss: 13667.3683
Test epoch:20, time: 257.951949(s), Recall (@2: 0.1514, @5: 0.2404, @10: 0.3118), NDCG (@2: 0.1314, @5: 0.1717, @10: 0.1946)

Train epoch:21, time: 257.951949(s), rec_loss: 4.9862, tra_kl_loss: 6.2664, time_kl_loss: 5.5141, dis_kl_loss: 5.5169, contra_loss: 13462.2724
Test epoch:21, time: 270.332371(s), Recall (@2: 0.1496, @5: 0.2395, @10: 0.3141), NDCG (@2: 0.1309, @5: 0.1714, @10: 0.1953)

Train epoch:22, time: 270.332371(s), rec_loss: 4.9614, tra_kl_loss: 6.2194, time_kl_loss: 5.6280, dis_kl_loss: 5.6307, contra_loss: 12838.0529
Test epoch:22, time: 282.616865(s), Recall (@2: 0.1621, @5: 0.2561, @10: 0.3307), NDCG (@2: 0.1402, @5: 0.1823, @10: 0.2064)

Train epoch:23, time: 282.616865(s), rec_loss: 4.9477, tra_kl_loss: 6.3421, time_kl_loss: 5.4943, dis_kl_loss: 5.4879, contra_loss: 12859.9071
Test epoch:23, time: 294.918621(s), Recall (@2: 0.1486, @5: 0.2322, @10: 0.3042), NDCG (@2: 0.1289, @5: 0.1663, @10: 0.1895)

Train epoch:24, time: 294.918621(s), rec_loss: 4.9228, tra_kl_loss: 6.2532, time_kl_loss: 5.4733, dis_kl_loss: 5.4710, contra_loss: 12522.9273
Test epoch:24, time: 307.233527(s), Recall (@2: 0.1537, @5: 0.2395, @10: 0.3116), NDCG (@2: 0.1338, @5: 0.1724, @10: 0.1956)

Train epoch:25, time: 307.233527(s), rec_loss: 4.9066, tra_kl_loss: 6.3951, time_kl_loss: 5.5333, dis_kl_loss: 5.5260, contra_loss: 12327.8652
Test epoch:25, time: 319.929543(s), Recall (@2: 0.1585, @5: 0.2458, @10: 0.3157), NDCG (@2: 0.1375, @5: 0.1766, @10: 0.1991)

Train epoch:26, time: 319.929543(s), rec_loss: 4.8915, tra_kl_loss: 6.3161, time_kl_loss: 5.4317, dis_kl_loss: 5.4227, contra_loss: 11915.2356
Test epoch:26, time: 332.971175(s), Recall (@2: 0.1447, @5: 0.2294, @10: 0.3019), NDCG (@2: 0.1277, @5: 0.1660, @10: 0.1895)

Train epoch:27, time: 332.971175(s), rec_loss: 4.8772, tra_kl_loss: 6.2969, time_kl_loss: 5.3512, dis_kl_loss: 5.3399, contra_loss: 11514.0220
Test epoch:27, time: 345.250727(s), Recall (@2: 0.1677, @5: 0.2607, @10: 0.3329), NDCG (@2: 0.1462, @5: 0.1878, @10: 0.2111)

Train epoch:28, time: 345.250727(s), rec_loss: 4.8669, tra_kl_loss: 6.3452, time_kl_loss: 5.3665, dis_kl_loss: 5.3638, contra_loss: 11440.6775
Test epoch:28, time: 357.536329(s), Recall (@2: 0.1466, @5: 0.2288, @10: 0.3027), NDCG (@2: 0.1291, @5: 0.1666, @10: 0.1904)

Train epoch:29, time: 357.536329(s), rec_loss: 4.8485, tra_kl_loss: 6.2820, time_kl_loss: 5.4761, dis_kl_loss: 5.4727, contra_loss: 11075.5192
Test epoch:29, time: 369.712339(s), Recall (@2: 0.1518, @5: 0.2385, @10: 0.3090), NDCG (@2: 0.1329, @5: 0.1719, @10: 0.1946)

Train epoch:30, time: 369.712339(s), rec_loss: 4.8316, tra_kl_loss: 6.2534, time_kl_loss: 5.3414, dis_kl_loss: 5.3433, contra_loss: 11175.3605
Test epoch:30, time: 382.002460(s), Recall (@2: 0.1570, @5: 0.2434, @10: 0.3159), NDCG (@2: 0.1388, @5: 0.1777, @10: 0.2011)

Train epoch:31, time: 382.002460(s), rec_loss: 4.8201, tra_kl_loss: 6.2879, time_kl_loss: 5.3729, dis_kl_loss: 5.3808, contra_loss: 10973.5370
Test epoch:31, time: 394.420899(s), Recall (@2: 0.1572, @5: 0.2348, @10: 0.3094), NDCG (@2: 0.1366, @5: 0.1717, @10: 0.1960)

Train epoch:32, time: 394.420899(s), rec_loss: 4.8080, tra_kl_loss: 6.4357, time_kl_loss: 5.4437, dis_kl_loss: 5.4456, contra_loss: 10717.1642
Test epoch:32, time: 406.670109(s), Recall (@2: 0.1494, @5: 0.2307, @10: 0.3070), NDCG (@2: 0.1314, @5: 0.1677, @10: 0.1924)

Train epoch:33, time: 406.670109(s), rec_loss: 4.7978, tra_kl_loss: 6.2731, time_kl_loss: 5.3020, dis_kl_loss: 5.2994, contra_loss: 10211.4241
Test epoch:33, time: 419.090179(s), Recall (@2: 0.1520, @5: 0.2301, @10: 0.3012), NDCG (@2: 0.1327, @5: 0.1678, @10: 0.1907)

Train epoch:34, time: 419.090179(s), rec_loss: 4.7827, tra_kl_loss: 6.2503, time_kl_loss: 5.4345, dis_kl_loss: 5.4234, contra_loss: 10097.0529
Test epoch:34, time: 431.415689(s), Recall (@2: 0.1451, @5: 0.2154, @10: 0.2842), NDCG (@2: 0.1270, @5: 0.1587, @10: 0.1810)

Train epoch:35, time: 431.415689(s), rec_loss: 4.7687, tra_kl_loss: 6.2409, time_kl_loss: 5.4083, dis_kl_loss: 5.4102, contra_loss: 9698.9773
Test epoch:35, time: 443.951604(s), Recall (@2: 0.1565, @5: 0.2462, @10: 0.3180), NDCG (@2: 0.1372, @5: 0.1773, @10: 0.2004)

Train epoch:36, time: 443.951604(s), rec_loss: 4.7628, tra_kl_loss: 6.2703, time_kl_loss: 5.5399, dis_kl_loss: 5.5388, contra_loss: 9862.3364
Test epoch:36, time: 456.978691(s), Recall (@2: 0.1486, @5: 0.2298, @10: 0.3094), NDCG (@2: 0.1313, @5: 0.1677, @10: 0.1934)

Train epoch:37, time: 456.978691(s), rec_loss: 4.7476, tra_kl_loss: 6.2036, time_kl_loss: 5.3586, dis_kl_loss: 5.3635, contra_loss: 9201.8222
Test epoch:37, time: 469.616034(s), Recall (@2: 0.1458, @5: 0.2236, @10: 0.2934), NDCG (@2: 0.1271, @5: 0.1622, @10: 0.1847)

Train epoch:38, time: 469.616034(s), rec_loss: 4.7466, tra_kl_loss: 6.3884, time_kl_loss: 5.3494, dis_kl_loss: 5.3463, contra_loss: 9438.2096
Test epoch:38, time: 482.132365(s), Recall (@2: 0.1468, @5: 0.2283, @10: 0.3038), NDCG (@2: 0.1310, @5: 0.1677, @10: 0.1921)

Train epoch:39, time: 482.132365(s), rec_loss: 4.7257, tra_kl_loss: 6.2779, time_kl_loss: 5.5811, dis_kl_loss: 5.5755, contra_loss: 9086.5077
Test epoch:39, time: 494.415543(s), Recall (@2: 0.1498, @5: 0.2348, @10: 0.3066), NDCG (@2: 0.1321, @5: 0.1699, @10: 0.1931)

Train epoch:40, time: 494.415543(s), rec_loss: 4.7179, tra_kl_loss: 6.2508, time_kl_loss: 5.5178, dis_kl_loss: 5.5122, contra_loss: 8941.2327
Test epoch:40, time: 506.404838(s), Recall (@2: 0.1425, @5: 0.2245, @10: 0.2926), NDCG (@2: 0.1250, @5: 0.1617, @10: 0.1835)

Train epoch:41, time: 506.404838(s), rec_loss: 4.7134, tra_kl_loss: 6.2624, time_kl_loss: 5.4577, dis_kl_loss: 5.4634, contra_loss: 9048.6197
Test epoch:41, time: 518.296215(s), Recall (@2: 0.1518, @5: 0.2374, @10: 0.3038), NDCG (@2: 0.1321, @5: 0.1702, @10: 0.1916)

Train epoch:42, time: 518.296215(s), rec_loss: 4.7056, tra_kl_loss: 6.3975, time_kl_loss: 5.3633, dis_kl_loss: 5.3575, contra_loss: 9107.5139
Test epoch:42, time: 530.670856(s), Recall (@2: 0.1496, @5: 0.2342, @10: 0.3008), NDCG (@2: 0.1336, @5: 0.1716, @10: 0.1931)

Train epoch:43, time: 530.670856(s), rec_loss: 4.6870, tra_kl_loss: 6.3173, time_kl_loss: 5.4993, dis_kl_loss: 5.5011, contra_loss: 8595.5525
Test epoch:43, time: 542.982770(s), Recall (@2: 0.1477, @5: 0.2270, @10: 0.3012), NDCG (@2: 0.1295, @5: 0.1652, @10: 0.1892)

Train epoch:44, time: 542.982770(s), rec_loss: 4.6805, tra_kl_loss: 6.3648, time_kl_loss: 5.4700, dis_kl_loss: 5.4608, contra_loss: 8818.0527
Test epoch:44, time: 555.020910(s), Recall (@2: 0.1475, @5: 0.2279, @10: 0.2999), NDCG (@2: 0.1310, @5: 0.1672, @10: 0.1904)

Train epoch:45, time: 555.020910(s), rec_loss: 4.6772, tra_kl_loss: 6.2937, time_kl_loss: 5.4496, dis_kl_loss: 5.4496, contra_loss: 8790.6817
Test epoch:45, time: 567.202277(s), Recall (@2: 0.1470, @5: 0.2290, @10: 0.2978), NDCG (@2: 0.1306, @5: 0.1673, @10: 0.1895)

Train epoch:46, time: 567.202277(s), rec_loss: 4.6631, tra_kl_loss: 6.1673, time_kl_loss: 5.5762, dis_kl_loss: 5.5779, contra_loss: 8499.2368
Test epoch:46, time: 579.084307(s), Recall (@2: 0.1498, @5: 0.2279, @10: 0.2988), NDCG (@2: 0.1306, @5: 0.1653, @10: 0.1882)

Train epoch:47, time: 579.084307(s), rec_loss: 4.6590, tra_kl_loss: 6.2427, time_kl_loss: 5.3388, dis_kl_loss: 5.3331, contra_loss: 8501.4277
Test epoch:47, time: 591.009278(s), Recall (@2: 0.1570, @5: 0.2320, @10: 0.3070), NDCG (@2: 0.1375, @5: 0.1711, @10: 0.1953)

Train epoch:48, time: 591.009278(s), rec_loss: 4.6511, tra_kl_loss: 6.3154, time_kl_loss: 5.2956, dis_kl_loss: 5.2896, contra_loss: 8729.5618
Test epoch:48, time: 602.587065(s), Recall (@2: 0.1503, @5: 0.2270, @10: 0.2939), NDCG (@2: 0.1325, @5: 0.1666, @10: 0.1881)

Train epoch:49, time: 602.587065(s), rec_loss: 4.6451, tra_kl_loss: 6.3083, time_kl_loss: 5.4152, dis_kl_loss: 5.4121, contra_loss: 8484.4496
Test epoch:49, time: 614.211140(s), Recall (@2: 0.1535, @5: 0.2391, @10: 0.3066), NDCG (@2: 0.1353, @5: 0.1735, @10: 0.1953)

Train epoch:50, time: 614.211140(s), rec_loss: 4.6395, tra_kl_loss: 6.2371, time_kl_loss: 5.4421, dis_kl_loss: 5.4387, contra_loss: 8379.1556
Test epoch:50, time: 625.665295(s), Recall (@2: 0.1535, @5: 0.2350, @10: 0.3060), NDCG (@2: 0.1361, @5: 0.1725, @10: 0.1955)
