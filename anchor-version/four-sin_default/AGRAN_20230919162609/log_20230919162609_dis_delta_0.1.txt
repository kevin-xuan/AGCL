dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:0
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.4
dis_delta:0.1
valid_epoch:1
device:cuda:0
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0958, tra_kl_loss: 6.5869, time_kl_loss: 6.1959, dis_kl_loss: 6.0638, contra_loss: 15328.6530
Test epoch:1, time: 15.665061(s), Recall (@2: 0.1100, @5: 0.1639, @10: 0.2195), NDCG (@2: 0.0967, @5: 0.1207, @10: 0.1385)

Train epoch:2, time: 15.665061(s), rec_loss: 7.3405, tra_kl_loss: 7.0557, time_kl_loss: 8.6708, dis_kl_loss: 6.2122, contra_loss: 24281.4587
Test epoch:2, time: 31.325345(s), Recall (@2: 0.1100, @5: 0.1953, @10: 0.2529), NDCG (@2: 0.0974, @5: 0.1352, @10: 0.1540)

Train epoch:3, time: 31.325345(s), rec_loss: 6.7934, tra_kl_loss: 6.8114, time_kl_loss: 6.3191, dis_kl_loss: 5.3786, contra_loss: 25252.1642
Test epoch:3, time: 49.373255(s), Recall (@2: 0.1125, @5: 0.1882, @10: 0.2622), NDCG (@2: 0.0985, @5: 0.1325, @10: 0.1563)

Train epoch:4, time: 49.373255(s), rec_loss: 6.4101, tra_kl_loss: 6.5359, time_kl_loss: 5.2568, dis_kl_loss: 5.0352, contra_loss: 26576.2573
Test epoch:4, time: 67.635509(s), Recall (@2: 0.1242, @5: 0.2053, @10: 0.2792), NDCG (@2: 0.1069, @5: 0.1435, @10: 0.1674)

Train epoch:5, time: 67.635509(s), rec_loss: 6.1430, tra_kl_loss: 6.4243, time_kl_loss: 4.2623, dis_kl_loss: 4.8588, contra_loss: 26697.3920
Test epoch:5, time: 85.753133(s), Recall (@2: 0.1242, @5: 0.2033, @10: 0.2775), NDCG (@2: 0.1071, @5: 0.1428, @10: 0.1668)

Train epoch:6, time: 85.753133(s), rec_loss: 5.9472, tra_kl_loss: 6.3464, time_kl_loss: 4.1124, dis_kl_loss: 4.7115, contra_loss: 25075.5008
Test epoch:6, time: 103.809741(s), Recall (@2: 0.1339, @5: 0.2165, @10: 0.2926), NDCG (@2: 0.1158, @5: 0.1530, @10: 0.1777)

Train epoch:7, time: 103.809741(s), rec_loss: 5.7915, tra_kl_loss: 6.3801, time_kl_loss: 3.7081, dis_kl_loss: 4.6388, contra_loss: 24238.0230
Test epoch:7, time: 121.842448(s), Recall (@2: 0.1350, @5: 0.2221, @10: 0.2973), NDCG (@2: 0.1166, @5: 0.1560, @10: 0.1802)

Train epoch:8, time: 121.842448(s), rec_loss: 5.6583, tra_kl_loss: 6.4423, time_kl_loss: 3.3301, dis_kl_loss: 4.5933, contra_loss: 23511.9032
Test epoch:8, time: 140.041561(s), Recall (@2: 0.1438, @5: 0.2296, @10: 0.3042), NDCG (@2: 0.1231, @5: 0.1614, @10: 0.1855)

Train epoch:9, time: 140.041561(s), rec_loss: 5.5579, tra_kl_loss: 6.3371, time_kl_loss: 2.9954, dis_kl_loss: 4.6059, contra_loss: 22366.0329
Test epoch:9, time: 158.431726(s), Recall (@2: 0.1434, @5: 0.2296, @10: 0.3057), NDCG (@2: 0.1231, @5: 0.1619, @10: 0.1866)

Train epoch:10, time: 158.431726(s), rec_loss: 5.4620, tra_kl_loss: 6.2826, time_kl_loss: 2.8788, dis_kl_loss: 4.5952, contra_loss: 21144.2890
Test epoch:10, time: 176.555001(s), Recall (@2: 0.1449, @5: 0.2350, @10: 0.3072), NDCG (@2: 0.1239, @5: 0.1646, @10: 0.1879)

Train epoch:11, time: 176.555001(s), rec_loss: 5.3864, tra_kl_loss: 6.3527, time_kl_loss: 2.9656, dis_kl_loss: 4.5133, contra_loss: 21042.2027
Test epoch:11, time: 194.933675(s), Recall (@2: 0.1458, @5: 0.2389, @10: 0.3047), NDCG (@2: 0.1251, @5: 0.1667, @10: 0.1880)

Train epoch:12, time: 194.933675(s), rec_loss: 5.3293, tra_kl_loss: 6.2246, time_kl_loss: 2.8945, dis_kl_loss: 4.4732, contra_loss: 19600.9433
Test epoch:12, time: 213.397832(s), Recall (@2: 0.1479, @5: 0.2354, @10: 0.3068), NDCG (@2: 0.1271, @5: 0.1665, @10: 0.1895)

Train epoch:13, time: 213.397832(s), rec_loss: 5.2762, tra_kl_loss: 6.2887, time_kl_loss: 2.7465, dis_kl_loss: 4.4502, contra_loss: 18861.8279
Test epoch:13, time: 231.542751(s), Recall (@2: 0.1518, @5: 0.2445, @10: 0.3187), NDCG (@2: 0.1306, @5: 0.1725, @10: 0.1965)

Train epoch:14, time: 231.542751(s), rec_loss: 5.2308, tra_kl_loss: 6.2461, time_kl_loss: 2.7639, dis_kl_loss: 4.4356, contra_loss: 18600.1049
Test epoch:14, time: 249.716637(s), Recall (@2: 0.1488, @5: 0.2415, @10: 0.3111), NDCG (@2: 0.1285, @5: 0.1699, @10: 0.1924)

Train epoch:15, time: 249.716637(s), rec_loss: 5.1882, tra_kl_loss: 6.2580, time_kl_loss: 2.6804, dis_kl_loss: 4.4583, contra_loss: 17729.4820
Test epoch:15, time: 267.822213(s), Recall (@2: 0.1488, @5: 0.2376, @10: 0.3066), NDCG (@2: 0.1287, @5: 0.1689, @10: 0.1913)

Train epoch:16, time: 267.822213(s), rec_loss: 5.1546, tra_kl_loss: 6.2095, time_kl_loss: 2.7396, dis_kl_loss: 4.4362, contra_loss: 16752.4034
Test epoch:16, time: 285.930204(s), Recall (@2: 0.1477, @5: 0.2363, @10: 0.3098), NDCG (@2: 0.1276, @5: 0.1675, @10: 0.1912)

Train epoch:17, time: 285.930204(s), rec_loss: 5.1206, tra_kl_loss: 6.2487, time_kl_loss: 2.6271, dis_kl_loss: 4.3583, contra_loss: 15880.7033
Test epoch:17, time: 304.138090(s), Recall (@2: 0.1527, @5: 0.2486, @10: 0.3200), NDCG (@2: 0.1317, @5: 0.1750, @10: 0.1981)

Train epoch:18, time: 304.138090(s), rec_loss: 5.0955, tra_kl_loss: 6.3054, time_kl_loss: 2.5954, dis_kl_loss: 4.4445, contra_loss: 15961.7606
Test epoch:18, time: 322.040712(s), Recall (@2: 0.1520, @5: 0.2380, @10: 0.3120), NDCG (@2: 0.1317, @5: 0.1705, @10: 0.1943)

Train epoch:19, time: 322.040712(s), rec_loss: 5.0710, tra_kl_loss: 6.1787, time_kl_loss: 2.6597, dis_kl_loss: 4.3633, contra_loss: 14847.2490
Test epoch:19, time: 340.124392(s), Recall (@2: 0.1572, @5: 0.2499, @10: 0.3228), NDCG (@2: 0.1359, @5: 0.1775, @10: 0.2009)

Train epoch:20, time: 340.124392(s), rec_loss: 5.0525, tra_kl_loss: 6.2590, time_kl_loss: 2.5358, dis_kl_loss: 4.3608, contra_loss: 14897.5446
Test epoch:20, time: 358.191632(s), Recall (@2: 0.1514, @5: 0.2393, @10: 0.3105), NDCG (@2: 0.1310, @5: 0.1705, @10: 0.1935)

Train epoch:21, time: 358.191632(s), rec_loss: 5.0226, tra_kl_loss: 6.2731, time_kl_loss: 2.4699, dis_kl_loss: 4.3691, contra_loss: 14259.1947
Test epoch:21, time: 376.504540(s), Recall (@2: 0.1583, @5: 0.2473, @10: 0.3200), NDCG (@2: 0.1376, @5: 0.1771, @10: 0.2005)

Train epoch:22, time: 376.504540(s), rec_loss: 5.0040, tra_kl_loss: 6.1962, time_kl_loss: 2.5470, dis_kl_loss: 4.3230, contra_loss: 13293.4631
Test epoch:22, time: 394.359873(s), Recall (@2: 0.1632, @5: 0.2531, @10: 0.3301), NDCG (@2: 0.1414, @5: 0.1817, @10: 0.2064)

Train epoch:23, time: 394.359873(s), rec_loss: 4.9969, tra_kl_loss: 6.3069, time_kl_loss: 2.5262, dis_kl_loss: 4.3506, contra_loss: 13673.8726
Test epoch:23, time: 412.380137(s), Recall (@2: 0.1501, @5: 0.2385, @10: 0.3090), NDCG (@2: 0.1291, @5: 0.1687, @10: 0.1915)

Train epoch:24, time: 412.380137(s), rec_loss: 4.9700, tra_kl_loss: 6.2219, time_kl_loss: 2.4848, dis_kl_loss: 4.3553, contra_loss: 12829.6942
Test epoch:24, time: 430.272495(s), Recall (@2: 0.1593, @5: 0.2434, @10: 0.3165), NDCG (@2: 0.1377, @5: 0.1760, @10: 0.1997)

Train epoch:25, time: 430.272495(s), rec_loss: 4.9591, tra_kl_loss: 6.3485, time_kl_loss: 2.4970, dis_kl_loss: 4.3440, contra_loss: 12964.2713
Test epoch:25, time: 448.542221(s), Recall (@2: 0.1580, @5: 0.2445, @10: 0.3169), NDCG (@2: 0.1375, @5: 0.1764, @10: 0.1998)

Train epoch:26, time: 448.542221(s), rec_loss: 4.9441, tra_kl_loss: 6.2085, time_kl_loss: 2.4052, dis_kl_loss: 4.3026, contra_loss: 12303.4111
Test epoch:26, time: 466.188900(s), Recall (@2: 0.1458, @5: 0.2288, @10: 0.3014), NDCG (@2: 0.1271, @5: 0.1645, @10: 0.1879)

Train epoch:27, time: 466.188900(s), rec_loss: 4.9352, tra_kl_loss: 6.2633, time_kl_loss: 2.4817, dis_kl_loss: 4.3372, contra_loss: 11934.1025
Test epoch:27, time: 484.312358(s), Recall (@2: 0.1744, @5: 0.2635, @10: 0.3364), NDCG (@2: 0.1494, @5: 0.1892, @10: 0.2128)

Train epoch:28, time: 484.312358(s), rec_loss: 4.9273, tra_kl_loss: 6.2537, time_kl_loss: 2.4306, dis_kl_loss: 4.3597, contra_loss: 11731.0713
Test epoch:28, time: 501.958965(s), Recall (@2: 0.1522, @5: 0.2378, @10: 0.3122), NDCG (@2: 0.1329, @5: 0.1714, @10: 0.1952)

Train epoch:29, time: 501.958965(s), rec_loss: 4.9059, tra_kl_loss: 6.2532, time_kl_loss: 2.4604, dis_kl_loss: 4.3566, contra_loss: 11548.4798
Test epoch:29, time: 519.411495(s), Recall (@2: 0.1563, @5: 0.2475, @10: 0.3176), NDCG (@2: 0.1365, @5: 0.1776, @10: 0.2001)

Train epoch:30, time: 519.411495(s), rec_loss: 4.8960, tra_kl_loss: 6.2981, time_kl_loss: 2.5822, dis_kl_loss: 4.3224, contra_loss: 11471.1448
Test epoch:30, time: 537.071199(s), Recall (@2: 0.1572, @5: 0.2480, @10: 0.3234), NDCG (@2: 0.1390, @5: 0.1797, @10: 0.2041)

Train epoch:31, time: 537.071199(s), rec_loss: 4.8856, tra_kl_loss: 6.2691, time_kl_loss: 2.4234, dis_kl_loss: 4.3969, contra_loss: 11109.4975
Test epoch:31, time: 554.304286(s), Recall (@2: 0.1511, @5: 0.2363, @10: 0.3154), NDCG (@2: 0.1323, @5: 0.1705, @10: 0.1960)

Train epoch:32, time: 554.304286(s), rec_loss: 4.8734, tra_kl_loss: 6.2870, time_kl_loss: 2.5793, dis_kl_loss: 4.3251, contra_loss: 10839.9812
Test epoch:32, time: 571.862719(s), Recall (@2: 0.1542, @5: 0.2447, @10: 0.3172), NDCG (@2: 0.1351, @5: 0.1760, @10: 0.1994)

Train epoch:33, time: 571.862719(s), rec_loss: 4.8628, tra_kl_loss: 6.3004, time_kl_loss: 2.3049, dis_kl_loss: 4.2978, contra_loss: 10468.2835
Test epoch:33, time: 589.322769(s), Recall (@2: 0.1501, @5: 0.2331, @10: 0.3083), NDCG (@2: 0.1318, @5: 0.1693, @10: 0.1936)

Train epoch:34, time: 589.322769(s), rec_loss: 4.8595, tra_kl_loss: 6.1810, time_kl_loss: 2.5130, dis_kl_loss: 4.3188, contra_loss: 10104.2714
Test epoch:34, time: 606.301003(s), Recall (@2: 0.1514, @5: 0.2348, @10: 0.3047), NDCG (@2: 0.1304, @5: 0.1678, @10: 0.1904)

Train epoch:35, time: 606.301003(s), rec_loss: 4.8415, tra_kl_loss: 6.2677, time_kl_loss: 2.4505, dis_kl_loss: 4.3047, contra_loss: 9788.4314
Test epoch:35, time: 623.315705(s), Recall (@2: 0.1593, @5: 0.2456, @10: 0.3219), NDCG (@2: 0.1396, @5: 0.1782, @10: 0.2026)

Train epoch:36, time: 623.315705(s), rec_loss: 4.8378, tra_kl_loss: 6.2528, time_kl_loss: 2.3104, dis_kl_loss: 4.3724, contra_loss: 9811.9200
Test epoch:36, time: 640.799635(s), Recall (@2: 0.1567, @5: 0.2391, @10: 0.3129), NDCG (@2: 0.1352, @5: 0.1718, @10: 0.1954)

Train epoch:37, time: 640.799635(s), rec_loss: 4.8235, tra_kl_loss: 6.1261, time_kl_loss: 2.5046, dis_kl_loss: 4.3314, contra_loss: 8952.9084
Test epoch:37, time: 658.312512(s), Recall (@2: 0.1511, @5: 0.2331, @10: 0.3083), NDCG (@2: 0.1307, @5: 0.1672, @10: 0.1912)

Train epoch:38, time: 658.312512(s), rec_loss: 4.8183, tra_kl_loss: 6.3179, time_kl_loss: 2.3877, dis_kl_loss: 4.2978, contra_loss: 9200.0520
Test epoch:38, time: 676.145248(s), Recall (@2: 0.1539, @5: 0.2337, @10: 0.3055), NDCG (@2: 0.1360, @5: 0.1713, @10: 0.1946)

Train epoch:39, time: 676.145248(s), rec_loss: 4.8016, tra_kl_loss: 6.2583, time_kl_loss: 2.4975, dis_kl_loss: 4.3473, contra_loss: 8685.6329
Test epoch:39, time: 694.379111(s), Recall (@2: 0.1544, @5: 0.2385, @10: 0.3163), NDCG (@2: 0.1351, @5: 0.1729, @10: 0.1979)

Train epoch:40, time: 694.379111(s), rec_loss: 4.7960, tra_kl_loss: 6.2801, time_kl_loss: 2.4589, dis_kl_loss: 4.3761, contra_loss: 8428.8558
Test epoch:40, time: 712.130270(s), Recall (@2: 0.1421, @5: 0.2212, @10: 0.2984), NDCG (@2: 0.1254, @5: 0.1608, @10: 0.1857)

Train epoch:41, time: 712.130270(s), rec_loss: 4.7871, tra_kl_loss: 6.2696, time_kl_loss: 2.3279, dis_kl_loss: 4.3303, contra_loss: 8350.9112
Test epoch:41, time: 729.568318(s), Recall (@2: 0.1516, @5: 0.2395, @10: 0.3118), NDCG (@2: 0.1326, @5: 0.1718, @10: 0.1950)

Train epoch:42, time: 729.568318(s), rec_loss: 4.7865, tra_kl_loss: 6.3319, time_kl_loss: 2.3724, dis_kl_loss: 4.3134, contra_loss: 8262.7682
Test epoch:42, time: 746.880133(s), Recall (@2: 0.1563, @5: 0.2417, @10: 0.3150), NDCG (@2: 0.1366, @5: 0.1749, @10: 0.1984)

Train epoch:43, time: 746.880133(s), rec_loss: 4.7715, tra_kl_loss: 6.3012, time_kl_loss: 2.4545, dis_kl_loss: 4.3121, contra_loss: 7971.4285
Test epoch:43, time: 764.795680(s), Recall (@2: 0.1535, @5: 0.2329, @10: 0.3049), NDCG (@2: 0.1343, @5: 0.1698, @10: 0.1931)

Train epoch:44, time: 764.795680(s), rec_loss: 4.7653, tra_kl_loss: 6.3258, time_kl_loss: 2.4023, dis_kl_loss: 4.3198, contra_loss: 7882.3623
Test epoch:44, time: 782.305146(s), Recall (@2: 0.1509, @5: 0.2359, @10: 0.3064), NDCG (@2: 0.1317, @5: 0.1699, @10: 0.1926)

Train epoch:45, time: 782.305146(s), rec_loss: 4.7621, tra_kl_loss: 6.2690, time_kl_loss: 2.4001, dis_kl_loss: 4.3401, contra_loss: 7682.7851
Test epoch:45, time: 799.761746(s), Recall (@2: 0.1531, @5: 0.2354, @10: 0.3070), NDCG (@2: 0.1350, @5: 0.1723, @10: 0.1955)

Train epoch:46, time: 799.761746(s), rec_loss: 4.7499, tra_kl_loss: 6.1386, time_kl_loss: 2.3635, dis_kl_loss: 4.3304, contra_loss: 7479.9902
Test epoch:46, time: 817.127009(s), Recall (@2: 0.1535, @5: 0.2391, @10: 0.3107), NDCG (@2: 0.1344, @5: 0.1727, @10: 0.1958)

Train epoch:47, time: 817.127009(s), rec_loss: 4.7449, tra_kl_loss: 6.2727, time_kl_loss: 2.4492, dis_kl_loss: 4.3283, contra_loss: 7343.2834
Test epoch:47, time: 834.478322(s), Recall (@2: 0.1570, @5: 0.2385, @10: 0.3118), NDCG (@2: 0.1376, @5: 0.1744, @10: 0.1979)

Train epoch:48, time: 834.478322(s), rec_loss: 4.7375, tra_kl_loss: 6.3657, time_kl_loss: 2.3841, dis_kl_loss: 4.3783, contra_loss: 7381.4283
Test epoch:48, time: 852.077814(s), Recall (@2: 0.1555, @5: 0.2331, @10: 0.3098), NDCG (@2: 0.1362, @5: 0.1711, @10: 0.1959)

Train epoch:49, time: 852.077814(s), rec_loss: 4.7306, tra_kl_loss: 6.2604, time_kl_loss: 2.3879, dis_kl_loss: 4.2987, contra_loss: 7111.4155
Test epoch:49, time: 869.552068(s), Recall (@2: 0.1559, @5: 0.2402, @10: 0.3163), NDCG (@2: 0.1368, @5: 0.1745, @10: 0.1991)

Train epoch:50, time: 869.552068(s), rec_loss: 4.7224, tra_kl_loss: 6.2587, time_kl_loss: 2.5633, dis_kl_loss: 4.3262, contra_loss: 7192.1824
Test epoch:50, time: 886.289391(s), Recall (@2: 0.1531, @5: 0.2359, @10: 0.3146), NDCG (@2: 0.1352, @5: 0.1725, @10: 0.1979)
