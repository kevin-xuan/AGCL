dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:0
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.4
dis_delta:0.0
valid_epoch:1
device:cuda:0
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.2485, tra_kl_loss: 6.5879, time_kl_loss: 6.1956, dis_kl_loss: 6.0506, contra_loss: 15438.9276
Test epoch:1, time: 15.087259(s), Recall (@2: 0.1007, @5: 0.1507, @10: 0.1975), NDCG (@2: 0.0888, @5: 0.1113, @10: 0.1264)

Train epoch:2, time: 15.087259(s), rec_loss: 7.4463, tra_kl_loss: 7.0539, time_kl_loss: 8.5535, dis_kl_loss: 5.8543, contra_loss: 25087.4795
Test epoch:2, time: 29.490512(s), Recall (@2: 0.1054, @5: 0.1852, @10: 0.2419), NDCG (@2: 0.0913, @5: 0.1268, @10: 0.1451)

Train epoch:3, time: 29.490512(s), rec_loss: 6.8644, tra_kl_loss: 6.7931, time_kl_loss: 5.9901, dis_kl_loss: 5.2557, contra_loss: 26123.3711
Test epoch:3, time: 44.204987(s), Recall (@2: 0.1121, @5: 0.1770, @10: 0.2557), NDCG (@2: 0.0976, @5: 0.1268, @10: 0.1520)

Train epoch:4, time: 44.204987(s), rec_loss: 6.4564, tra_kl_loss: 6.4964, time_kl_loss: 5.0171, dis_kl_loss: 5.0847, contra_loss: 27203.2927
Test epoch:4, time: 58.794464(s), Recall (@2: 0.1238, @5: 0.2016, @10: 0.2721), NDCG (@2: 0.1071, @5: 0.1418, @10: 0.1645)

Train epoch:5, time: 58.794464(s), rec_loss: 6.1633, tra_kl_loss: 6.4366, time_kl_loss: 4.1917, dis_kl_loss: 4.9605, contra_loss: 26792.7807
Test epoch:5, time: 73.632876(s), Recall (@2: 0.1197, @5: 0.1997, @10: 0.2712), NDCG (@2: 0.1037, @5: 0.1399, @10: 0.1631)

Train epoch:6, time: 73.632876(s), rec_loss: 5.9460, tra_kl_loss: 6.3605, time_kl_loss: 3.9610, dis_kl_loss: 4.9003, contra_loss: 25621.5214
Test epoch:6, time: 88.535009(s), Recall (@2: 0.1313, @5: 0.2143, @10: 0.2872), NDCG (@2: 0.1141, @5: 0.1515, @10: 0.1750)

Train epoch:7, time: 88.535009(s), rec_loss: 5.7714, tra_kl_loss: 6.3547, time_kl_loss: 3.6883, dis_kl_loss: 4.8782, contra_loss: 24146.6025
Test epoch:7, time: 103.411774(s), Recall (@2: 0.1358, @5: 0.2171, @10: 0.2932), NDCG (@2: 0.1176, @5: 0.1540, @10: 0.1786)

Train epoch:8, time: 103.411774(s), rec_loss: 5.6249, tra_kl_loss: 6.4311, time_kl_loss: 3.3406, dis_kl_loss: 4.8737, contra_loss: 23284.6709
Test epoch:8, time: 118.106638(s), Recall (@2: 0.1382, @5: 0.2234, @10: 0.2971), NDCG (@2: 0.1189, @5: 0.1569, @10: 0.1806)

Train epoch:9, time: 118.106638(s), rec_loss: 5.5110, tra_kl_loss: 6.3105, time_kl_loss: 3.0994, dis_kl_loss: 4.8418, contra_loss: 22126.0212
Test epoch:9, time: 132.992185(s), Recall (@2: 0.1425, @5: 0.2268, @10: 0.2984), NDCG (@2: 0.1233, @5: 0.1613, @10: 0.1844)

Train epoch:10, time: 132.992185(s), rec_loss: 5.4050, tra_kl_loss: 6.2955, time_kl_loss: 2.8958, dis_kl_loss: 4.8413, contra_loss: 20667.8252
Test epoch:10, time: 148.021298(s), Recall (@2: 0.1462, @5: 0.2326, @10: 0.3066), NDCG (@2: 0.1251, @5: 0.1641, @10: 0.1880)

Train epoch:11, time: 148.021298(s), rec_loss: 5.3220, tra_kl_loss: 6.3780, time_kl_loss: 2.9598, dis_kl_loss: 4.8218, contra_loss: 20508.7279
Test epoch:11, time: 162.867586(s), Recall (@2: 0.1488, @5: 0.2378, @10: 0.3038), NDCG (@2: 0.1275, @5: 0.1673, @10: 0.1887)

Train epoch:12, time: 162.867586(s), rec_loss: 5.2594, tra_kl_loss: 6.2690, time_kl_loss: 2.8811, dis_kl_loss: 4.8115, contra_loss: 19071.6737
Test epoch:12, time: 177.528398(s), Recall (@2: 0.1511, @5: 0.2346, @10: 0.3053), NDCG (@2: 0.1299, @5: 0.1674, @10: 0.1902)

Train epoch:13, time: 177.528398(s), rec_loss: 5.2040, tra_kl_loss: 6.2795, time_kl_loss: 2.8219, dis_kl_loss: 4.8027, contra_loss: 18205.6794
Test epoch:13, time: 192.288420(s), Recall (@2: 0.1501, @5: 0.2411, @10: 0.3180), NDCG (@2: 0.1295, @5: 0.1706, @10: 0.1954)

Train epoch:14, time: 192.288420(s), rec_loss: 5.1563, tra_kl_loss: 6.2664, time_kl_loss: 2.7446, dis_kl_loss: 4.7946, contra_loss: 18066.8893
Test epoch:14, time: 207.174560(s), Recall (@2: 0.1520, @5: 0.2391, @10: 0.3062), NDCG (@2: 0.1305, @5: 0.1695, @10: 0.1910)

Train epoch:15, time: 207.174560(s), rec_loss: 5.1104, tra_kl_loss: 6.2508, time_kl_loss: 2.6982, dis_kl_loss: 4.7676, contra_loss: 17280.7647
Test epoch:15, time: 221.839629(s), Recall (@2: 0.1458, @5: 0.2331, @10: 0.3006), NDCG (@2: 0.1256, @5: 0.1649, @10: 0.1867)

Train epoch:16, time: 221.839629(s), rec_loss: 5.0763, tra_kl_loss: 6.2036, time_kl_loss: 2.7213, dis_kl_loss: 4.8066, contra_loss: 16324.4614
Test epoch:16, time: 236.447997(s), Recall (@2: 0.1529, @5: 0.2378, @10: 0.3105), NDCG (@2: 0.1318, @5: 0.1703, @10: 0.1936)

Train epoch:17, time: 236.447997(s), rec_loss: 5.0419, tra_kl_loss: 6.2392, time_kl_loss: 2.7788, dis_kl_loss: 4.7644, contra_loss: 15441.6911
Test epoch:17, time: 251.326712(s), Recall (@2: 0.1565, @5: 0.2436, @10: 0.3141), NDCG (@2: 0.1352, @5: 0.1743, @10: 0.1970)

Train epoch:18, time: 251.326712(s), rec_loss: 5.0164, tra_kl_loss: 6.2968, time_kl_loss: 2.6426, dis_kl_loss: 4.7899, contra_loss: 15472.4883
Test epoch:18, time: 266.191577(s), Recall (@2: 0.1533, @5: 0.2348, @10: 0.3066), NDCG (@2: 0.1330, @5: 0.1698, @10: 0.1929)

Train epoch:19, time: 266.191577(s), rec_loss: 4.9902, tra_kl_loss: 6.1315, time_kl_loss: 2.6929, dis_kl_loss: 4.7695, contra_loss: 14324.0093
Test epoch:19, time: 281.064380(s), Recall (@2: 0.1546, @5: 0.2449, @10: 0.3228), NDCG (@2: 0.1344, @5: 0.1751, @10: 0.2001)

Train epoch:20, time: 281.064380(s), rec_loss: 4.9727, tra_kl_loss: 6.2346, time_kl_loss: 2.5207, dis_kl_loss: 4.7830, contra_loss: 14291.0480
Test epoch:20, time: 295.844114(s), Recall (@2: 0.1522, @5: 0.2376, @10: 0.3088), NDCG (@2: 0.1324, @5: 0.1706, @10: 0.1935)

Train epoch:21, time: 295.844114(s), rec_loss: 4.9417, tra_kl_loss: 6.2717, time_kl_loss: 2.5227, dis_kl_loss: 4.7637, contra_loss: 13960.8743
Test epoch:21, time: 310.683360(s), Recall (@2: 0.1585, @5: 0.2484, @10: 0.3187), NDCG (@2: 0.1384, @5: 0.1785, @10: 0.2012)

Train epoch:22, time: 310.683360(s), rec_loss: 4.9257, tra_kl_loss: 6.1900, time_kl_loss: 2.6558, dis_kl_loss: 4.7426, contra_loss: 12969.1514
Test epoch:22, time: 325.718145(s), Recall (@2: 0.1632, @5: 0.2503, @10: 0.3271), NDCG (@2: 0.1425, @5: 0.1815, @10: 0.2064)

Train epoch:23, time: 325.718145(s), rec_loss: 4.9156, tra_kl_loss: 6.3061, time_kl_loss: 2.6537, dis_kl_loss: 4.7579, contra_loss: 13443.0911
Test epoch:23, time: 340.349524(s), Recall (@2: 0.1483, @5: 0.2361, @10: 0.3092), NDCG (@2: 0.1297, @5: 0.1695, @10: 0.1931)

Train epoch:24, time: 340.349524(s), rec_loss: 4.8884, tra_kl_loss: 6.2186, time_kl_loss: 2.4761, dis_kl_loss: 4.7574, contra_loss: 12754.9716
Test epoch:24, time: 354.847067(s), Recall (@2: 0.1539, @5: 0.2464, @10: 0.3161), NDCG (@2: 0.1333, @5: 0.1750, @10: 0.1974)

Train epoch:25, time: 354.847067(s), rec_loss: 4.8778, tra_kl_loss: 6.3663, time_kl_loss: 2.4882, dis_kl_loss: 4.7619, contra_loss: 12844.7540
Test epoch:25, time: 369.502793(s), Recall (@2: 0.1608, @5: 0.2473, @10: 0.3202), NDCG (@2: 0.1402, @5: 0.1791, @10: 0.2024)

Train epoch:26, time: 369.502793(s), rec_loss: 4.8649, tra_kl_loss: 6.2311, time_kl_loss: 2.5651, dis_kl_loss: 4.7506, contra_loss: 12244.6352
Test epoch:26, time: 384.348834(s), Recall (@2: 0.1412, @5: 0.2255, @10: 0.2980), NDCG (@2: 0.1241, @5: 0.1621, @10: 0.1855)

Train epoch:27, time: 384.348834(s), rec_loss: 4.8541, tra_kl_loss: 6.2552, time_kl_loss: 2.4482, dis_kl_loss: 4.7204, contra_loss: 11775.9945
Test epoch:27, time: 399.168114(s), Recall (@2: 0.1736, @5: 0.2609, @10: 0.3333), NDCG (@2: 0.1492, @5: 0.1884, @10: 0.2119)

Train epoch:28, time: 399.168114(s), rec_loss: 4.8484, tra_kl_loss: 6.2695, time_kl_loss: 2.4573, dis_kl_loss: 4.7824, contra_loss: 11477.8456
Test epoch:28, time: 414.097673(s), Recall (@2: 0.1503, @5: 0.2361, @10: 0.3040), NDCG (@2: 0.1321, @5: 0.1705, @10: 0.1924)

Train epoch:29, time: 414.097673(s), rec_loss: 4.8276, tra_kl_loss: 6.2168, time_kl_loss: 2.5125, dis_kl_loss: 4.7375, contra_loss: 11140.6405
Test epoch:29, time: 428.922143(s), Recall (@2: 0.1578, @5: 0.2464, @10: 0.3150), NDCG (@2: 0.1369, @5: 0.1768, @10: 0.1989)

Train epoch:30, time: 428.922143(s), rec_loss: 4.8170, tra_kl_loss: 6.2834, time_kl_loss: 2.7360, dis_kl_loss: 4.7492, contra_loss: 11166.4665
Test epoch:30, time: 443.883669(s), Recall (@2: 0.1563, @5: 0.2441, @10: 0.3195), NDCG (@2: 0.1371, @5: 0.1766, @10: 0.2010)

Train epoch:31, time: 443.883669(s), rec_loss: 4.8086, tra_kl_loss: 6.2709, time_kl_loss: 2.4688, dis_kl_loss: 4.7538, contra_loss: 10964.6313
Test epoch:31, time: 458.821235(s), Recall (@2: 0.1587, @5: 0.2415, @10: 0.3107), NDCG (@2: 0.1393, @5: 0.1763, @10: 0.1987)

Train epoch:32, time: 458.821235(s), rec_loss: 4.7985, tra_kl_loss: 6.2760, time_kl_loss: 2.5097, dis_kl_loss: 4.7476, contra_loss: 10634.2785
Test epoch:32, time: 473.717954(s), Recall (@2: 0.1583, @5: 0.2449, @10: 0.3139), NDCG (@2: 0.1374, @5: 0.1762, @10: 0.1984)

Train epoch:33, time: 473.717954(s), rec_loss: 4.7899, tra_kl_loss: 6.2902, time_kl_loss: 2.4218, dis_kl_loss: 4.7459, contra_loss: 10326.9669
Test epoch:33, time: 488.538468(s), Recall (@2: 0.1531, @5: 0.2337, @10: 0.3029), NDCG (@2: 0.1341, @5: 0.1702, @10: 0.1924)

Train epoch:34, time: 488.538468(s), rec_loss: 4.7833, tra_kl_loss: 6.1845, time_kl_loss: 2.6841, dis_kl_loss: 4.7491, contra_loss: 9903.4431
Test epoch:34, time: 503.412335(s), Recall (@2: 0.1520, @5: 0.2350, @10: 0.3096), NDCG (@2: 0.1321, @5: 0.1692, @10: 0.1933)

Train epoch:35, time: 503.412335(s), rec_loss: 4.7712, tra_kl_loss: 6.2169, time_kl_loss: 2.4931, dis_kl_loss: 4.7439, contra_loss: 9520.8576
Test epoch:35, time: 518.533018(s), Recall (@2: 0.1578, @5: 0.2482, @10: 0.3202), NDCG (@2: 0.1365, @5: 0.1771, @10: 0.2002)

Train epoch:36, time: 518.533018(s), rec_loss: 4.7633, tra_kl_loss: 6.2287, time_kl_loss: 2.3788, dis_kl_loss: 4.7372, contra_loss: 9487.9394
Test epoch:36, time: 533.288025(s), Recall (@2: 0.1550, @5: 0.2335, @10: 0.3113), NDCG (@2: 0.1356, @5: 0.1709, @10: 0.1959)

Train epoch:37, time: 533.288025(s), rec_loss: 4.7551, tra_kl_loss: 6.1365, time_kl_loss: 2.6605, dis_kl_loss: 4.7682, contra_loss: 8779.3857
Test epoch:37, time: 548.198206(s), Recall (@2: 0.1483, @5: 0.2346, @10: 0.3066), NDCG (@2: 0.1292, @5: 0.1684, @10: 0.1916)

Train epoch:38, time: 548.198206(s), rec_loss: 4.7516, tra_kl_loss: 6.3131, time_kl_loss: 2.3943, dis_kl_loss: 4.7694, contra_loss: 9074.9193
Test epoch:38, time: 562.727807(s), Recall (@2: 0.1550, @5: 0.2303, @10: 0.3111), NDCG (@2: 0.1356, @5: 0.1696, @10: 0.1958)

Train epoch:39, time: 562.727807(s), rec_loss: 4.7373, tra_kl_loss: 6.2456, time_kl_loss: 2.5410, dis_kl_loss: 4.7980, contra_loss: 8606.6094
Test epoch:39, time: 577.345390(s), Recall (@2: 0.1535, @5: 0.2447, @10: 0.3154), NDCG (@2: 0.1331, @5: 0.1737, @10: 0.1965)

Train epoch:40, time: 577.345390(s), rec_loss: 4.7322, tra_kl_loss: 6.2544, time_kl_loss: 2.4656, dis_kl_loss: 4.7475, contra_loss: 8476.9031
Test epoch:40, time: 591.753901(s), Recall (@2: 0.1458, @5: 0.2255, @10: 0.2986), NDCG (@2: 0.1274, @5: 0.1628, @10: 0.1864)

Train epoch:41, time: 591.753901(s), rec_loss: 4.7252, tra_kl_loss: 6.3062, time_kl_loss: 2.4407, dis_kl_loss: 4.7481, contra_loss: 8506.6203
Test epoch:41, time: 606.520372(s), Recall (@2: 0.1518, @5: 0.2413, @10: 0.3126), NDCG (@2: 0.1330, @5: 0.1730, @10: 0.1960)

Train epoch:42, time: 606.520372(s), rec_loss: 4.7288, tra_kl_loss: 6.3000, time_kl_loss: 2.5538, dis_kl_loss: 4.7645, contra_loss: 8239.8642
Test epoch:42, time: 621.588981(s), Recall (@2: 0.1567, @5: 0.2411, @10: 0.3163), NDCG (@2: 0.1373, @5: 0.1751, @10: 0.1992)

Train epoch:43, time: 621.588981(s), rec_loss: 4.7141, tra_kl_loss: 6.2152, time_kl_loss: 2.6071, dis_kl_loss: 4.7225, contra_loss: 7857.0280
Test epoch:43, time: 636.067383(s), Recall (@2: 0.1496, @5: 0.2342, @10: 0.3088), NDCG (@2: 0.1317, @5: 0.1695, @10: 0.1935)

Train epoch:44, time: 636.067383(s), rec_loss: 4.7083, tra_kl_loss: 6.2897, time_kl_loss: 2.5878, dis_kl_loss: 4.7363, contra_loss: 7801.1886
Test epoch:44, time: 650.661206(s), Recall (@2: 0.1498, @5: 0.2335, @10: 0.3081), NDCG (@2: 0.1311, @5: 0.1688, @10: 0.1928)

Train epoch:45, time: 650.661206(s), rec_loss: 4.7076, tra_kl_loss: 6.2946, time_kl_loss: 2.5474, dis_kl_loss: 4.7452, contra_loss: 7731.5869
Test epoch:45, time: 665.430879(s), Recall (@2: 0.1559, @5: 0.2398, @10: 0.3137), NDCG (@2: 0.1367, @5: 0.1748, @10: 0.1986)

Train epoch:46, time: 665.430879(s), rec_loss: 4.6973, tra_kl_loss: 6.1442, time_kl_loss: 2.4886, dis_kl_loss: 4.7848, contra_loss: 7430.0951
Test epoch:46, time: 680.238852(s), Recall (@2: 0.1514, @5: 0.2363, @10: 0.3092), NDCG (@2: 0.1326, @5: 0.1709, @10: 0.1946)

Train epoch:47, time: 680.238852(s), rec_loss: 4.6918, tra_kl_loss: 6.2310, time_kl_loss: 2.6089, dis_kl_loss: 4.7799, contra_loss: 7383.0823
Test epoch:47, time: 694.869514(s), Recall (@2: 0.1600, @5: 0.2445, @10: 0.3169), NDCG (@2: 0.1401, @5: 0.1782, @10: 0.2016)

Train epoch:48, time: 694.869514(s), rec_loss: 4.6868, tra_kl_loss: 6.3192, time_kl_loss: 2.4895, dis_kl_loss: 4.7463, contra_loss: 7256.7370
Test epoch:48, time: 709.365303(s), Recall (@2: 0.1567, @5: 0.2398, @10: 0.3122), NDCG (@2: 0.1365, @5: 0.1736, @10: 0.1971)

Train epoch:49, time: 709.365303(s), rec_loss: 4.6831, tra_kl_loss: 6.1906, time_kl_loss: 2.5376, dis_kl_loss: 4.7208, contra_loss: 6993.7111
Test epoch:49, time: 724.351099(s), Recall (@2: 0.1600, @5: 0.2421, @10: 0.3189), NDCG (@2: 0.1395, @5: 0.1765, @10: 0.2012)

Train epoch:50, time: 724.351099(s), rec_loss: 4.6755, tra_kl_loss: 6.2010, time_kl_loss: 2.5348, dis_kl_loss: 4.7664, contra_loss: 7077.3860
Test epoch:50, time: 739.051269(s), Recall (@2: 0.1546, @5: 0.2456, @10: 0.3174), NDCG (@2: 0.1345, @5: 0.1754, @10: 0.1986)
