dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:1
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.2
dis_delta:0.0
valid_epoch:1
device:cuda:1
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0956, tra_kl_loss: 6.5954, time_kl_loss: 6.1031, dis_kl_loss: 6.0527, contra_loss: 15439.8758
Test epoch:1, time: 13.138141(s), Recall (@2: 0.1100, @5: 0.1634, @10: 0.2206), NDCG (@2: 0.0967, @5: 0.1204, @10: 0.1387)

Train epoch:2, time: 13.138141(s), rec_loss: 7.3500, tra_kl_loss: 7.1257, time_kl_loss: 6.4540, dis_kl_loss: 5.8318, contra_loss: 26357.7234
Test epoch:2, time: 25.576239(s), Recall (@2: 0.1121, @5: 0.1964, @10: 0.2540), NDCG (@2: 0.0991, @5: 0.1365, @10: 0.1553)

Train epoch:3, time: 25.576239(s), rec_loss: 6.8373, tra_kl_loss: 6.8024, time_kl_loss: 4.8973, dis_kl_loss: 5.1908, contra_loss: 27433.1810
Test epoch:3, time: 38.902197(s), Recall (@2: 0.1117, @5: 0.1859, @10: 0.2633), NDCG (@2: 0.0974, @5: 0.1306, @10: 0.1554)

Train epoch:4, time: 38.902197(s), rec_loss: 6.4670, tra_kl_loss: 6.4822, time_kl_loss: 4.4932, dis_kl_loss: 4.9950, contra_loss: 25956.9811
Test epoch:4, time: 52.168098(s), Recall (@2: 0.1255, @5: 0.2053, @10: 0.2807), NDCG (@2: 0.1079, @5: 0.1436, @10: 0.1680)

Train epoch:5, time: 52.168098(s), rec_loss: 6.1902, tra_kl_loss: 6.4583, time_kl_loss: 4.0056, dis_kl_loss: 4.9507, contra_loss: 24908.7899
Test epoch:5, time: 65.427882(s), Recall (@2: 0.1227, @5: 0.2033, @10: 0.2743), NDCG (@2: 0.1061, @5: 0.1423, @10: 0.1653)

Train epoch:6, time: 65.427882(s), rec_loss: 5.9784, tra_kl_loss: 6.3284, time_kl_loss: 3.9103, dis_kl_loss: 4.8501, contra_loss: 23130.6683
Test epoch:6, time: 78.139708(s), Recall (@2: 0.1324, @5: 0.2158, @10: 0.2978), NDCG (@2: 0.1134, @5: 0.1510, @10: 0.1775)

Train epoch:7, time: 78.139708(s), rec_loss: 5.7983, tra_kl_loss: 6.3420, time_kl_loss: 3.7706, dis_kl_loss: 4.8406, contra_loss: 21743.5351
Test epoch:7, time: 91.063884(s), Recall (@2: 0.1348, @5: 0.2178, @10: 0.2984), NDCG (@2: 0.1161, @5: 0.1534, @10: 0.1793)

Train epoch:8, time: 91.063884(s), rec_loss: 5.6579, tra_kl_loss: 6.4143, time_kl_loss: 3.6137, dis_kl_loss: 4.8233, contra_loss: 20288.7053
Test epoch:8, time: 103.930463(s), Recall (@2: 0.1414, @5: 0.2298, @10: 0.3072), NDCG (@2: 0.1211, @5: 0.1609, @10: 0.1860)

Train epoch:9, time: 103.930463(s), rec_loss: 5.5470, tra_kl_loss: 6.3588, time_kl_loss: 3.4694, dis_kl_loss: 4.8301, contra_loss: 19367.8370
Test epoch:9, time: 116.936514(s), Recall (@2: 0.1421, @5: 0.2305, @10: 0.3006), NDCG (@2: 0.1217, @5: 0.1614, @10: 0.1840)

Train epoch:10, time: 116.936514(s), rec_loss: 5.4470, tra_kl_loss: 6.3102, time_kl_loss: 3.4254, dis_kl_loss: 4.8821, contra_loss: 17751.9710
Test epoch:10, time: 130.332760(s), Recall (@2: 0.1468, @5: 0.2292, @10: 0.2995), NDCG (@2: 0.1252, @5: 0.1621, @10: 0.1849)

Train epoch:11, time: 130.332760(s), rec_loss: 5.3735, tra_kl_loss: 6.3587, time_kl_loss: 3.4317, dis_kl_loss: 4.7996, contra_loss: 17229.3057
Test epoch:11, time: 143.614661(s), Recall (@2: 0.1447, @5: 0.2342, @10: 0.3003), NDCG (@2: 0.1246, @5: 0.1643, @10: 0.1857)

Train epoch:12, time: 143.614661(s), rec_loss: 5.3131, tra_kl_loss: 6.2766, time_kl_loss: 3.3966, dis_kl_loss: 4.8384, contra_loss: 16216.2684
Test epoch:12, time: 156.930246(s), Recall (@2: 0.1501, @5: 0.2326, @10: 0.3070), NDCG (@2: 0.1283, @5: 0.1652, @10: 0.1892)

Train epoch:13, time: 156.930246(s), rec_loss: 5.2605, tra_kl_loss: 6.2697, time_kl_loss: 3.2975, dis_kl_loss: 4.8220, contra_loss: 15663.4783
Test epoch:13, time: 170.403136(s), Recall (@2: 0.1527, @5: 0.2421, @10: 0.3180), NDCG (@2: 0.1305, @5: 0.1707, @10: 0.1951)

Train epoch:14, time: 170.403136(s), rec_loss: 5.2144, tra_kl_loss: 6.2625, time_kl_loss: 3.2788, dis_kl_loss: 4.8293, contra_loss: 15263.1031
Test epoch:14, time: 183.634284(s), Recall (@2: 0.1473, @5: 0.2326, @10: 0.3055), NDCG (@2: 0.1271, @5: 0.1656, @10: 0.1894)

Train epoch:15, time: 183.634284(s), rec_loss: 5.1746, tra_kl_loss: 6.2816, time_kl_loss: 3.2391, dis_kl_loss: 4.8143, contra_loss: 14452.2801
Test epoch:15, time: 196.957032(s), Recall (@2: 0.1460, @5: 0.2350, @10: 0.3070), NDCG (@2: 0.1262, @5: 0.1664, @10: 0.1897)

Train epoch:16, time: 196.957032(s), rec_loss: 5.1420, tra_kl_loss: 6.2860, time_kl_loss: 3.2464, dis_kl_loss: 4.8487, contra_loss: 14002.2280
Test epoch:16, time: 209.896281(s), Recall (@2: 0.1503, @5: 0.2402, @10: 0.3094), NDCG (@2: 0.1298, @5: 0.1704, @10: 0.1927)

Train epoch:17, time: 209.896281(s), rec_loss: 5.1052, tra_kl_loss: 6.2283, time_kl_loss: 3.2082, dis_kl_loss: 4.8184, contra_loss: 13003.5402
Test epoch:17, time: 223.060431(s), Recall (@2: 0.1559, @5: 0.2434, @10: 0.3167), NDCG (@2: 0.1350, @5: 0.1746, @10: 0.1982)

Train epoch:18, time: 223.060431(s), rec_loss: 5.0827, tra_kl_loss: 6.3682, time_kl_loss: 3.3397, dis_kl_loss: 4.8436, contra_loss: 13100.7597
Test epoch:18, time: 236.397524(s), Recall (@2: 0.1509, @5: 0.2387, @10: 0.3096), NDCG (@2: 0.1317, @5: 0.1712, @10: 0.1940)

Train epoch:19, time: 236.397524(s), rec_loss: 5.0558, tra_kl_loss: 6.1875, time_kl_loss: 3.1582, dis_kl_loss: 4.8276, contra_loss: 12205.7226
Test epoch:19, time: 249.630211(s), Recall (@2: 0.1522, @5: 0.2426, @10: 0.3172), NDCG (@2: 0.1327, @5: 0.1734, @10: 0.1975)

Train epoch:20, time: 249.630211(s), rec_loss: 5.0389, tra_kl_loss: 6.2830, time_kl_loss: 3.1761, dis_kl_loss: 4.8332, contra_loss: 12079.3797
Test epoch:20, time: 262.638338(s), Recall (@2: 0.1481, @5: 0.2374, @10: 0.3094), NDCG (@2: 0.1296, @5: 0.1694, @10: 0.1927)

Train epoch:21, time: 262.638338(s), rec_loss: 5.0075, tra_kl_loss: 6.2906, time_kl_loss: 3.1954, dis_kl_loss: 4.8293, contra_loss: 11677.6536
Test epoch:21, time: 276.584774(s), Recall (@2: 0.1561, @5: 0.2473, @10: 0.3180), NDCG (@2: 0.1368, @5: 0.1775, @10: 0.2004)

Train epoch:22, time: 276.584774(s), rec_loss: 4.9898, tra_kl_loss: 6.2402, time_kl_loss: 3.1713, dis_kl_loss: 4.8013, contra_loss: 10936.9929
Test epoch:22, time: 289.235496(s), Recall (@2: 0.1585, @5: 0.2484, @10: 0.3223), NDCG (@2: 0.1372, @5: 0.1777, @10: 0.2018)

Train epoch:23, time: 289.235496(s), rec_loss: 4.9804, tra_kl_loss: 6.3047, time_kl_loss: 3.0900, dis_kl_loss: 4.8197, contra_loss: 11066.0861
Test epoch:23, time: 302.323658(s), Recall (@2: 0.1498, @5: 0.2354, @10: 0.3085), NDCG (@2: 0.1303, @5: 0.1685, @10: 0.1922)

Train epoch:24, time: 302.323658(s), rec_loss: 4.9569, tra_kl_loss: 6.2877, time_kl_loss: 3.1787, dis_kl_loss: 4.8182, contra_loss: 10657.8604
Test epoch:24, time: 315.568900(s), Recall (@2: 0.1544, @5: 0.2423, @10: 0.3150), NDCG (@2: 0.1343, @5: 0.1740, @10: 0.1976)

Train epoch:25, time: 315.568900(s), rec_loss: 4.9453, tra_kl_loss: 6.3800, time_kl_loss: 3.1951, dis_kl_loss: 4.8233, contra_loss: 10518.3245
Test epoch:25, time: 328.449628(s), Recall (@2: 0.1626, @5: 0.2484, @10: 0.3236), NDCG (@2: 0.1408, @5: 0.1791, @10: 0.2034)

Train epoch:26, time: 328.449628(s), rec_loss: 4.9316, tra_kl_loss: 6.2412, time_kl_loss: 3.1493, dis_kl_loss: 4.8171, contra_loss: 9905.9446
Test epoch:26, time: 341.501015(s), Recall (@2: 0.1417, @5: 0.2216, @10: 0.2965), NDCG (@2: 0.1246, @5: 0.1607, @10: 0.1849)

Train epoch:27, time: 341.501015(s), rec_loss: 4.9213, tra_kl_loss: 6.2652, time_kl_loss: 3.1956, dis_kl_loss: 4.8126, contra_loss: 9446.7897
Test epoch:27, time: 354.819585(s), Recall (@2: 0.1654, @5: 0.2570, @10: 0.3335), NDCG (@2: 0.1431, @5: 0.1848, @10: 0.2095)

Train epoch:28, time: 354.819585(s), rec_loss: 4.9136, tra_kl_loss: 6.2820, time_kl_loss: 3.1826, dis_kl_loss: 4.8198, contra_loss: 9334.9627
Test epoch:28, time: 368.219837(s), Recall (@2: 0.1466, @5: 0.2322, @10: 0.3038), NDCG (@2: 0.1286, @5: 0.1669, @10: 0.1901)

Train epoch:29, time: 368.219837(s), rec_loss: 4.8937, tra_kl_loss: 6.2439, time_kl_loss: 3.1534, dis_kl_loss: 4.8148, contra_loss: 9019.4256
Test epoch:29, time: 381.669461(s), Recall (@2: 0.1529, @5: 0.2374, @10: 0.3113), NDCG (@2: 0.1340, @5: 0.1723, @10: 0.1962)

Train epoch:30, time: 381.669461(s), rec_loss: 4.8849, tra_kl_loss: 6.3029, time_kl_loss: 3.2368, dis_kl_loss: 4.8172, contra_loss: 8981.9356
Test epoch:30, time: 395.030310(s), Recall (@2: 0.1580, @5: 0.2423, @10: 0.3187), NDCG (@2: 0.1373, @5: 0.1752, @10: 0.1999)

Train epoch:31, time: 395.030310(s), rec_loss: 4.8706, tra_kl_loss: 6.2983, time_kl_loss: 3.1844, dis_kl_loss: 4.8240, contra_loss: 8745.7655
Test epoch:31, time: 408.359052(s), Recall (@2: 0.1531, @5: 0.2370, @10: 0.3105), NDCG (@2: 0.1334, @5: 0.1709, @10: 0.1947)

Train epoch:32, time: 408.359052(s), rec_loss: 4.8631, tra_kl_loss: 6.2549, time_kl_loss: 3.2178, dis_kl_loss: 4.8153, contra_loss: 8475.5688
Test epoch:32, time: 421.095902(s), Recall (@2: 0.1516, @5: 0.2432, @10: 0.3172), NDCG (@2: 0.1332, @5: 0.1743, @10: 0.1981)

Train epoch:33, time: 421.095902(s), rec_loss: 4.8554, tra_kl_loss: 6.3272, time_kl_loss: 3.2185, dis_kl_loss: 4.8224, contra_loss: 8384.7862
Test epoch:33, time: 434.056811(s), Recall (@2: 0.1529, @5: 0.2376, @10: 0.3088), NDCG (@2: 0.1328, @5: 0.1708, @10: 0.1936)

Train epoch:34, time: 434.056811(s), rec_loss: 4.8471, tra_kl_loss: 6.1840, time_kl_loss: 3.2262, dis_kl_loss: 4.8295, contra_loss: 7860.8010
Test epoch:34, time: 447.219263(s), Recall (@2: 0.1486, @5: 0.2320, @10: 0.3042), NDCG (@2: 0.1302, @5: 0.1676, @10: 0.1910)

Train epoch:35, time: 447.219263(s), rec_loss: 4.8348, tra_kl_loss: 6.2636, time_kl_loss: 3.1610, dis_kl_loss: 4.8089, contra_loss: 7679.7089
Test epoch:35, time: 460.316315(s), Recall (@2: 0.1598, @5: 0.2501, @10: 0.3197), NDCG (@2: 0.1396, @5: 0.1802, @10: 0.2026)

Train epoch:36, time: 460.316315(s), rec_loss: 4.8307, tra_kl_loss: 6.2496, time_kl_loss: 3.1407, dis_kl_loss: 4.8336, contra_loss: 7676.0112
Test epoch:36, time: 473.345440(s), Recall (@2: 0.1501, @5: 0.2342, @10: 0.3068), NDCG (@2: 0.1318, @5: 0.1697, @10: 0.1930)

Train epoch:37, time: 473.345440(s), rec_loss: 4.8158, tra_kl_loss: 6.1481, time_kl_loss: 3.1944, dis_kl_loss: 4.8031, contra_loss: 7091.2707
Test epoch:37, time: 486.128386(s), Recall (@2: 0.1544, @5: 0.2378, @10: 0.3122), NDCG (@2: 0.1331, @5: 0.1706, @10: 0.1945)

Train epoch:38, time: 486.128386(s), rec_loss: 4.8154, tra_kl_loss: 6.3055, time_kl_loss: 3.1769, dis_kl_loss: 4.8172, contra_loss: 7376.5090
Test epoch:38, time: 499.521029(s), Recall (@2: 0.1533, @5: 0.2372, @10: 0.3088), NDCG (@2: 0.1331, @5: 0.1706, @10: 0.1936)

Train epoch:39, time: 499.521029(s), rec_loss: 4.7973, tra_kl_loss: 6.2520, time_kl_loss: 3.1627, dis_kl_loss: 4.8142, contra_loss: 7035.9042
Test epoch:39, time: 512.359241(s), Recall (@2: 0.1548, @5: 0.2361, @10: 0.3088), NDCG (@2: 0.1353, @5: 0.1721, @10: 0.1956)

Train epoch:40, time: 512.359241(s), rec_loss: 4.7917, tra_kl_loss: 6.2884, time_kl_loss: 3.1827, dis_kl_loss: 4.8109, contra_loss: 6906.6424
Test epoch:40, time: 525.635061(s), Recall (@2: 0.1432, @5: 0.2204, @10: 0.2909), NDCG (@2: 0.1252, @5: 0.1596, @10: 0.1823)

Train epoch:41, time: 525.635061(s), rec_loss: 4.7833, tra_kl_loss: 6.2563, time_kl_loss: 3.1986, dis_kl_loss: 4.8211, contra_loss: 6859.5297
Test epoch:41, time: 538.543462(s), Recall (@2: 0.1531, @5: 0.2415, @10: 0.3150), NDCG (@2: 0.1353, @5: 0.1750, @10: 0.1986)

Train epoch:42, time: 538.543462(s), rec_loss: 4.7906, tra_kl_loss: 6.3440, time_kl_loss: 3.2031, dis_kl_loss: 4.8194, contra_loss: 6765.7282
Test epoch:42, time: 551.749064(s), Recall (@2: 0.1494, @5: 0.2335, @10: 0.3064), NDCG (@2: 0.1309, @5: 0.1686, @10: 0.1921)

Train epoch:43, time: 551.749064(s), rec_loss: 4.7719, tra_kl_loss: 6.3144, time_kl_loss: 3.2250, dis_kl_loss: 4.8084, contra_loss: 6547.9590
Test epoch:43, time: 564.624747(s), Recall (@2: 0.1462, @5: 0.2313, @10: 0.3072), NDCG (@2: 0.1292, @5: 0.1674, @10: 0.1919)

Train epoch:44, time: 564.624747(s), rec_loss: 4.7678, tra_kl_loss: 6.3258, time_kl_loss: 3.2518, dis_kl_loss: 4.8107, contra_loss: 6606.2368
Test epoch:44, time: 577.917434(s), Recall (@2: 0.1505, @5: 0.2350, @10: 0.3092), NDCG (@2: 0.1309, @5: 0.1690, @10: 0.1931)

Train epoch:45, time: 577.917434(s), rec_loss: 4.7626, tra_kl_loss: 6.2883, time_kl_loss: 3.2063, dis_kl_loss: 4.8099, contra_loss: 6493.2421
Test epoch:45, time: 591.019596(s), Recall (@2: 0.1464, @5: 0.2344, @10: 0.3081), NDCG (@2: 0.1296, @5: 0.1690, @10: 0.1930)

Train epoch:46, time: 591.019596(s), rec_loss: 4.7538, tra_kl_loss: 6.1696, time_kl_loss: 3.1726, dis_kl_loss: 4.8193, contra_loss: 6353.1517
Test epoch:46, time: 604.534069(s), Recall (@2: 0.1481, @5: 0.2333, @10: 0.3042), NDCG (@2: 0.1289, @5: 0.1669, @10: 0.1899)

Train epoch:47, time: 604.534069(s), rec_loss: 4.7513, tra_kl_loss: 6.2783, time_kl_loss: 3.2087, dis_kl_loss: 4.8258, contra_loss: 6268.7588
Test epoch:47, time: 617.761902(s), Recall (@2: 0.1565, @5: 0.2419, @10: 0.3152), NDCG (@2: 0.1364, @5: 0.1749, @10: 0.1986)

Train epoch:48, time: 617.761902(s), rec_loss: 4.7449, tra_kl_loss: 6.3710, time_kl_loss: 3.2232, dis_kl_loss: 4.8223, contra_loss: 6282.7475
Test epoch:48, time: 630.164117(s), Recall (@2: 0.1516, @5: 0.2363, @10: 0.3083), NDCG (@2: 0.1321, @5: 0.1701, @10: 0.1935)

Train epoch:49, time: 630.164117(s), rec_loss: 4.7382, tra_kl_loss: 6.2726, time_kl_loss: 3.2638, dis_kl_loss: 4.8103, contra_loss: 6119.2699
Test epoch:49, time: 641.808362(s), Recall (@2: 0.1613, @5: 0.2441, @10: 0.3165), NDCG (@2: 0.1401, @5: 0.1774, @10: 0.2008)

Train epoch:50, time: 641.808362(s), rec_loss: 4.7276, tra_kl_loss: 6.2121, time_kl_loss: 3.2321, dis_kl_loss: 4.8098, contra_loss: 6247.8280
Test epoch:50, time: 653.210304(s), Recall (@2: 0.1520, @5: 0.2350, @10: 0.3057), NDCG (@2: 0.1329, @5: 0.1698, @10: 0.1926)
