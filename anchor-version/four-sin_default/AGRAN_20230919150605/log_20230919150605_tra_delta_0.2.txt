dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:1
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.2
tem_delta:0.0
dis_delta:0.0
valid_epoch:1
device:cuda:1
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0975, tra_kl_loss: 6.8217, time_kl_loss: 6.0749, dis_kl_loss: 6.0515, contra_loss: 15755.9837
Test epoch:1, time: 12.007229(s), Recall (@2: 0.1104, @5: 0.1639, @10: 0.2199), NDCG (@2: 0.0966, @5: 0.1202, @10: 0.1382)

Train epoch:2, time: 12.007229(s), rec_loss: 7.3547, tra_kl_loss: 9.0622, time_kl_loss: 5.7573, dis_kl_loss: 5.7753, contra_loss: 28217.6323
Test epoch:2, time: 24.604696(s), Recall (@2: 0.1130, @5: 0.1945, @10: 0.2540), NDCG (@2: 0.0999, @5: 0.1360, @10: 0.1553)

Train epoch:3, time: 24.604696(s), rec_loss: 6.8389, tra_kl_loss: 8.4292, time_kl_loss: 5.0868, dis_kl_loss: 5.1103, contra_loss: 27452.4782
Test epoch:3, time: 37.705934(s), Recall (@2: 0.1123, @5: 0.1856, @10: 0.2598), NDCG (@2: 0.0975, @5: 0.1300, @10: 0.1538)

Train epoch:4, time: 37.705934(s), rec_loss: 6.4617, tra_kl_loss: 7.7279, time_kl_loss: 4.9428, dis_kl_loss: 4.9481, contra_loss: 25960.0930
Test epoch:4, time: 50.905506(s), Recall (@2: 0.1244, @5: 0.2066, @10: 0.2803), NDCG (@2: 0.1075, @5: 0.1445, @10: 0.1684)

Train epoch:5, time: 50.905506(s), rec_loss: 6.1812, tra_kl_loss: 7.5326, time_kl_loss: 4.8404, dis_kl_loss: 4.8462, contra_loss: 24804.2072
Test epoch:5, time: 63.958561(s), Recall (@2: 0.1244, @5: 0.2083, @10: 0.2758), NDCG (@2: 0.1069, @5: 0.1443, @10: 0.1662)

Train epoch:6, time: 63.958561(s), rec_loss: 5.9630, tra_kl_loss: 7.4406, time_kl_loss: 4.7960, dis_kl_loss: 4.7929, contra_loss: 23257.6415
Test epoch:6, time: 77.121594(s), Recall (@2: 0.1326, @5: 0.2195, @10: 0.2956), NDCG (@2: 0.1137, @5: 0.1528, @10: 0.1775)

Train epoch:7, time: 77.121594(s), rec_loss: 5.7670, tra_kl_loss: 7.3560, time_kl_loss: 4.7780, dis_kl_loss: 4.8007, contra_loss: 21546.2029
Test epoch:7, time: 90.081482(s), Recall (@2: 0.1386, @5: 0.2214, @10: 0.3016), NDCG (@2: 0.1183, @5: 0.1557, @10: 0.1815)

Train epoch:8, time: 90.081482(s), rec_loss: 5.6247, tra_kl_loss: 7.5597, time_kl_loss: 4.7707, dis_kl_loss: 4.7898, contra_loss: 20173.5695
Test epoch:8, time: 103.063082(s), Recall (@2: 0.1425, @5: 0.2298, @10: 0.3036), NDCG (@2: 0.1221, @5: 0.1613, @10: 0.1851)

Train epoch:9, time: 103.063082(s), rec_loss: 5.5149, tra_kl_loss: 7.4706, time_kl_loss: 4.7499, dis_kl_loss: 4.7562, contra_loss: 18993.6017
Test epoch:9, time: 115.920837(s), Recall (@2: 0.1438, @5: 0.2318, @10: 0.2999), NDCG (@2: 0.1226, @5: 0.1621, @10: 0.1841)

Train epoch:10, time: 115.920837(s), rec_loss: 5.4124, tra_kl_loss: 7.3195, time_kl_loss: 4.7689, dis_kl_loss: 4.7182, contra_loss: 16715.2740
Test epoch:10, time: 128.659033(s), Recall (@2: 0.1483, @5: 0.2311, @10: 0.3053), NDCG (@2: 0.1263, @5: 0.1633, @10: 0.1875)

Train epoch:11, time: 128.659033(s), rec_loss: 5.3425, tra_kl_loss: 7.1869, time_kl_loss: 4.7423, dis_kl_loss: 4.6796, contra_loss: 15904.5009
Test epoch:11, time: 141.691518(s), Recall (@2: 0.1473, @5: 0.2393, @10: 0.3081), NDCG (@2: 0.1258, @5: 0.1669, @10: 0.1891)

Train epoch:12, time: 141.691518(s), rec_loss: 5.2812, tra_kl_loss: 7.3980, time_kl_loss: 4.6965, dis_kl_loss: 4.7132, contra_loss: 15017.0322
Test epoch:12, time: 154.621504(s), Recall (@2: 0.1494, @5: 0.2359, @10: 0.3062), NDCG (@2: 0.1289, @5: 0.1675, @10: 0.1902)

Train epoch:13, time: 154.621504(s), rec_loss: 5.2299, tra_kl_loss: 7.1676, time_kl_loss: 4.7220, dis_kl_loss: 4.6949, contra_loss: 14426.6931
Test epoch:13, time: 167.122060(s), Recall (@2: 0.1533, @5: 0.2462, @10: 0.3215), NDCG (@2: 0.1316, @5: 0.1732, @10: 0.1976)

Train epoch:14, time: 167.122060(s), rec_loss: 5.1852, tra_kl_loss: 6.9772, time_kl_loss: 4.7075, dis_kl_loss: 4.6974, contra_loss: 13616.6107
Test epoch:14, time: 179.677944(s), Recall (@2: 0.1473, @5: 0.2350, @10: 0.3051), NDCG (@2: 0.1269, @5: 0.1665, @10: 0.1891)

Train epoch:15, time: 179.677944(s), rec_loss: 5.1431, tra_kl_loss: 7.0962, time_kl_loss: 4.6822, dis_kl_loss: 4.6695, contra_loss: 13053.1722
Test epoch:15, time: 192.147816(s), Recall (@2: 0.1449, @5: 0.2344, @10: 0.3062), NDCG (@2: 0.1264, @5: 0.1667, @10: 0.1898)

Train epoch:16, time: 192.147816(s), rec_loss: 5.1065, tra_kl_loss: 7.0745, time_kl_loss: 4.6626, dis_kl_loss: 4.6741, contra_loss: 12276.6072
Test epoch:16, time: 204.565576(s), Recall (@2: 0.1475, @5: 0.2398, @10: 0.3077), NDCG (@2: 0.1285, @5: 0.1702, @10: 0.1923)

Train epoch:17, time: 204.565576(s), rec_loss: 5.0749, tra_kl_loss: 7.0974, time_kl_loss: 4.6386, dis_kl_loss: 4.6864, contra_loss: 11469.2249
Test epoch:17, time: 217.052044(s), Recall (@2: 0.1574, @5: 0.2471, @10: 0.3197), NDCG (@2: 0.1361, @5: 0.1765, @10: 0.1999)

Train epoch:18, time: 217.052044(s), rec_loss: 5.0540, tra_kl_loss: 7.0150, time_kl_loss: 4.7104, dis_kl_loss: 4.7042, contra_loss: 11142.6887
Test epoch:18, time: 229.641497(s), Recall (@2: 0.1542, @5: 0.2378, @10: 0.3137), NDCG (@2: 0.1345, @5: 0.1721, @10: 0.1965)

Train epoch:19, time: 229.641497(s), rec_loss: 5.0250, tra_kl_loss: 7.0449, time_kl_loss: 4.5781, dis_kl_loss: 4.6568, contra_loss: 10611.0595
Test epoch:19, time: 242.296955(s), Recall (@2: 0.1559, @5: 0.2449, @10: 0.3150), NDCG (@2: 0.1347, @5: 0.1747, @10: 0.1974)

Train epoch:20, time: 242.296955(s), rec_loss: 5.0119, tra_kl_loss: 7.0555, time_kl_loss: 4.6701, dis_kl_loss: 4.6874, contra_loss: 10351.5132
Test epoch:20, time: 255.096563(s), Recall (@2: 0.1520, @5: 0.2404, @10: 0.3100), NDCG (@2: 0.1324, @5: 0.1718, @10: 0.1943)

Train epoch:21, time: 255.096563(s), rec_loss: 4.9746, tra_kl_loss: 7.0084, time_kl_loss: 4.6599, dis_kl_loss: 4.6266, contra_loss: 10078.7163
Test epoch:21, time: 268.217039(s), Recall (@2: 0.1570, @5: 0.2497, @10: 0.3208), NDCG (@2: 0.1360, @5: 0.1772, @10: 0.2003)

Train epoch:22, time: 268.217039(s), rec_loss: 4.9581, tra_kl_loss: 7.1096, time_kl_loss: 4.6404, dis_kl_loss: 4.6591, contra_loss: 9474.8187
Test epoch:22, time: 281.341865(s), Recall (@2: 0.1608, @5: 0.2486, @10: 0.3219), NDCG (@2: 0.1394, @5: 0.1788, @10: 0.2025)

Train epoch:23, time: 281.341865(s), rec_loss: 4.9451, tra_kl_loss: 6.9723, time_kl_loss: 4.6975, dis_kl_loss: 4.6842, contra_loss: 9305.1181
Test epoch:23, time: 294.263282(s), Recall (@2: 0.1483, @5: 0.2335, @10: 0.3075), NDCG (@2: 0.1280, @5: 0.1664, @10: 0.1902)

Train epoch:24, time: 294.263282(s), rec_loss: 4.9235, tra_kl_loss: 7.0884, time_kl_loss: 4.6505, dis_kl_loss: 4.6997, contra_loss: 9130.7986
Test epoch:24, time: 307.090710(s), Recall (@2: 0.1544, @5: 0.2458, @10: 0.3152), NDCG (@2: 0.1347, @5: 0.1758, @10: 0.1981)

Train epoch:25, time: 307.090710(s), rec_loss: 4.9085, tra_kl_loss: 7.3442, time_kl_loss: 4.6355, dis_kl_loss: 4.6386, contra_loss: 8981.2407
Test epoch:25, time: 319.632313(s), Recall (@2: 0.1570, @5: 0.2402, @10: 0.3137), NDCG (@2: 0.1350, @5: 0.1723, @10: 0.1961)

Train epoch:26, time: 319.632313(s), rec_loss: 4.8920, tra_kl_loss: 7.0671, time_kl_loss: 4.6376, dis_kl_loss: 4.6647, contra_loss: 8626.5561
Test epoch:26, time: 332.752181(s), Recall (@2: 0.1412, @5: 0.2249, @10: 0.2965), NDCG (@2: 0.1245, @5: 0.1620, @10: 0.1853)

Train epoch:27, time: 332.752181(s), rec_loss: 4.8812, tra_kl_loss: 7.0933, time_kl_loss: 4.6219, dis_kl_loss: 4.6809, contra_loss: 8104.6766
Test epoch:27, time: 345.562263(s), Recall (@2: 0.1684, @5: 0.2559, @10: 0.3284), NDCG (@2: 0.1448, @5: 0.1842, @10: 0.2077)

Train epoch:28, time: 345.562263(s), rec_loss: 4.8713, tra_kl_loss: 7.1809, time_kl_loss: 4.6327, dis_kl_loss: 4.6567, contra_loss: 7995.1082
Test epoch:28, time: 358.754287(s), Recall (@2: 0.1462, @5: 0.2342, @10: 0.3003), NDCG (@2: 0.1282, @5: 0.1675, @10: 0.1888)

Train epoch:29, time: 358.754287(s), rec_loss: 4.8554, tra_kl_loss: 7.2099, time_kl_loss: 4.5989, dis_kl_loss: 4.6664, contra_loss: 7686.3816
Test epoch:29, time: 371.842136(s), Recall (@2: 0.1572, @5: 0.2387, @10: 0.3152), NDCG (@2: 0.1363, @5: 0.1732, @10: 0.1978)

Train epoch:30, time: 371.842136(s), rec_loss: 4.8426, tra_kl_loss: 7.0619, time_kl_loss: 4.6505, dis_kl_loss: 4.5870, contra_loss: 7618.5510
Test epoch:30, time: 385.177988(s), Recall (@2: 0.1555, @5: 0.2428, @10: 0.3167), NDCG (@2: 0.1360, @5: 0.1751, @10: 0.1989)

Train epoch:31, time: 385.177988(s), rec_loss: 4.8328, tra_kl_loss: 7.2120, time_kl_loss: 4.6577, dis_kl_loss: 4.6732, contra_loss: 7545.9338
Test epoch:31, time: 397.733193(s), Recall (@2: 0.1570, @5: 0.2376, @10: 0.3120), NDCG (@2: 0.1367, @5: 0.1728, @10: 0.1969)

Train epoch:32, time: 397.733193(s), rec_loss: 4.8183, tra_kl_loss: 7.1728, time_kl_loss: 4.6283, dis_kl_loss: 4.6485, contra_loss: 7545.3843
Test epoch:32, time: 410.408133(s), Recall (@2: 0.1520, @5: 0.2398, @10: 0.3176), NDCG (@2: 0.1339, @5: 0.1732, @10: 0.1986)

Train epoch:33, time: 410.408133(s), rec_loss: 4.8063, tra_kl_loss: 7.4299, time_kl_loss: 4.6867, dis_kl_loss: 4.6540, contra_loss: 7377.3711
Test epoch:33, time: 423.498228(s), Recall (@2: 0.1496, @5: 0.2324, @10: 0.3029), NDCG (@2: 0.1315, @5: 0.1684, @10: 0.1913)

Train epoch:34, time: 423.498228(s), rec_loss: 4.7975, tra_kl_loss: 7.0585, time_kl_loss: 4.6500, dis_kl_loss: 4.6425, contra_loss: 6925.3827
Test epoch:34, time: 436.577213(s), Recall (@2: 0.1455, @5: 0.2307, @10: 0.3103), NDCG (@2: 0.1280, @5: 0.1665, @10: 0.1921)

Train epoch:35, time: 436.577213(s), rec_loss: 4.7862, tra_kl_loss: 7.1847, time_kl_loss: 4.6069, dis_kl_loss: 4.6304, contra_loss: 6706.9891
Test epoch:35, time: 449.486506(s), Recall (@2: 0.1632, @5: 0.2473, @10: 0.3292), NDCG (@2: 0.1432, @5: 0.1807, @10: 0.2070)

Train epoch:36, time: 449.486506(s), rec_loss: 4.7811, tra_kl_loss: 7.1678, time_kl_loss: 4.6320, dis_kl_loss: 4.7210, contra_loss: 6719.8682
Test epoch:36, time: 462.882547(s), Recall (@2: 0.1511, @5: 0.2318, @10: 0.3090), NDCG (@2: 0.1323, @5: 0.1685, @10: 0.1935)

Train epoch:37, time: 462.882547(s), rec_loss: 4.7634, tra_kl_loss: 7.1208, time_kl_loss: 4.6831, dis_kl_loss: 4.5834, contra_loss: 6220.2262
Test epoch:37, time: 476.369733(s), Recall (@2: 0.1490, @5: 0.2313, @10: 0.3088), NDCG (@2: 0.1303, @5: 0.1672, @10: 0.1920)

Train epoch:38, time: 476.369733(s), rec_loss: 4.7682, tra_kl_loss: 7.2146, time_kl_loss: 4.6769, dis_kl_loss: 4.6383, contra_loss: 6474.6892
Test epoch:38, time: 489.562631(s), Recall (@2: 0.1527, @5: 0.2339, @10: 0.3075), NDCG (@2: 0.1324, @5: 0.1684, @10: 0.1920)

Train epoch:39, time: 489.562631(s), rec_loss: 4.7537, tra_kl_loss: 7.1775, time_kl_loss: 4.6460, dis_kl_loss: 4.6915, contra_loss: 6215.7273
Test epoch:39, time: 503.075444(s), Recall (@2: 0.1529, @5: 0.2318, @10: 0.3070), NDCG (@2: 0.1338, @5: 0.1690, @10: 0.1933)

Train epoch:40, time: 503.075444(s), rec_loss: 4.7436, tra_kl_loss: 7.2416, time_kl_loss: 4.6600, dis_kl_loss: 4.6418, contra_loss: 6132.0045
Test epoch:40, time: 516.105139(s), Recall (@2: 0.1447, @5: 0.2186, @10: 0.2878), NDCG (@2: 0.1268, @5: 0.1599, @10: 0.1822)

Train epoch:41, time: 516.105139(s), rec_loss: 4.7372, tra_kl_loss: 7.1311, time_kl_loss: 4.6403, dis_kl_loss: 4.6557, contra_loss: 6076.6993
Test epoch:41, time: 529.104919(s), Recall (@2: 0.1567, @5: 0.2370, @10: 0.3068), NDCG (@2: 0.1373, @5: 0.1734, @10: 0.1958)

Train epoch:42, time: 529.104919(s), rec_loss: 4.7368, tra_kl_loss: 7.1226, time_kl_loss: 4.6579, dis_kl_loss: 4.6496, contra_loss: 5993.3841
Test epoch:42, time: 542.484197(s), Recall (@2: 0.1507, @5: 0.2281, @10: 0.3025), NDCG (@2: 0.1331, @5: 0.1679, @10: 0.1920)

Train epoch:43, time: 542.484197(s), rec_loss: 4.7212, tra_kl_loss: 7.2091, time_kl_loss: 4.6779, dis_kl_loss: 4.6488, contra_loss: 5764.2751
Test epoch:43, time: 555.727266(s), Recall (@2: 0.1468, @5: 0.2279, @10: 0.3051), NDCG (@2: 0.1291, @5: 0.1654, @10: 0.1902)

Train epoch:44, time: 555.727266(s), rec_loss: 4.7154, tra_kl_loss: 7.3874, time_kl_loss: 4.6460, dis_kl_loss: 4.6520, contra_loss: 5792.1755
Test epoch:44, time: 569.136733(s), Recall (@2: 0.1503, @5: 0.2290, @10: 0.3051), NDCG (@2: 0.1327, @5: 0.1680, @10: 0.1926)

Train epoch:45, time: 569.136733(s), rec_loss: 4.7126, tra_kl_loss: 7.1425, time_kl_loss: 4.6058, dis_kl_loss: 4.6363, contra_loss: 5643.6011
Test epoch:45, time: 581.978251(s), Recall (@2: 0.1496, @5: 0.2268, @10: 0.3014), NDCG (@2: 0.1318, @5: 0.1666, @10: 0.1906)

Train epoch:46, time: 581.978251(s), rec_loss: 4.7063, tra_kl_loss: 7.0125, time_kl_loss: 4.6268, dis_kl_loss: 4.6603, contra_loss: 5590.9044
Test epoch:46, time: 595.147287(s), Recall (@2: 0.1501, @5: 0.2298, @10: 0.3055), NDCG (@2: 0.1326, @5: 0.1683, @10: 0.1926)

Train epoch:47, time: 595.147287(s), rec_loss: 4.6946, tra_kl_loss: 7.0493, time_kl_loss: 4.6556, dis_kl_loss: 4.6889, contra_loss: 5436.7366
Test epoch:47, time: 608.326439(s), Recall (@2: 0.1555, @5: 0.2357, @10: 0.3161), NDCG (@2: 0.1360, @5: 0.1721, @10: 0.1979)

Train epoch:48, time: 608.326439(s), rec_loss: 4.6903, tra_kl_loss: 7.3084, time_kl_loss: 4.6205, dis_kl_loss: 4.6663, contra_loss: 5444.1653
Test epoch:48, time: 621.401191(s), Recall (@2: 0.1580, @5: 0.2348, @10: 0.3116), NDCG (@2: 0.1393, @5: 0.1737, @10: 0.1984)

Train epoch:49, time: 621.401191(s), rec_loss: 4.6841, tra_kl_loss: 7.2096, time_kl_loss: 4.6686, dis_kl_loss: 4.5831, contra_loss: 5235.0786
Test epoch:49, time: 633.771046(s), Recall (@2: 0.1561, @5: 0.2400, @10: 0.3133), NDCG (@2: 0.1363, @5: 0.1737, @10: 0.1970)

Train epoch:50, time: 633.771046(s), rec_loss: 4.6768, tra_kl_loss: 7.1120, time_kl_loss: 4.6677, dis_kl_loss: 4.6512, contra_loss: 5368.7053
Test epoch:50, time: 646.043569(s), Recall (@2: 0.1511, @5: 0.2285, @10: 0.3029), NDCG (@2: 0.1335, @5: 0.1681, @10: 0.1920)
