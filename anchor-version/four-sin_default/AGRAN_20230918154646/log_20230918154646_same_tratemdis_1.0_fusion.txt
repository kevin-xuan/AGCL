dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:1
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.0
dis_delta:0.0
valid_epoch:1
device:cuda:1
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0943, tra_kl_loss: 6.6440, time_kl_loss: 5.9625, dis_kl_loss: 5.9510, contra_loss: 14437.0844
Test epoch:1, time: 11.943206(s), Recall (@2: 0.1117, @5: 0.1647, @10: 0.2165), NDCG (@2: 0.0978, @5: 0.1216, @10: 0.1383)

Train epoch:2, time: 11.943206(s), rec_loss: 7.3499, tra_kl_loss: 7.3980, time_kl_loss: 5.8296, dis_kl_loss: 5.8228, contra_loss: 28461.3661
Test epoch:2, time: 23.160107(s), Recall (@2: 0.1119, @5: 0.1925, @10: 0.2518), NDCG (@2: 0.0975, @5: 0.1332, @10: 0.1525)

Train epoch:3, time: 23.160107(s), rec_loss: 6.8464, tra_kl_loss: 6.8091, time_kl_loss: 5.1537, dis_kl_loss: 5.1429, contra_loss: 29503.9536
Test epoch:3, time: 34.381502(s), Recall (@2: 0.1115, @5: 0.1794, @10: 0.2538), NDCG (@2: 0.0973, @5: 0.1277, @10: 0.1516)

Train epoch:4, time: 34.381502(s), rec_loss: 6.4830, tra_kl_loss: 6.5778, time_kl_loss: 4.9192, dis_kl_loss: 4.9217, contra_loss: 28405.4828
Test epoch:4, time: 45.923873(s), Recall (@2: 0.1235, @5: 0.2078, @10: 0.2792), NDCG (@2: 0.1069, @5: 0.1444, @10: 0.1675)

Train epoch:5, time: 45.923873(s), rec_loss: 6.2083, tra_kl_loss: 6.5304, time_kl_loss: 4.8891, dis_kl_loss: 4.8854, contra_loss: 27740.3009
Test epoch:5, time: 57.603216(s), Recall (@2: 0.1263, @5: 0.2087, @10: 0.2790), NDCG (@2: 0.1091, @5: 0.1457, @10: 0.1684)

Train epoch:6, time: 57.603216(s), rec_loss: 5.9904, tra_kl_loss: 6.4365, time_kl_loss: 4.8116, dis_kl_loss: 4.8066, contra_loss: 25763.4272
Test epoch:6, time: 69.148583(s), Recall (@2: 0.1311, @5: 0.2163, @10: 0.2906), NDCG (@2: 0.1138, @5: 0.1520, @10: 0.1762)

Train epoch:7, time: 69.148583(s), rec_loss: 5.8075, tra_kl_loss: 6.4804, time_kl_loss: 4.8036, dis_kl_loss: 4.8051, contra_loss: 25278.1109
Test epoch:7, time: 80.665860(s), Recall (@2: 0.1352, @5: 0.2201, @10: 0.2962), NDCG (@2: 0.1158, @5: 0.1542, @10: 0.1787)

Train epoch:8, time: 80.665860(s), rec_loss: 5.6600, tra_kl_loss: 6.4655, time_kl_loss: 4.8024, dis_kl_loss: 4.7999, contra_loss: 23368.2471
Test epoch:8, time: 92.143608(s), Recall (@2: 0.1395, @5: 0.2264, @10: 0.3064), NDCG (@2: 0.1196, @5: 0.1587, @10: 0.1845)

Train epoch:9, time: 92.143608(s), rec_loss: 5.5500, tra_kl_loss: 6.4213, time_kl_loss: 4.7842, dis_kl_loss: 4.7787, contra_loss: 22755.9196
Test epoch:9, time: 103.737826(s), Recall (@2: 0.1429, @5: 0.2264, @10: 0.3025), NDCG (@2: 0.1222, @5: 0.1598, @10: 0.1842)

Train epoch:10, time: 103.737826(s), rec_loss: 5.4408, tra_kl_loss: 6.3373, time_kl_loss: 4.7211, dis_kl_loss: 4.7184, contra_loss: 20471.1170
Test epoch:10, time: 115.256592(s), Recall (@2: 0.1455, @5: 0.2292, @10: 0.2960), NDCG (@2: 0.1245, @5: 0.1621, @10: 0.1838)

Train epoch:11, time: 115.256592(s), rec_loss: 5.3658, tra_kl_loss: 6.3859, time_kl_loss: 4.7594, dis_kl_loss: 4.7569, contra_loss: 20733.7057
Test epoch:11, time: 126.833539(s), Recall (@2: 0.1451, @5: 0.2301, @10: 0.3077), NDCG (@2: 0.1257, @5: 0.1639, @10: 0.1890)

Train epoch:12, time: 126.833539(s), rec_loss: 5.3034, tra_kl_loss: 6.3107, time_kl_loss: 4.7049, dis_kl_loss: 4.7017, contra_loss: 19353.3988
Test epoch:12, time: 138.136409(s), Recall (@2: 0.1458, @5: 0.2344, @10: 0.3031), NDCG (@2: 0.1253, @5: 0.1651, @10: 0.1872)

Train epoch:13, time: 138.136409(s), rec_loss: 5.2460, tra_kl_loss: 6.3909, time_kl_loss: 4.7237, dis_kl_loss: 4.7241, contra_loss: 19406.7341
Test epoch:13, time: 149.448873(s), Recall (@2: 0.1475, @5: 0.2352, @10: 0.3100), NDCG (@2: 0.1263, @5: 0.1657, @10: 0.1899)

Train epoch:14, time: 149.448873(s), rec_loss: 5.1959, tra_kl_loss: 6.3189, time_kl_loss: 4.6697, dis_kl_loss: 4.6642, contra_loss: 18836.8079
Test epoch:14, time: 161.058485(s), Recall (@2: 0.1460, @5: 0.2324, @10: 0.3034), NDCG (@2: 0.1267, @5: 0.1652, @10: 0.1882)

Train epoch:15, time: 161.058485(s), rec_loss: 5.1534, tra_kl_loss: 6.2825, time_kl_loss: 4.7005, dis_kl_loss: 4.7006, contra_loss: 18490.2701
Test epoch:15, time: 172.493452(s), Recall (@2: 0.1460, @5: 0.2309, @10: 0.3040), NDCG (@2: 0.1269, @5: 0.1649, @10: 0.1885)

Train epoch:16, time: 172.493452(s), rec_loss: 5.1217, tra_kl_loss: 6.2882, time_kl_loss: 4.6634, dis_kl_loss: 4.6609, contra_loss: 17984.3248
Test epoch:16, time: 183.842642(s), Recall (@2: 0.1455, @5: 0.2354, @10: 0.3070), NDCG (@2: 0.1267, @5: 0.1671, @10: 0.1901)

Train epoch:17, time: 183.842642(s), rec_loss: 5.0820, tra_kl_loss: 6.3130, time_kl_loss: 4.7310, dis_kl_loss: 4.7290, contra_loss: 17851.3087
Test epoch:17, time: 195.095263(s), Recall (@2: 0.1507, @5: 0.2477, @10: 0.3139), NDCG (@2: 0.1307, @5: 0.1742, @10: 0.1956)

Train epoch:18, time: 195.095263(s), rec_loss: 5.0569, tra_kl_loss: 6.3954, time_kl_loss: 4.7672, dis_kl_loss: 4.7663, contra_loss: 18099.8027
Test epoch:18, time: 206.553298(s), Recall (@2: 0.1511, @5: 0.2395, @10: 0.3124), NDCG (@2: 0.1316, @5: 0.1711, @10: 0.1946)

Train epoch:19, time: 206.553298(s), rec_loss: 5.0258, tra_kl_loss: 6.1885, time_kl_loss: 4.6148, dis_kl_loss: 4.6149, contra_loss: 17556.7358
Test epoch:19, time: 217.845001(s), Recall (@2: 0.1518, @5: 0.2413, @10: 0.3200), NDCG (@2: 0.1314, @5: 0.1713, @10: 0.1968)

Train epoch:20, time: 217.845001(s), rec_loss: 5.0056, tra_kl_loss: 6.3480, time_kl_loss: 4.6608, dis_kl_loss: 4.6563, contra_loss: 17890.5743
Test epoch:20, time: 229.271000(s), Recall (@2: 0.1470, @5: 0.2391, @10: 0.3129), NDCG (@2: 0.1287, @5: 0.1700, @10: 0.1938)

Train epoch:21, time: 229.271000(s), rec_loss: 4.9776, tra_kl_loss: 6.3911, time_kl_loss: 4.6350, dis_kl_loss: 4.6341, contra_loss: 17919.5715
Test epoch:21, time: 240.440140(s), Recall (@2: 0.1527, @5: 0.2398, @10: 0.3139), NDCG (@2: 0.1340, @5: 0.1728, @10: 0.1969)

Train epoch:22, time: 240.440140(s), rec_loss: 4.9554, tra_kl_loss: 6.3245, time_kl_loss: 4.6241, dis_kl_loss: 4.6270, contra_loss: 17111.0953
Test epoch:22, time: 251.800458(s), Recall (@2: 0.1583, @5: 0.2557, @10: 0.3236), NDCG (@2: 0.1385, @5: 0.1819, @10: 0.2040)

Train epoch:23, time: 251.800458(s), rec_loss: 4.9434, tra_kl_loss: 6.3805, time_kl_loss: 4.6720, dis_kl_loss: 4.6743, contra_loss: 18485.1969
Test epoch:23, time: 263.121179(s), Recall (@2: 0.1501, @5: 0.2365, @10: 0.3070), NDCG (@2: 0.1294, @5: 0.1682, @10: 0.1909)

Train epoch:24, time: 263.121179(s), rec_loss: 4.9141, tra_kl_loss: 6.2332, time_kl_loss: 4.6634, dis_kl_loss: 4.6599, contra_loss: 17589.7446
Test epoch:24, time: 274.382359(s), Recall (@2: 0.1537, @5: 0.2415, @10: 0.3161), NDCG (@2: 0.1345, @5: 0.1737, @10: 0.1979)

Train epoch:25, time: 274.382359(s), rec_loss: 4.9032, tra_kl_loss: 6.4672, time_kl_loss: 4.6921, dis_kl_loss: 4.6937, contra_loss: 18464.8440
Test epoch:25, time: 285.630533(s), Recall (@2: 0.1527, @5: 0.2426, @10: 0.3174), NDCG (@2: 0.1330, @5: 0.1731, @10: 0.1972)

Train epoch:26, time: 285.630533(s), rec_loss: 4.8888, tra_kl_loss: 6.2966, time_kl_loss: 4.6086, dis_kl_loss: 4.6046, contra_loss: 17781.3081
Test epoch:26, time: 296.797299(s), Recall (@2: 0.1432, @5: 0.2309, @10: 0.2969), NDCG (@2: 0.1273, @5: 0.1665, @10: 0.1879)

Train epoch:27, time: 296.797299(s), rec_loss: 4.8730, tra_kl_loss: 6.3232, time_kl_loss: 4.6807, dis_kl_loss: 4.6803, contra_loss: 17489.2849
Test epoch:27, time: 308.194721(s), Recall (@2: 0.1645, @5: 0.2622, @10: 0.3357), NDCG (@2: 0.1428, @5: 0.1867, @10: 0.2105)

Train epoch:28, time: 308.194721(s), rec_loss: 4.8687, tra_kl_loss: 6.3388, time_kl_loss: 4.7077, dis_kl_loss: 4.7067, contra_loss: 17882.0631
Test epoch:28, time: 319.647812(s), Recall (@2: 0.1492, @5: 0.2316, @10: 0.3034), NDCG (@2: 0.1303, @5: 0.1671, @10: 0.1904)

Train epoch:29, time: 319.647812(s), rec_loss: 4.8464, tra_kl_loss: 6.2902, time_kl_loss: 4.6862, dis_kl_loss: 4.6829, contra_loss: 17753.8610
Test epoch:29, time: 330.902183(s), Recall (@2: 0.1518, @5: 0.2428, @10: 0.3109), NDCG (@2: 0.1328, @5: 0.1738, @10: 0.1960)

Train epoch:30, time: 330.902183(s), rec_loss: 4.8322, tra_kl_loss: 6.3271, time_kl_loss: 4.6823, dis_kl_loss: 4.6836, contra_loss: 17173.9610
Test epoch:30, time: 342.310053(s), Recall (@2: 0.1550, @5: 0.2467, @10: 0.3139), NDCG (@2: 0.1368, @5: 0.1780, @10: 0.1997)

Train epoch:31, time: 342.310053(s), rec_loss: 4.8205, tra_kl_loss: 6.2995, time_kl_loss: 4.6059, dis_kl_loss: 4.5975, contra_loss: 17152.1642
Test epoch:31, time: 353.771186(s), Recall (@2: 0.1518, @5: 0.2363, @10: 0.3096), NDCG (@2: 0.1332, @5: 0.1710, @10: 0.1948)

Train epoch:32, time: 353.771186(s), rec_loss: 4.8075, tra_kl_loss: 6.3403, time_kl_loss: 4.7056, dis_kl_loss: 4.7084, contra_loss: 16810.8157
Test epoch:32, time: 365.030947(s), Recall (@2: 0.1486, @5: 0.2354, @10: 0.3083), NDCG (@2: 0.1315, @5: 0.1707, @10: 0.1942)

Train epoch:33, time: 365.030947(s), rec_loss: 4.7983, tra_kl_loss: 6.3089, time_kl_loss: 4.5729, dis_kl_loss: 4.5706, contra_loss: 16464.9014
Test epoch:33, time: 376.415202(s), Recall (@2: 0.1479, @5: 0.2311, @10: 0.2952), NDCG (@2: 0.1291, @5: 0.1666, @10: 0.1871)

Train epoch:34, time: 376.415202(s), rec_loss: 4.7885, tra_kl_loss: 6.2469, time_kl_loss: 4.6742, dis_kl_loss: 4.6734, contra_loss: 15852.5892
Test epoch:34, time: 387.924428(s), Recall (@2: 0.1440, @5: 0.2255, @10: 0.2941), NDCG (@2: 0.1272, @5: 0.1638, @10: 0.1859)

Train epoch:35, time: 387.924428(s), rec_loss: 4.7728, tra_kl_loss: 6.2852, time_kl_loss: 4.6805, dis_kl_loss: 4.6822, contra_loss: 15596.4889
Test epoch:35, time: 399.249582(s), Recall (@2: 0.1535, @5: 0.2449, @10: 0.3159), NDCG (@2: 0.1341, @5: 0.1752, @10: 0.1981)

Train epoch:36, time: 399.249582(s), rec_loss: 4.7693, tra_kl_loss: 6.2696, time_kl_loss: 4.6435, dis_kl_loss: 4.6483, contra_loss: 16132.0435
Test epoch:36, time: 410.688635(s), Recall (@2: 0.1507, @5: 0.2322, @10: 0.3040), NDCG (@2: 0.1311, @5: 0.1678, @10: 0.1909)

Train epoch:37, time: 410.688635(s), rec_loss: 4.7549, tra_kl_loss: 6.2081, time_kl_loss: 4.6813, dis_kl_loss: 4.6827, contra_loss: 14873.8815
Test epoch:37, time: 421.939409(s), Recall (@2: 0.1531, @5: 0.2378, @10: 0.3055), NDCG (@2: 0.1328, @5: 0.1708, @10: 0.1925)

Train epoch:38, time: 421.939409(s), rec_loss: 4.7502, tra_kl_loss: 6.3532, time_kl_loss: 4.6889, dis_kl_loss: 4.6881, contra_loss: 15401.3100
Test epoch:38, time: 433.342580(s), Recall (@2: 0.1483, @5: 0.2318, @10: 0.3053), NDCG (@2: 0.1314, @5: 0.1689, @10: 0.1928)

Train epoch:39, time: 433.342580(s), rec_loss: 4.7322, tra_kl_loss: 6.3086, time_kl_loss: 4.6577, dis_kl_loss: 4.6497, contra_loss: 14576.4538
Test epoch:39, time: 444.820303(s), Recall (@2: 0.1498, @5: 0.2348, @10: 0.3047), NDCG (@2: 0.1309, @5: 0.1692, @10: 0.1919)

Train epoch:40, time: 444.820303(s), rec_loss: 4.7277, tra_kl_loss: 6.2802, time_kl_loss: 4.6565, dis_kl_loss: 4.6545, contra_loss: 14389.4114
Test epoch:40, time: 456.283056(s), Recall (@2: 0.1427, @5: 0.2253, @10: 0.2945), NDCG (@2: 0.1256, @5: 0.1627, @10: 0.1849)

Train epoch:41, time: 456.283056(s), rec_loss: 4.7271, tra_kl_loss: 6.3382, time_kl_loss: 4.6673, dis_kl_loss: 4.6691, contra_loss: 14343.4401
Test epoch:41, time: 467.685526(s), Recall (@2: 0.1511, @5: 0.2357, @10: 0.3064), NDCG (@2: 0.1330, @5: 0.1711, @10: 0.1939)

Train epoch:42, time: 467.685526(s), rec_loss: 4.7213, tra_kl_loss: 6.3780, time_kl_loss: 4.6936, dis_kl_loss: 4.6948, contra_loss: 14428.7007
Test epoch:42, time: 479.076401(s), Recall (@2: 0.1470, @5: 0.2307, @10: 0.3040), NDCG (@2: 0.1303, @5: 0.1678, @10: 0.1915)

Train epoch:43, time: 479.076401(s), rec_loss: 4.6989, tra_kl_loss: 6.3378, time_kl_loss: 4.6289, dis_kl_loss: 4.6287, contra_loss: 13709.2659
Test epoch:43, time: 490.391387(s), Recall (@2: 0.1412, @5: 0.2264, @10: 0.2958), NDCG (@2: 0.1244, @5: 0.1628, @10: 0.1854)

Train epoch:44, time: 490.391387(s), rec_loss: 4.6935, tra_kl_loss: 6.3719, time_kl_loss: 4.6002, dis_kl_loss: 4.5988, contra_loss: 13682.3938
Test epoch:44, time: 501.750217(s), Recall (@2: 0.1503, @5: 0.2285, @10: 0.3027), NDCG (@2: 0.1322, @5: 0.1675, @10: 0.1914)

Train epoch:45, time: 501.750217(s), rec_loss: 4.6890, tra_kl_loss: 6.2906, time_kl_loss: 4.6996, dis_kl_loss: 4.6971, contra_loss: 13216.8940
Test epoch:45, time: 513.325773(s), Recall (@2: 0.1509, @5: 0.2309, @10: 0.3070), NDCG (@2: 0.1328, @5: 0.1687, @10: 0.1933)

Train epoch:46, time: 513.325773(s), rec_loss: 4.6814, tra_kl_loss: 6.2194, time_kl_loss: 4.6851, dis_kl_loss: 4.6794, contra_loss: 12908.7286
Test epoch:46, time: 524.583839(s), Recall (@2: 0.1479, @5: 0.2266, @10: 0.3014), NDCG (@2: 0.1301, @5: 0.1650, @10: 0.1891)

Train epoch:47, time: 524.583839(s), rec_loss: 4.6761, tra_kl_loss: 6.2880, time_kl_loss: 4.5965, dis_kl_loss: 4.6002, contra_loss: 12456.5921
Test epoch:47, time: 536.104415(s), Recall (@2: 0.1552, @5: 0.2342, @10: 0.3124), NDCG (@2: 0.1347, @5: 0.1700, @10: 0.1954)

Train epoch:48, time: 536.104415(s), rec_loss: 4.6644, tra_kl_loss: 6.3544, time_kl_loss: 4.6219, dis_kl_loss: 4.6175, contra_loss: 12631.9309
Test epoch:48, time: 547.436947(s), Recall (@2: 0.1423, @5: 0.2251, @10: 0.3019), NDCG (@2: 0.1260, @5: 0.1632, @10: 0.1880)

Train epoch:49, time: 547.436947(s), rec_loss: 4.6638, tra_kl_loss: 6.2908, time_kl_loss: 4.6715, dis_kl_loss: 4.6705, contra_loss: 11834.9888
Test epoch:49, time: 558.705604(s), Recall (@2: 0.1496, @5: 0.2303, @10: 0.3025), NDCG (@2: 0.1309, @5: 0.1667, @10: 0.1900)

Train epoch:50, time: 558.705604(s), rec_loss: 4.6559, tra_kl_loss: 6.2629, time_kl_loss: 4.6557, dis_kl_loss: 4.6529, contra_loss: 11929.0952
Test epoch:50, time: 569.898636(s), Recall (@2: 0.1468, @5: 0.2294, @10: 0.3023), NDCG (@2: 0.1293, @5: 0.1662, @10: 0.1897)
