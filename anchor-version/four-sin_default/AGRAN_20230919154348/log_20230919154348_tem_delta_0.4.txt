dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:3
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.4
dis_delta:0.0
valid_epoch:1
device:cuda:3
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0958, tra_kl_loss: 6.5883, time_kl_loss: 6.1966, dis_kl_loss: 6.0514, contra_loss: 15410.5053
Test epoch:1, time: 13.966730(s), Recall (@2: 0.1097, @5: 0.1639, @10: 0.2199), NDCG (@2: 0.0967, @5: 0.1208, @10: 0.1388)

Train epoch:2, time: 13.966730(s), rec_loss: 7.3407, tra_kl_loss: 7.0776, time_kl_loss: 8.5404, dis_kl_loss: 5.8540, contra_loss: 25140.9157
Test epoch:2, time: 27.155510(s), Recall (@2: 0.1102, @5: 0.1953, @10: 0.2536), NDCG (@2: 0.0976, @5: 0.1353, @10: 0.1543)

Train epoch:3, time: 27.155510(s), rec_loss: 6.7952, tra_kl_loss: 6.8068, time_kl_loss: 6.0594, dis_kl_loss: 5.2579, contra_loss: 26204.6299
Test epoch:3, time: 40.192074(s), Recall (@2: 0.1136, @5: 0.1874, @10: 0.2607), NDCG (@2: 0.0989, @5: 0.1319, @10: 0.1555)

Train epoch:4, time: 40.192074(s), rec_loss: 6.4138, tra_kl_loss: 6.5143, time_kl_loss: 4.9729, dis_kl_loss: 5.0733, contra_loss: 26985.4651
Test epoch:4, time: 53.507511(s), Recall (@2: 0.1251, @5: 0.2066, @10: 0.2788), NDCG (@2: 0.1071, @5: 0.1437, @10: 0.1671)

Train epoch:5, time: 53.507511(s), rec_loss: 6.1464, tra_kl_loss: 6.4261, time_kl_loss: 4.1071, dis_kl_loss: 4.9603, contra_loss: 27292.7993
Test epoch:5, time: 66.739518(s), Recall (@2: 0.1205, @5: 0.2022, @10: 0.2766), NDCG (@2: 0.1049, @5: 0.1416, @10: 0.1658)

Train epoch:6, time: 66.739518(s), rec_loss: 5.9498, tra_kl_loss: 6.3509, time_kl_loss: 4.0504, dis_kl_loss: 4.9014, contra_loss: 25366.9573
Test epoch:6, time: 80.166670(s), Recall (@2: 0.1307, @5: 0.2135, @10: 0.2913), NDCG (@2: 0.1132, @5: 0.1505, @10: 0.1757)

Train epoch:7, time: 80.166670(s), rec_loss: 5.7936, tra_kl_loss: 6.4008, time_kl_loss: 3.5591, dis_kl_loss: 4.8744, contra_loss: 24609.6573
Test epoch:7, time: 93.785672(s), Recall (@2: 0.1356, @5: 0.2227, @10: 0.3021), NDCG (@2: 0.1162, @5: 0.1556, @10: 0.1812)

Train epoch:8, time: 93.785672(s), rec_loss: 5.6623, tra_kl_loss: 6.4457, time_kl_loss: 3.3392, dis_kl_loss: 4.8666, contra_loss: 23822.0955
Test epoch:8, time: 107.602347(s), Recall (@2: 0.1436, @5: 0.2298, @10: 0.3042), NDCG (@2: 0.1225, @5: 0.1611, @10: 0.1853)

Train epoch:9, time: 107.602347(s), rec_loss: 5.5592, tra_kl_loss: 6.3174, time_kl_loss: 3.0207, dis_kl_loss: 4.8341, contra_loss: 22678.0384
Test epoch:9, time: 121.115432(s), Recall (@2: 0.1438, @5: 0.2305, @10: 0.3055), NDCG (@2: 0.1234, @5: 0.1622, @10: 0.1864)

Train epoch:10, time: 121.115432(s), rec_loss: 5.4616, tra_kl_loss: 6.2900, time_kl_loss: 2.8929, dis_kl_loss: 4.8442, contra_loss: 21382.9093
Test epoch:10, time: 134.683996(s), Recall (@2: 0.1466, @5: 0.2354, @10: 0.3081), NDCG (@2: 0.1256, @5: 0.1657, @10: 0.1892)

Train epoch:11, time: 134.683996(s), rec_loss: 5.3848, tra_kl_loss: 6.3513, time_kl_loss: 2.9209, dis_kl_loss: 4.7977, contra_loss: 21095.6757
Test epoch:11, time: 148.272997(s), Recall (@2: 0.1481, @5: 0.2350, @10: 0.3092), NDCG (@2: 0.1270, @5: 0.1662, @10: 0.1902)

Train epoch:12, time: 148.272997(s), rec_loss: 5.3271, tra_kl_loss: 6.2710, time_kl_loss: 2.8694, dis_kl_loss: 4.8141, contra_loss: 19828.1218
Test epoch:12, time: 162.000067(s), Recall (@2: 0.1490, @5: 0.2339, @10: 0.3064), NDCG (@2: 0.1277, @5: 0.1659, @10: 0.1892)

Train epoch:13, time: 162.000067(s), rec_loss: 5.2723, tra_kl_loss: 6.2824, time_kl_loss: 2.8081, dis_kl_loss: 4.8050, contra_loss: 19045.1995
Test epoch:13, time: 175.580263(s), Recall (@2: 0.1531, @5: 0.2428, @10: 0.3217), NDCG (@2: 0.1308, @5: 0.1714, @10: 0.1969)

Train epoch:14, time: 175.580263(s), rec_loss: 5.2261, tra_kl_loss: 6.2815, time_kl_loss: 2.8472, dis_kl_loss: 4.7843, contra_loss: 19031.0052
Test epoch:14, time: 189.093876(s), Recall (@2: 0.1486, @5: 0.2380, @10: 0.3088), NDCG (@2: 0.1272, @5: 0.1672, @10: 0.1899)

Train epoch:15, time: 189.093876(s), rec_loss: 5.1821, tra_kl_loss: 6.2521, time_kl_loss: 2.7662, dis_kl_loss: 4.7626, contra_loss: 18034.4490
Test epoch:15, time: 202.785919(s), Recall (@2: 0.1507, @5: 0.2374, @10: 0.3098), NDCG (@2: 0.1296, @5: 0.1683, @10: 0.1917)

Train epoch:16, time: 202.785919(s), rec_loss: 5.1494, tra_kl_loss: 6.2021, time_kl_loss: 2.7352, dis_kl_loss: 4.8002, contra_loss: 16967.3981
Test epoch:16, time: 216.346954(s), Recall (@2: 0.1533, @5: 0.2404, @10: 0.3122), NDCG (@2: 0.1317, @5: 0.1706, @10: 0.1938)

Train epoch:17, time: 216.346954(s), rec_loss: 5.1140, tra_kl_loss: 6.2443, time_kl_loss: 2.8798, dis_kl_loss: 4.7551, contra_loss: 16288.6942
Test epoch:17, time: 229.825738(s), Recall (@2: 0.1555, @5: 0.2449, @10: 0.3191), NDCG (@2: 0.1337, @5: 0.1740, @10: 0.1981)

Train epoch:18, time: 229.825738(s), rec_loss: 5.0892, tra_kl_loss: 6.2778, time_kl_loss: 2.6141, dis_kl_loss: 4.7775, contra_loss: 16110.9582
Test epoch:18, time: 243.346824(s), Recall (@2: 0.1535, @5: 0.2370, @10: 0.3077), NDCG (@2: 0.1324, @5: 0.1699, @10: 0.1927)

Train epoch:19, time: 243.346824(s), rec_loss: 5.0626, tra_kl_loss: 6.1782, time_kl_loss: 2.6349, dis_kl_loss: 4.7632, contra_loss: 15035.5105
Test epoch:19, time: 256.906937(s), Recall (@2: 0.1570, @5: 0.2469, @10: 0.3236), NDCG (@2: 0.1358, @5: 0.1760, @10: 0.2008)

Train epoch:20, time: 256.906937(s), rec_loss: 5.0441, tra_kl_loss: 6.2397, time_kl_loss: 2.5307, dis_kl_loss: 4.7628, contra_loss: 15044.9990
Test epoch:20, time: 271.155237(s), Recall (@2: 0.1522, @5: 0.2408, @10: 0.3122), NDCG (@2: 0.1320, @5: 0.1717, @10: 0.1948)

Train epoch:21, time: 271.155237(s), rec_loss: 5.0136, tra_kl_loss: 6.2646, time_kl_loss: 2.4583, dis_kl_loss: 4.7542, contra_loss: 14675.9947
Test epoch:21, time: 284.811145(s), Recall (@2: 0.1578, @5: 0.2458, @10: 0.3213), NDCG (@2: 0.1364, @5: 0.1758, @10: 0.2001)

Train epoch:22, time: 284.811145(s), rec_loss: 4.9961, tra_kl_loss: 6.2218, time_kl_loss: 2.6894, dis_kl_loss: 4.7318, contra_loss: 13697.1097
Test epoch:22, time: 298.312592(s), Recall (@2: 0.1662, @5: 0.2508, @10: 0.3277), NDCG (@2: 0.1436, @5: 0.1814, @10: 0.2064)

Train epoch:23, time: 298.312592(s), rec_loss: 4.9860, tra_kl_loss: 6.3082, time_kl_loss: 2.6857, dis_kl_loss: 4.7553, contra_loss: 13924.9910
Test epoch:23, time: 311.770719(s), Recall (@2: 0.1516, @5: 0.2361, @10: 0.3150), NDCG (@2: 0.1316, @5: 0.1696, @10: 0.1949)

Train epoch:24, time: 311.770719(s), rec_loss: 4.9577, tra_kl_loss: 6.2324, time_kl_loss: 2.5411, dis_kl_loss: 4.7537, contra_loss: 13210.8125
Test epoch:24, time: 325.603021(s), Recall (@2: 0.1555, @5: 0.2488, @10: 0.3210), NDCG (@2: 0.1344, @5: 0.1765, @10: 0.1997)

Train epoch:25, time: 325.603021(s), rec_loss: 4.9462, tra_kl_loss: 6.3982, time_kl_loss: 2.5021, dis_kl_loss: 4.7534, contra_loss: 13357.8722
Test epoch:25, time: 338.826242(s), Recall (@2: 0.1561, @5: 0.2475, @10: 0.3208), NDCG (@2: 0.1353, @5: 0.1766, @10: 0.2003)

Train epoch:26, time: 338.826242(s), rec_loss: 4.9312, tra_kl_loss: 6.2227, time_kl_loss: 2.5373, dis_kl_loss: 4.7377, contra_loss: 12508.6407
Test epoch:26, time: 352.419069(s), Recall (@2: 0.1455, @5: 0.2309, @10: 0.2958), NDCG (@2: 0.1261, @5: 0.1645, @10: 0.1854)

Train epoch:27, time: 352.419069(s), rec_loss: 4.9218, tra_kl_loss: 6.2618, time_kl_loss: 2.4703, dis_kl_loss: 4.6958, contra_loss: 12108.5881
Test epoch:27, time: 365.942969(s), Recall (@2: 0.1749, @5: 0.2648, @10: 0.3383), NDCG (@2: 0.1494, @5: 0.1899, @10: 0.2137)

Train epoch:28, time: 365.942969(s), rec_loss: 4.9122, tra_kl_loss: 6.2980, time_kl_loss: 2.4306, dis_kl_loss: 4.7584, contra_loss: 11878.8766
Test epoch:28, time: 379.458640(s), Recall (@2: 0.1531, @5: 0.2376, @10: 0.3092), NDCG (@2: 0.1328, @5: 0.1709, @10: 0.1941)

Train epoch:29, time: 379.458640(s), rec_loss: 4.8925, tra_kl_loss: 6.2528, time_kl_loss: 2.5513, dis_kl_loss: 4.7298, contra_loss: 11448.1020
Test epoch:29, time: 392.963395(s), Recall (@2: 0.1576, @5: 0.2454, @10: 0.3169), NDCG (@2: 0.1374, @5: 0.1771, @10: 0.2003)

Train epoch:30, time: 392.963395(s), rec_loss: 4.8807, tra_kl_loss: 6.3077, time_kl_loss: 2.6933, dis_kl_loss: 4.7380, contra_loss: 11584.1166
Test epoch:30, time: 406.337087(s), Recall (@2: 0.1602, @5: 0.2439, @10: 0.3245), NDCG (@2: 0.1393, @5: 0.1772, @10: 0.2033)

Train epoch:31, time: 406.337087(s), rec_loss: 4.8711, tra_kl_loss: 6.2584, time_kl_loss: 2.5272, dis_kl_loss: 4.7333, contra_loss: 11169.9634
Test epoch:31, time: 419.379643(s), Recall (@2: 0.1552, @5: 0.2417, @10: 0.3133), NDCG (@2: 0.1360, @5: 0.1746, @10: 0.1977)

Train epoch:32, time: 419.379643(s), rec_loss: 4.8591, tra_kl_loss: 6.2817, time_kl_loss: 2.5506, dis_kl_loss: 4.7718, contra_loss: 11047.0943
Test epoch:32, time: 432.783009(s), Recall (@2: 0.1565, @5: 0.2432, @10: 0.3141), NDCG (@2: 0.1366, @5: 0.1757, @10: 0.1985)

Train epoch:33, time: 432.783009(s), rec_loss: 4.8477, tra_kl_loss: 6.2961, time_kl_loss: 2.4019, dis_kl_loss: 4.7387, contra_loss: 10743.9899
Test epoch:33, time: 446.067999(s), Recall (@2: 0.1486, @5: 0.2372, @10: 0.3055), NDCG (@2: 0.1304, @5: 0.1702, @10: 0.1923)

Train epoch:34, time: 446.067999(s), rec_loss: 4.8421, tra_kl_loss: 6.2007, time_kl_loss: 2.6811, dis_kl_loss: 4.7383, contra_loss: 10278.2622
Test epoch:34, time: 459.274355(s), Recall (@2: 0.1505, @5: 0.2374, @10: 0.3079), NDCG (@2: 0.1315, @5: 0.1705, @10: 0.1931)

Train epoch:35, time: 459.274355(s), rec_loss: 4.8275, tra_kl_loss: 6.2728, time_kl_loss: 2.5133, dis_kl_loss: 4.7280, contra_loss: 9808.2500
Test epoch:35, time: 472.590158(s), Recall (@2: 0.1593, @5: 0.2462, @10: 0.3163), NDCG (@2: 0.1393, @5: 0.1782, @10: 0.2008)

Train epoch:36, time: 472.590158(s), rec_loss: 4.8189, tra_kl_loss: 6.2394, time_kl_loss: 2.5082, dis_kl_loss: 4.7339, contra_loss: 9763.3885
Test epoch:36, time: 485.928152(s), Recall (@2: 0.1572, @5: 0.2329, @10: 0.3126), NDCG (@2: 0.1370, @5: 0.1712, @10: 0.1970)

Train epoch:37, time: 485.928152(s), rec_loss: 4.8087, tra_kl_loss: 6.1286, time_kl_loss: 2.6617, dis_kl_loss: 4.7168, contra_loss: 9004.7593
Test epoch:37, time: 499.425647(s), Recall (@2: 0.1501, @5: 0.2324, @10: 0.3077), NDCG (@2: 0.1305, @5: 0.1676, @10: 0.1917)

Train epoch:38, time: 499.425647(s), rec_loss: 4.8035, tra_kl_loss: 6.3351, time_kl_loss: 2.5583, dis_kl_loss: 4.7309, contra_loss: 9385.6727
Test epoch:38, time: 513.058843(s), Recall (@2: 0.1557, @5: 0.2318, @10: 0.3029), NDCG (@2: 0.1356, @5: 0.1693, @10: 0.1923)

Train epoch:39, time: 513.058843(s), rec_loss: 4.7851, tra_kl_loss: 6.2663, time_kl_loss: 2.6771, dis_kl_loss: 4.7622, contra_loss: 8856.9989
Test epoch:39, time: 526.652694(s), Recall (@2: 0.1516, @5: 0.2374, @10: 0.3116), NDCG (@2: 0.1334, @5: 0.1718, @10: 0.1958)

Train epoch:40, time: 526.652694(s), rec_loss: 4.7794, tra_kl_loss: 6.3130, time_kl_loss: 2.5206, dis_kl_loss: 4.7376, contra_loss: 8865.1609
Test epoch:40, time: 540.464816(s), Recall (@2: 0.1486, @5: 0.2234, @10: 0.2984), NDCG (@2: 0.1303, @5: 0.1637, @10: 0.1881)

Train epoch:41, time: 540.464816(s), rec_loss: 4.7718, tra_kl_loss: 6.2910, time_kl_loss: 2.5058, dis_kl_loss: 4.7350, contra_loss: 8691.9644
Test epoch:41, time: 553.994213(s), Recall (@2: 0.1509, @5: 0.2413, @10: 0.3085), NDCG (@2: 0.1333, @5: 0.1735, @10: 0.1953)

Train epoch:42, time: 553.994213(s), rec_loss: 4.7728, tra_kl_loss: 6.3361, time_kl_loss: 2.5185, dis_kl_loss: 4.7500, contra_loss: 8604.6536
Test epoch:42, time: 568.264735(s), Recall (@2: 0.1529, @5: 0.2391, @10: 0.3135), NDCG (@2: 0.1331, @5: 0.1721, @10: 0.1961)

Train epoch:43, time: 568.264735(s), rec_loss: 4.7546, tra_kl_loss: 6.2538, time_kl_loss: 2.6350, dis_kl_loss: 4.7123, contra_loss: 8307.7515
Test epoch:43, time: 581.714600(s), Recall (@2: 0.1501, @5: 0.2316, @10: 0.3044), NDCG (@2: 0.1330, @5: 0.1695, @10: 0.1932)

Train epoch:44, time: 581.714600(s), rec_loss: 4.7466, tra_kl_loss: 6.3126, time_kl_loss: 2.5846, dis_kl_loss: 4.7277, contra_loss: 8307.5469
Test epoch:44, time: 595.301711(s), Recall (@2: 0.1529, @5: 0.2331, @10: 0.3107), NDCG (@2: 0.1335, @5: 0.1692, @10: 0.1943)

Train epoch:45, time: 595.301711(s), rec_loss: 4.7439, tra_kl_loss: 6.2838, time_kl_loss: 2.5912, dis_kl_loss: 4.7178, contra_loss: 8153.7721
Test epoch:45, time: 608.765157(s), Recall (@2: 0.1509, @5: 0.2350, @10: 0.3116), NDCG (@2: 0.1338, @5: 0.1716, @10: 0.1963)

Train epoch:46, time: 608.765157(s), rec_loss: 4.7361, tra_kl_loss: 6.1458, time_kl_loss: 2.5512, dis_kl_loss: 4.7557, contra_loss: 8016.0553
Test epoch:46, time: 621.994541(s), Recall (@2: 0.1527, @5: 0.2342, @10: 0.3144), NDCG (@2: 0.1334, @5: 0.1699, @10: 0.1956)

Train epoch:47, time: 621.994541(s), rec_loss: 4.7282, tra_kl_loss: 6.2575, time_kl_loss: 2.5683, dis_kl_loss: 4.7473, contra_loss: 7926.9074
Test epoch:47, time: 634.236920(s), Recall (@2: 0.1557, @5: 0.2415, @10: 0.3157), NDCG (@2: 0.1377, @5: 0.1766, @10: 0.2006)

Train epoch:48, time: 634.236920(s), rec_loss: 4.7196, tra_kl_loss: 6.3442, time_kl_loss: 2.6557, dis_kl_loss: 4.7303, contra_loss: 7957.4622
Test epoch:48, time: 647.084650(s), Recall (@2: 0.1576, @5: 0.2391, @10: 0.3100), NDCG (@2: 0.1378, @5: 0.1739, @10: 0.1969)

Train epoch:49, time: 647.084650(s), rec_loss: 4.7132, tra_kl_loss: 6.2237, time_kl_loss: 2.7243, dis_kl_loss: 4.7089, contra_loss: 7638.5514
Test epoch:49, time: 659.111070(s), Recall (@2: 0.1555, @5: 0.2402, @10: 0.3150), NDCG (@2: 0.1371, @5: 0.1748, @10: 0.1990)

Train epoch:50, time: 659.111070(s), rec_loss: 4.7046, tra_kl_loss: 6.1913, time_kl_loss: 2.6864, dis_kl_loss: 4.7190, contra_loss: 7719.6901
Test epoch:50, time: 670.273097(s), Recall (@2: 0.1548, @5: 0.2370, @10: 0.3103), NDCG (@2: 0.1369, @5: 0.1736, @10: 0.1974)
