dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:1
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.4
dis_delta:0.2
valid_epoch:1
device:cuda:1
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0959, tra_kl_loss: 6.5860, time_kl_loss: 6.1942, dis_kl_loss: 6.0953, contra_loss: 15207.5977
Test epoch:1, time: 16.362859(s), Recall (@2: 0.1097, @5: 0.1645, @10: 0.2197), NDCG (@2: 0.0965, @5: 0.1210, @10: 0.1387)

Train epoch:2, time: 16.362859(s), rec_loss: 7.3405, tra_kl_loss: 7.0682, time_kl_loss: 8.7899, dis_kl_loss: 6.8677, contra_loss: 23832.6935
Test epoch:2, time: 34.139972(s), Recall (@2: 0.1076, @5: 0.1930, @10: 0.2531), NDCG (@2: 0.0953, @5: 0.1331, @10: 0.1527)

Train epoch:3, time: 34.139972(s), rec_loss: 6.7915, tra_kl_loss: 6.8210, time_kl_loss: 6.9609, dis_kl_loss: 5.9567, contra_loss: 24677.0941
Test epoch:3, time: 52.046839(s), Recall (@2: 0.1149, @5: 0.1871, @10: 0.2620), NDCG (@2: 0.0995, @5: 0.1316, @10: 0.1556)

Train epoch:4, time: 52.046839(s), rec_loss: 6.4039, tra_kl_loss: 6.5096, time_kl_loss: 5.9462, dis_kl_loss: 5.3115, contra_loss: 25414.5038
Test epoch:4, time: 70.085948(s), Recall (@2: 0.1255, @5: 0.2102, @10: 0.2809), NDCG (@2: 0.1082, @5: 0.1463, @10: 0.1691)

Train epoch:5, time: 70.085948(s), rec_loss: 6.1369, tra_kl_loss: 6.4269, time_kl_loss: 4.8735, dis_kl_loss: 4.9402, contra_loss: 26366.0266
Test epoch:5, time: 88.068533(s), Recall (@2: 0.1210, @5: 0.2007, @10: 0.2730), NDCG (@2: 0.1054, @5: 0.1412, @10: 0.1646)

Train epoch:6, time: 88.068533(s), rec_loss: 5.9408, tra_kl_loss: 6.3515, time_kl_loss: 4.6989, dis_kl_loss: 4.6019, contra_loss: 24732.9752
Test epoch:6, time: 106.188561(s), Recall (@2: 0.1317, @5: 0.2158, @10: 0.2902), NDCG (@2: 0.1145, @5: 0.1525, @10: 0.1766)

Train epoch:7, time: 106.188561(s), rec_loss: 5.7848, tra_kl_loss: 6.3817, time_kl_loss: 4.2176, dis_kl_loss: 4.4894, contra_loss: 23723.2534
Test epoch:7, time: 124.330610(s), Recall (@2: 0.1348, @5: 0.2240, @10: 0.3006), NDCG (@2: 0.1164, @5: 0.1565, @10: 0.1811)

Train epoch:8, time: 124.330610(s), rec_loss: 5.6542, tra_kl_loss: 6.4628, time_kl_loss: 3.6913, dis_kl_loss: 4.3454, contra_loss: 23356.0289
Test epoch:8, time: 142.548491(s), Recall (@2: 0.1423, @5: 0.2305, @10: 0.3038), NDCG (@2: 0.1219, @5: 0.1612, @10: 0.1848)

Train epoch:9, time: 142.548491(s), rec_loss: 5.5582, tra_kl_loss: 6.3190, time_kl_loss: 3.5082, dis_kl_loss: 4.1851, contra_loss: 22356.8787
Test epoch:9, time: 160.551634(s), Recall (@2: 0.1434, @5: 0.2281, @10: 0.3021), NDCG (@2: 0.1230, @5: 0.1610, @10: 0.1850)

Train epoch:10, time: 160.551634(s), rec_loss: 5.4621, tra_kl_loss: 6.2888, time_kl_loss: 3.1672, dis_kl_loss: 4.1718, contra_loss: 21002.8627
Test epoch:10, time: 178.338072(s), Recall (@2: 0.1460, @5: 0.2357, @10: 0.3055), NDCG (@2: 0.1250, @5: 0.1653, @10: 0.1880)

Train epoch:11, time: 178.338072(s), rec_loss: 5.3904, tra_kl_loss: 6.3860, time_kl_loss: 3.2521, dis_kl_loss: 4.0064, contra_loss: 21352.5828
Test epoch:11, time: 196.376865(s), Recall (@2: 0.1440, @5: 0.2335, @10: 0.2999), NDCG (@2: 0.1231, @5: 0.1631, @10: 0.1846)

Train epoch:12, time: 196.376865(s), rec_loss: 5.3346, tra_kl_loss: 6.2359, time_kl_loss: 3.1024, dis_kl_loss: 3.9360, contra_loss: 19640.9027
Test epoch:12, time: 214.576627(s), Recall (@2: 0.1490, @5: 0.2311, @10: 0.3057), NDCG (@2: 0.1281, @5: 0.1650, @10: 0.1891)

Train epoch:13, time: 214.576627(s), rec_loss: 5.2825, tra_kl_loss: 6.2915, time_kl_loss: 2.7923, dis_kl_loss: 3.8432, contra_loss: 19175.3797
Test epoch:13, time: 232.629347(s), Recall (@2: 0.1494, @5: 0.2423, @10: 0.3137), NDCG (@2: 0.1287, @5: 0.1707, @10: 0.1938)

Train epoch:14, time: 232.629347(s), rec_loss: 5.2385, tra_kl_loss: 6.2551, time_kl_loss: 2.8573, dis_kl_loss: 3.9318, contra_loss: 19144.8266
Test epoch:14, time: 250.642241(s), Recall (@2: 0.1468, @5: 0.2376, @10: 0.3085), NDCG (@2: 0.1275, @5: 0.1683, @10: 0.1912)

Train epoch:15, time: 250.642241(s), rec_loss: 5.1977, tra_kl_loss: 6.2809, time_kl_loss: 2.9569, dis_kl_loss: 3.8013, contra_loss: 18288.2440
Test epoch:15, time: 268.875025(s), Recall (@2: 0.1492, @5: 0.2376, @10: 0.3047), NDCG (@2: 0.1288, @5: 0.1684, @10: 0.1902)

Train epoch:16, time: 268.875025(s), rec_loss: 5.1650, tra_kl_loss: 6.1920, time_kl_loss: 2.8462, dis_kl_loss: 3.8990, contra_loss: 17163.4977
Test epoch:16, time: 287.118877(s), Recall (@2: 0.1511, @5: 0.2411, @10: 0.3118), NDCG (@2: 0.1302, @5: 0.1708, @10: 0.1936)

Train epoch:17, time: 287.118877(s), rec_loss: 5.1303, tra_kl_loss: 6.2268, time_kl_loss: 2.7557, dis_kl_loss: 3.7494, contra_loss: 16253.6495
Test epoch:17, time: 305.116957(s), Recall (@2: 0.1567, @5: 0.2488, @10: 0.3200), NDCG (@2: 0.1340, @5: 0.1754, @10: 0.1985)

Train epoch:18, time: 305.116957(s), rec_loss: 5.1085, tra_kl_loss: 6.2979, time_kl_loss: 2.8834, dis_kl_loss: 3.9158, contra_loss: 16299.8001
Test epoch:18, time: 323.104914(s), Recall (@2: 0.1494, @5: 0.2350, @10: 0.3072), NDCG (@2: 0.1316, @5: 0.1702, @10: 0.1934)

Train epoch:19, time: 323.104914(s), rec_loss: 5.0832, tra_kl_loss: 6.1688, time_kl_loss: 2.8467, dis_kl_loss: 3.7551, contra_loss: 14914.3554
Test epoch:19, time: 340.950042(s), Recall (@2: 0.1533, @5: 0.2458, @10: 0.3195), NDCG (@2: 0.1330, @5: 0.1748, @10: 0.1987)

Train epoch:20, time: 340.950042(s), rec_loss: 5.0651, tra_kl_loss: 6.2673, time_kl_loss: 2.6212, dis_kl_loss: 3.7295, contra_loss: 14887.3841
Test epoch:20, time: 358.991029(s), Recall (@2: 0.1503, @5: 0.2411, @10: 0.3107), NDCG (@2: 0.1308, @5: 0.1714, @10: 0.1940)

Train epoch:21, time: 358.991029(s), rec_loss: 5.0362, tra_kl_loss: 6.2645, time_kl_loss: 2.4678, dis_kl_loss: 3.8244, contra_loss: 14335.2677
Test epoch:21, time: 376.859867(s), Recall (@2: 0.1567, @5: 0.2454, @10: 0.3223), NDCG (@2: 0.1370, @5: 0.1766, @10: 0.2014)

Train epoch:22, time: 376.859867(s), rec_loss: 5.0195, tra_kl_loss: 6.2152, time_kl_loss: 2.6399, dis_kl_loss: 3.7917, contra_loss: 13317.4797
Test epoch:22, time: 395.021230(s), Recall (@2: 0.1626, @5: 0.2531, @10: 0.3320), NDCG (@2: 0.1409, @5: 0.1816, @10: 0.2071)

Train epoch:23, time: 395.021230(s), rec_loss: 5.0122, tra_kl_loss: 6.3261, time_kl_loss: 2.7384, dis_kl_loss: 3.8375, contra_loss: 13516.0742
Test epoch:23, time: 412.925023(s), Recall (@2: 0.1498, @5: 0.2372, @10: 0.3077), NDCG (@2: 0.1296, @5: 0.1687, @10: 0.1914)

Train epoch:24, time: 412.925023(s), rec_loss: 4.9844, tra_kl_loss: 6.2271, time_kl_loss: 2.5228, dis_kl_loss: 3.7896, contra_loss: 12753.6328
Test epoch:24, time: 430.712664(s), Recall (@2: 0.1565, @5: 0.2417, @10: 0.3126), NDCG (@2: 0.1350, @5: 0.1732, @10: 0.1960)

Train epoch:25, time: 430.712664(s), rec_loss: 4.9747, tra_kl_loss: 6.3840, time_kl_loss: 2.3733, dis_kl_loss: 3.7333, contra_loss: 13024.8031
Test epoch:25, time: 448.687923(s), Recall (@2: 0.1589, @5: 0.2473, @10: 0.3187), NDCG (@2: 0.1373, @5: 0.1769, @10: 0.1999)

Train epoch:26, time: 448.687923(s), rec_loss: 4.9617, tra_kl_loss: 6.2233, time_kl_loss: 2.3869, dis_kl_loss: 3.6832, contra_loss: 12234.3271
Test epoch:26, time: 466.658482(s), Recall (@2: 0.1419, @5: 0.2275, @10: 0.3038), NDCG (@2: 0.1246, @5: 0.1632, @10: 0.1878)

Train epoch:27, time: 466.658482(s), rec_loss: 4.9505, tra_kl_loss: 6.2783, time_kl_loss: 2.6490, dis_kl_loss: 3.6330, contra_loss: 11989.9441
Test epoch:27, time: 484.471813(s), Recall (@2: 0.1688, @5: 0.2618, @10: 0.3383), NDCG (@2: 0.1455, @5: 0.1872, @10: 0.2119)

Train epoch:28, time: 484.471813(s), rec_loss: 4.9437, tra_kl_loss: 6.3201, time_kl_loss: 2.4644, dis_kl_loss: 3.8342, contra_loss: 11874.7360
Test epoch:28, time: 502.433706(s), Recall (@2: 0.1535, @5: 0.2395, @10: 0.3144), NDCG (@2: 0.1342, @5: 0.1726, @10: 0.1968)

Train epoch:29, time: 502.433706(s), rec_loss: 4.9241, tra_kl_loss: 6.2316, time_kl_loss: 2.5866, dis_kl_loss: 3.7058, contra_loss: 11425.2534
Test epoch:29, time: 520.275773(s), Recall (@2: 0.1587, @5: 0.2451, @10: 0.3178), NDCG (@2: 0.1377, @5: 0.1767, @10: 0.2001)

Train epoch:30, time: 520.275773(s), rec_loss: 4.9109, tra_kl_loss: 6.3274, time_kl_loss: 2.7272, dis_kl_loss: 3.7300, contra_loss: 11389.6625
Test epoch:30, time: 537.871699(s), Recall (@2: 0.1585, @5: 0.2419, @10: 0.3195), NDCG (@2: 0.1381, @5: 0.1757, @10: 0.2007)

Train epoch:31, time: 537.871699(s), rec_loss: 4.9021, tra_kl_loss: 6.2923, time_kl_loss: 2.4806, dis_kl_loss: 3.8164, contra_loss: 10996.4492
Test epoch:31, time: 555.971684(s), Recall (@2: 0.1546, @5: 0.2348, @10: 0.3182), NDCG (@2: 0.1347, @5: 0.1709, @10: 0.1979)

Train epoch:32, time: 555.971684(s), rec_loss: 4.8923, tra_kl_loss: 6.3171, time_kl_loss: 2.5657, dis_kl_loss: 3.7250, contra_loss: 10901.0883
Test epoch:32, time: 573.837582(s), Recall (@2: 0.1516, @5: 0.2374, @10: 0.3135), NDCG (@2: 0.1323, @5: 0.1709, @10: 0.1954)

Train epoch:33, time: 573.837582(s), rec_loss: 4.8841, tra_kl_loss: 6.2899, time_kl_loss: 2.3721, dis_kl_loss: 3.7412, contra_loss: 10547.8671
Test epoch:33, time: 591.716641(s), Recall (@2: 0.1481, @5: 0.2370, @10: 0.3096), NDCG (@2: 0.1297, @5: 0.1696, @10: 0.1931)

Train epoch:34, time: 591.716641(s), rec_loss: 4.8780, tra_kl_loss: 6.2006, time_kl_loss: 2.6990, dis_kl_loss: 3.7204, contra_loss: 10133.8041
Test epoch:34, time: 609.777707(s), Recall (@2: 0.1473, @5: 0.2337, @10: 0.3083), NDCG (@2: 0.1291, @5: 0.1684, @10: 0.1924)

Train epoch:35, time: 609.777707(s), rec_loss: 4.8614, tra_kl_loss: 6.2588, time_kl_loss: 2.4958, dis_kl_loss: 3.7146, contra_loss: 9878.5949
Test epoch:35, time: 628.482504(s), Recall (@2: 0.1611, @5: 0.2451, @10: 0.3241), NDCG (@2: 0.1410, @5: 0.1785, @10: 0.2039)

Train epoch:36, time: 628.482504(s), rec_loss: 4.8580, tra_kl_loss: 6.2645, time_kl_loss: 2.3785, dis_kl_loss: 3.7559, contra_loss: 10039.8582
Test epoch:36, time: 646.101573(s), Recall (@2: 0.1505, @5: 0.2342, @10: 0.3094), NDCG (@2: 0.1328, @5: 0.1703, @10: 0.1946)

Train epoch:37, time: 646.101573(s), rec_loss: 4.8438, tra_kl_loss: 6.1430, time_kl_loss: 2.5666, dis_kl_loss: 3.7265, contra_loss: 8994.3613
Test epoch:37, time: 664.674102(s), Recall (@2: 0.1511, @5: 0.2290, @10: 0.3057), NDCG (@2: 0.1322, @5: 0.1675, @10: 0.1923)

Train epoch:38, time: 664.674102(s), rec_loss: 4.8415, tra_kl_loss: 6.3397, time_kl_loss: 2.4156, dis_kl_loss: 3.6821, contra_loss: 9441.7987
Test epoch:38, time: 682.590582(s), Recall (@2: 0.1539, @5: 0.2285, @10: 0.3049), NDCG (@2: 0.1347, @5: 0.1681, @10: 0.1929)

Train epoch:39, time: 682.590582(s), rec_loss: 4.8263, tra_kl_loss: 6.2516, time_kl_loss: 2.5616, dis_kl_loss: 3.7026, contra_loss: 8972.1547
Test epoch:39, time: 700.954825(s), Recall (@2: 0.1537, @5: 0.2398, @10: 0.3141), NDCG (@2: 0.1333, @5: 0.1718, @10: 0.1957)

Train epoch:40, time: 700.954825(s), rec_loss: 4.8215, tra_kl_loss: 6.2866, time_kl_loss: 2.4138, dis_kl_loss: 3.7521, contra_loss: 8693.4879
Test epoch:40, time: 719.316190(s), Recall (@2: 0.1458, @5: 0.2240, @10: 0.2984), NDCG (@2: 0.1262, @5: 0.1612, @10: 0.1851)

Train epoch:41, time: 719.316190(s), rec_loss: 4.8121, tra_kl_loss: 6.2788, time_kl_loss: 2.3527, dis_kl_loss: 3.8061, contra_loss: 8739.9741
Test epoch:41, time: 737.554357(s), Recall (@2: 0.1537, @5: 0.2400, @10: 0.3133), NDCG (@2: 0.1340, @5: 0.1725, @10: 0.1962)

Train epoch:42, time: 737.554357(s), rec_loss: 4.8119, tra_kl_loss: 6.3281, time_kl_loss: 2.4147, dis_kl_loss: 3.7786, contra_loss: 8648.4709
Test epoch:42, time: 756.225641(s), Recall (@2: 0.1524, @5: 0.2374, @10: 0.3163), NDCG (@2: 0.1337, @5: 0.1723, @10: 0.1976)

Train epoch:43, time: 756.225641(s), rec_loss: 4.7958, tra_kl_loss: 6.2948, time_kl_loss: 2.6062, dis_kl_loss: 3.7640, contra_loss: 8542.9839
Test epoch:43, time: 774.529537(s), Recall (@2: 0.1509, @5: 0.2357, @10: 0.3135), NDCG (@2: 0.1335, @5: 0.1717, @10: 0.1968)

Train epoch:44, time: 774.529537(s), rec_loss: 4.7924, tra_kl_loss: 6.3565, time_kl_loss: 2.5097, dis_kl_loss: 3.7018, contra_loss: 8444.0303
Test epoch:44, time: 793.224509(s), Recall (@2: 0.1498, @5: 0.2374, @10: 0.3152), NDCG (@2: 0.1313, @5: 0.1705, @10: 0.1956)

Train epoch:45, time: 793.224509(s), rec_loss: 4.7877, tra_kl_loss: 6.2593, time_kl_loss: 2.3899, dis_kl_loss: 3.7285, contra_loss: 8220.1153
Test epoch:45, time: 811.765859(s), Recall (@2: 0.1522, @5: 0.2374, @10: 0.3103), NDCG (@2: 0.1343, @5: 0.1726, @10: 0.1961)

Train epoch:46, time: 811.765859(s), rec_loss: 4.7810, tra_kl_loss: 6.1934, time_kl_loss: 2.3925, dis_kl_loss: 3.7648, contra_loss: 8138.2031
Test epoch:46, time: 830.210456(s), Recall (@2: 0.1473, @5: 0.2329, @10: 0.3135), NDCG (@2: 0.1301, @5: 0.1685, @10: 0.1945)

Train epoch:47, time: 830.210456(s), rec_loss: 4.7740, tra_kl_loss: 6.2892, time_kl_loss: 2.5251, dis_kl_loss: 3.7302, contra_loss: 7952.8412
Test epoch:47, time: 848.820686(s), Recall (@2: 0.1555, @5: 0.2372, @10: 0.3109), NDCG (@2: 0.1360, @5: 0.1724, @10: 0.1961)

Train epoch:48, time: 848.820686(s), rec_loss: 4.7637, tra_kl_loss: 6.3087, time_kl_loss: 2.4971, dis_kl_loss: 3.8453, contra_loss: 7972.3211
Test epoch:48, time: 867.383302(s), Recall (@2: 0.1542, @5: 0.2352, @10: 0.3111), NDCG (@2: 0.1346, @5: 0.1711, @10: 0.1956)

Train epoch:49, time: 867.383302(s), rec_loss: 4.7596, tra_kl_loss: 6.2560, time_kl_loss: 2.4034, dis_kl_loss: 3.7004, contra_loss: 7790.8438
Test epoch:49, time: 886.082112(s), Recall (@2: 0.1567, @5: 0.2417, @10: 0.3167), NDCG (@2: 0.1369, @5: 0.1750, @10: 0.1993)

Train epoch:50, time: 886.082112(s), rec_loss: 4.7501, tra_kl_loss: 6.1844, time_kl_loss: 2.4112, dis_kl_loss: 3.7799, contra_loss: 7840.3892
Test epoch:50, time: 903.496397(s), Recall (@2: 0.1509, @5: 0.2389, @10: 0.3100), NDCG (@2: 0.1327, @5: 0.1722, @10: 0.1952)
