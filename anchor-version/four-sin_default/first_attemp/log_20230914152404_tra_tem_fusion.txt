dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:70
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:1
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:0.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.0
dis_delta:0.0
valid_epoch:1
device:cuda:1
In total: 733441 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.2283, tra_kl_loss: 6.5874, time_kl_loss: 6.0350
Test epoch:1, time: 185.439722(s), Recall (@2: 0.0837, @5: 0.1401, @10: 0.1904), NDCG (@2: 0.0759, @5: 0.1010, @10: 0.1174)

Train epoch:2, time: 185.439722(s), rec_loss: 7.5119, tra_kl_loss: 6.8343, time_kl_loss: 6.2391
Test epoch:2, time: 196.747413(s), Recall (@2: 0.1141, @5: 0.1774, @10: 0.2363), NDCG (@2: 0.0999, @5: 0.1280, @10: 0.1470)

Train epoch:3, time: 196.747413(s), rec_loss: 6.9898, tra_kl_loss: 6.8932, time_kl_loss: 5.3801
Test epoch:3, time: 207.799432(s), Recall (@2: 0.1184, @5: 0.1772, @10: 0.2400), NDCG (@2: 0.1028, @5: 0.1293, @10: 0.1496)

Train epoch:4, time: 207.799432(s), rec_loss: 6.5686, tra_kl_loss: 6.5572, time_kl_loss: 5.0614
Test epoch:4, time: 218.735829(s), Recall (@2: 0.1182, @5: 0.1897, @10: 0.2525), NDCG (@2: 0.1020, @5: 0.1340, @10: 0.1542)

Train epoch:5, time: 218.735829(s), rec_loss: 6.2501, tra_kl_loss: 6.4773, time_kl_loss: 4.9501
Test epoch:5, time: 229.426988(s), Recall (@2: 0.1210, @5: 0.1947, @10: 0.2589), NDCG (@2: 0.1048, @5: 0.1379, @10: 0.1587)

Train epoch:6, time: 229.426988(s), rec_loss: 5.9926, tra_kl_loss: 6.5059, time_kl_loss: 4.9483
Test epoch:6, time: 240.447697(s), Recall (@2: 0.1332, @5: 0.2132, @10: 0.2788), NDCG (@2: 0.1146, @5: 0.1503, @10: 0.1714)

Train epoch:7, time: 240.447697(s), rec_loss: 5.7775, tra_kl_loss: 6.3821, time_kl_loss: 4.9041
Test epoch:7, time: 251.449777(s), Recall (@2: 0.1315, @5: 0.2102, @10: 0.2790), NDCG (@2: 0.1136, @5: 0.1487, @10: 0.1709)

Train epoch:8, time: 251.449777(s), rec_loss: 5.6096, tra_kl_loss: 6.4596, time_kl_loss: 4.8641
Test epoch:8, time: 262.451734(s), Recall (@2: 0.1404, @5: 0.2255, @10: 0.2971), NDCG (@2: 0.1212, @5: 0.1590, @10: 0.1822)

Train epoch:9, time: 262.451734(s), rec_loss: 5.4789, tra_kl_loss: 6.3684, time_kl_loss: 4.8592
Test epoch:9, time: 274.289712(s), Recall (@2: 0.1380, @5: 0.2270, @10: 0.2973), NDCG (@2: 0.1183, @5: 0.1583, @10: 0.1809)

Train epoch:10, time: 274.289712(s), rec_loss: 5.3717, tra_kl_loss: 6.4318, time_kl_loss: 4.8126
Test epoch:10, time: 285.393123(s), Recall (@2: 0.1412, @5: 0.2273, @10: 0.2943), NDCG (@2: 0.1213, @5: 0.1598, @10: 0.1813)

Train epoch:11, time: 285.393123(s), rec_loss: 5.2846, tra_kl_loss: 6.2505, time_kl_loss: 4.8032
Test epoch:11, time: 297.366152(s), Recall (@2: 0.1436, @5: 0.2283, @10: 0.2950), NDCG (@2: 0.1232, @5: 0.1611, @10: 0.1824)

Train epoch:12, time: 297.366152(s), rec_loss: 5.2139, tra_kl_loss: 6.3301, time_kl_loss: 4.8190
Test epoch:12, time: 308.253435(s), Recall (@2: 0.1490, @5: 0.2354, @10: 0.2999), NDCG (@2: 0.1272, @5: 0.1657, @10: 0.1867)

Train epoch:13, time: 308.253435(s), rec_loss: 5.1515, tra_kl_loss: 6.3010, time_kl_loss: 4.7829
Test epoch:13, time: 318.962895(s), Recall (@2: 0.1427, @5: 0.2311, @10: 0.3008), NDCG (@2: 0.1234, @5: 0.1628, @10: 0.1853)

Train epoch:14, time: 318.962895(s), rec_loss: 5.1002, tra_kl_loss: 6.3011, time_kl_loss: 4.7911
Test epoch:14, time: 329.509079(s), Recall (@2: 0.1490, @5: 0.2413, @10: 0.3187), NDCG (@2: 0.1279, @5: 0.1698, @10: 0.1946)

Train epoch:15, time: 329.509079(s), rec_loss: 5.0610, tra_kl_loss: 6.2400, time_kl_loss: 4.7599
Test epoch:15, time: 340.702823(s), Recall (@2: 0.1561, @5: 0.2434, @10: 0.3182), NDCG (@2: 0.1337, @5: 0.1729, @10: 0.1969)

Train epoch:16, time: 340.702823(s), rec_loss: 5.0210, tra_kl_loss: 6.2413, time_kl_loss: 4.7313
Test epoch:16, time: 351.869434(s), Recall (@2: 0.1529, @5: 0.2385, @10: 0.3109), NDCG (@2: 0.1331, @5: 0.1717, @10: 0.1950)

Train epoch:17, time: 351.869434(s), rec_loss: 4.9867, tra_kl_loss: 6.2243, time_kl_loss: 4.7257
Test epoch:17, time: 362.783653(s), Recall (@2: 0.1529, @5: 0.2367, @10: 0.3118), NDCG (@2: 0.1319, @5: 0.1697, @10: 0.1940)

Train epoch:18, time: 362.783653(s), rec_loss: 4.9606, tra_kl_loss: 6.2653, time_kl_loss: 4.7076
Test epoch:18, time: 373.624293(s), Recall (@2: 0.1561, @5: 0.2398, @10: 0.3150), NDCG (@2: 0.1340, @5: 0.1716, @10: 0.1958)

Train epoch:19, time: 373.624293(s), rec_loss: 4.9371, tra_kl_loss: 6.3279, time_kl_loss: 4.7215
Test epoch:19, time: 384.554959(s), Recall (@2: 0.1464, @5: 0.2225, @10: 0.2986), NDCG (@2: 0.1265, @5: 0.1605, @10: 0.1849)

Train epoch:20, time: 384.554959(s), rec_loss: 4.9048, tra_kl_loss: 6.2606, time_kl_loss: 4.7602
Test epoch:20, time: 395.888930(s), Recall (@2: 0.1505, @5: 0.2406, @10: 0.3163), NDCG (@2: 0.1314, @5: 0.1721, @10: 0.1966)

Train epoch:21, time: 395.888930(s), rec_loss: 4.8866, tra_kl_loss: 6.3316, time_kl_loss: 4.7094
Test epoch:21, time: 407.014462(s), Recall (@2: 0.1501, @5: 0.2339, @10: 0.3111), NDCG (@2: 0.1292, @5: 0.1670, @10: 0.1916)

Train epoch:22, time: 407.014462(s), rec_loss: 4.8664, tra_kl_loss: 6.2882, time_kl_loss: 4.7311
Test epoch:22, time: 419.287931(s), Recall (@2: 0.1516, @5: 0.2322, @10: 0.3111), NDCG (@2: 0.1322, @5: 0.1681, @10: 0.1934)

Train epoch:23, time: 419.287931(s), rec_loss: 4.8496, tra_kl_loss: 6.3332, time_kl_loss: 4.7122
Test epoch:23, time: 430.439941(s), Recall (@2: 0.1494, @5: 0.2352, @10: 0.3079), NDCG (@2: 0.1294, @5: 0.1677, @10: 0.1911)

Train epoch:24, time: 430.439941(s), rec_loss: 4.8233, tra_kl_loss: 6.4000, time_kl_loss: 4.7132
Test epoch:24, time: 441.589117(s), Recall (@2: 0.1492, @5: 0.2350, @10: 0.3068), NDCG (@2: 0.1315, @5: 0.1699, @10: 0.1930)

Train epoch:25, time: 441.589117(s), rec_loss: 4.8112, tra_kl_loss: 6.1939, time_kl_loss: 4.6834
Test epoch:25, time: 452.481908(s), Recall (@2: 0.1539, @5: 0.2434, @10: 0.3163), NDCG (@2: 0.1329, @5: 0.1733, @10: 0.1969)

Train epoch:26, time: 452.481908(s), rec_loss: 4.7948, tra_kl_loss: 6.2295, time_kl_loss: 4.7457
Test epoch:26, time: 463.573536(s), Recall (@2: 0.1563, @5: 0.2415, @10: 0.3189), NDCG (@2: 0.1375, @5: 0.1753, @10: 0.2004)

Train epoch:27, time: 463.573536(s), rec_loss: 4.7809, tra_kl_loss: 6.3839, time_kl_loss: 4.7301
Test epoch:27, time: 474.542341(s), Recall (@2: 0.1533, @5: 0.2411, @10: 0.3197), NDCG (@2: 0.1321, @5: 0.1713, @10: 0.1969)

Train epoch:28, time: 474.542341(s), rec_loss: 4.7633, tra_kl_loss: 6.2408, time_kl_loss: 4.7117
Test epoch:28, time: 485.295979(s), Recall (@2: 0.1524, @5: 0.2400, @10: 0.3154), NDCG (@2: 0.1333, @5: 0.1727, @10: 0.1971)

Train epoch:29, time: 485.295979(s), rec_loss: 4.7596, tra_kl_loss: 6.2566, time_kl_loss: 4.7484
Test epoch:29, time: 496.266194(s), Recall (@2: 0.1479, @5: 0.2309, @10: 0.3088), NDCG (@2: 0.1285, @5: 0.1656, @10: 0.1908)

Train epoch:30, time: 496.266194(s), rec_loss: 4.7476, tra_kl_loss: 6.1963, time_kl_loss: 4.7157
Test epoch:30, time: 507.030992(s), Recall (@2: 0.1458, @5: 0.2275, @10: 0.3036), NDCG (@2: 0.1274, @5: 0.1638, @10: 0.1884)

Train epoch:31, time: 507.030992(s), rec_loss: 4.7309, tra_kl_loss: 6.3204, time_kl_loss: 4.7010
Test epoch:31, time: 517.825091(s), Recall (@2: 0.1527, @5: 0.2421, @10: 0.3090), NDCG (@2: 0.1334, @5: 0.1736, @10: 0.1952)

Train epoch:32, time: 517.825091(s), rec_loss: 4.7162, tra_kl_loss: 6.2973, time_kl_loss: 4.6816
Test epoch:32, time: 528.815183(s), Recall (@2: 0.1600, @5: 0.2536, @10: 0.3226), NDCG (@2: 0.1387, @5: 0.1804, @10: 0.2027)

Train epoch:33, time: 528.815183(s), rec_loss: 4.7118, tra_kl_loss: 6.2983, time_kl_loss: 4.6781
Test epoch:33, time: 539.562967(s), Recall (@2: 0.1580, @5: 0.2441, @10: 0.3202), NDCG (@2: 0.1379, @5: 0.1762, @10: 0.2009)

Train epoch:34, time: 539.562967(s), rec_loss: 4.7053, tra_kl_loss: 6.3027, time_kl_loss: 4.6859
Test epoch:34, time: 550.378670(s), Recall (@2: 0.1531, @5: 0.2408, @10: 0.3180), NDCG (@2: 0.1341, @5: 0.1734, @10: 0.1985)

Train epoch:35, time: 550.378670(s), rec_loss: 4.6939, tra_kl_loss: 6.2423, time_kl_loss: 4.6983
Test epoch:35, time: 561.137825(s), Recall (@2: 0.1481, @5: 0.2296, @10: 0.3051), NDCG (@2: 0.1295, @5: 0.1661, @10: 0.1905)

Train epoch:36, time: 561.137825(s), rec_loss: 4.6823, tra_kl_loss: 6.1973, time_kl_loss: 4.6922
Test epoch:36, time: 571.983405(s), Recall (@2: 0.1464, @5: 0.2374, @10: 0.3100), NDCG (@2: 0.1294, @5: 0.1699, @10: 0.1934)

Train epoch:37, time: 571.983405(s), rec_loss: 4.6825, tra_kl_loss: 6.2804, time_kl_loss: 4.7056
Test epoch:37, time: 582.781519(s), Recall (@2: 0.1481, @5: 0.2322, @10: 0.3096), NDCG (@2: 0.1289, @5: 0.1665, @10: 0.1914)

Train epoch:38, time: 582.781519(s), rec_loss: 4.6654, tra_kl_loss: 6.3166, time_kl_loss: 4.7252
Test epoch:38, time: 593.376756(s), Recall (@2: 0.1602, @5: 0.2482, @10: 0.3226), NDCG (@2: 0.1393, @5: 0.1787, @10: 0.2027)

Train epoch:39, time: 593.376756(s), rec_loss: 4.6595, tra_kl_loss: 6.3362, time_kl_loss: 4.7109
Test epoch:39, time: 604.131083(s), Recall (@2: 0.1479, @5: 0.2316, @10: 0.3051), NDCG (@2: 0.1287, @5: 0.1661, @10: 0.1899)

Train epoch:40, time: 604.131083(s), rec_loss: 4.6522, tra_kl_loss: 6.2621, time_kl_loss: 4.6898
Test epoch:40, time: 615.039465(s), Recall (@2: 0.1505, @5: 0.2370, @10: 0.3148), NDCG (@2: 0.1312, @5: 0.1701, @10: 0.1952)

Train epoch:41, time: 615.039465(s), rec_loss: 4.6448, tra_kl_loss: 6.3130, time_kl_loss: 4.6769
Test epoch:41, time: 625.791573(s), Recall (@2: 0.1455, @5: 0.2337, @10: 0.3062), NDCG (@2: 0.1269, @5: 0.1661, @10: 0.1894)

Train epoch:42, time: 625.791573(s), rec_loss: 4.6427, tra_kl_loss: 6.2870, time_kl_loss: 4.6903
Test epoch:42, time: 636.505949(s), Recall (@2: 0.1531, @5: 0.2395, @10: 0.3148), NDCG (@2: 0.1335, @5: 0.1724, @10: 0.1968)

Train epoch:43, time: 636.505949(s), rec_loss: 4.6390, tra_kl_loss: 6.3190, time_kl_loss: 4.7495
Test epoch:43, time: 647.174698(s), Recall (@2: 0.1498, @5: 0.2380, @10: 0.3126), NDCG (@2: 0.1313, @5: 0.1707, @10: 0.1949)

Train epoch:44, time: 647.174698(s), rec_loss: 4.6252, tra_kl_loss: 6.2032, time_kl_loss: 4.7329
Test epoch:44, time: 657.920063(s), Recall (@2: 0.1511, @5: 0.2290, @10: 0.3044), NDCG (@2: 0.1316, @5: 0.1666, @10: 0.1910)

Train epoch:45, time: 657.920063(s), rec_loss: 4.6190, tra_kl_loss: 6.2056, time_kl_loss: 4.6903
Test epoch:45, time: 668.718865(s), Recall (@2: 0.1445, @5: 0.2324, @10: 0.3118), NDCG (@2: 0.1270, @5: 0.1664, @10: 0.1922)

Train epoch:46, time: 668.718865(s), rec_loss: 4.6166, tra_kl_loss: 6.1660, time_kl_loss: 4.6966
Test epoch:46, time: 679.991737(s), Recall (@2: 0.1468, @5: 0.2255, @10: 0.2971), NDCG (@2: 0.1292, @5: 0.1648, @10: 0.1879)

Train epoch:47, time: 679.991737(s), rec_loss: 4.6051, tra_kl_loss: 6.2758, time_kl_loss: 4.6673
Test epoch:47, time: 690.839919(s), Recall (@2: 0.1507, @5: 0.2350, @10: 0.3070), NDCG (@2: 0.1316, @5: 0.1693, @10: 0.1925)

Train epoch:48, time: 690.839919(s), rec_loss: 4.6013, tra_kl_loss: 6.2091, time_kl_loss: 4.6930
Test epoch:48, time: 701.836190(s), Recall (@2: 0.1496, @5: 0.2307, @10: 0.3019), NDCG (@2: 0.1313, @5: 0.1677, @10: 0.1906)

Train epoch:49, time: 701.836190(s), rec_loss: 4.5975, tra_kl_loss: 6.2025, time_kl_loss: 4.7039
Test epoch:49, time: 712.788058(s), Recall (@2: 0.1520, @5: 0.2285, @10: 0.2984), NDCG (@2: 0.1330, @5: 0.1673, @10: 0.1897)

Train epoch:50, time: 712.788058(s), rec_loss: 4.5868, tra_kl_loss: 6.2262, time_kl_loss: 4.6803
Test epoch:50, time: 723.570951(s), Recall (@2: 0.1559, @5: 0.2339, @10: 0.3105), NDCG (@2: 0.1368, @5: 0.1718, @10: 0.1965)

Train epoch:51, time: 723.570951(s), rec_loss: 4.5860, tra_kl_loss: 6.2846, time_kl_loss: 4.7663
Test epoch:51, time: 734.678097(s), Recall (@2: 0.1479, @5: 0.2311, @10: 0.3068), NDCG (@2: 0.1280, @5: 0.1653, @10: 0.1898)

Train epoch:52, time: 734.678097(s), rec_loss: 4.5747, tra_kl_loss: 6.2377, time_kl_loss: 4.7183
Test epoch:52, time: 745.518209(s), Recall (@2: 0.1514, @5: 0.2311, @10: 0.3038), NDCG (@2: 0.1347, @5: 0.1703, @10: 0.1938)

Train epoch:53, time: 745.518209(s), rec_loss: 4.5744, tra_kl_loss: 6.3021, time_kl_loss: 4.7224
Test epoch:53, time: 756.416090(s), Recall (@2: 0.1432, @5: 0.2227, @10: 0.2928), NDCG (@2: 0.1252, @5: 0.1609, @10: 0.1835)

Train epoch:54, time: 756.416090(s), rec_loss: 4.5700, tra_kl_loss: 6.4577, time_kl_loss: 4.7113
Test epoch:54, time: 767.674879(s), Recall (@2: 0.1546, @5: 0.2423, @10: 0.3195), NDCG (@2: 0.1354, @5: 0.1748, @10: 0.1997)

Train epoch:55, time: 767.674879(s), rec_loss: 4.5637, tra_kl_loss: 6.2131, time_kl_loss: 4.7826
Test epoch:55, time: 778.876667(s), Recall (@2: 0.1473, @5: 0.2279, @10: 0.2982), NDCG (@2: 0.1299, @5: 0.1659, @10: 0.1886)

Train epoch:56, time: 778.876667(s), rec_loss: 4.5541, tra_kl_loss: 6.2442, time_kl_loss: 4.6944
Test epoch:56, time: 790.110669(s), Recall (@2: 0.1477, @5: 0.2260, @10: 0.3040), NDCG (@2: 0.1319, @5: 0.1667, @10: 0.1919)

Train epoch:57, time: 790.110669(s), rec_loss: 4.5500, tra_kl_loss: 6.3165, time_kl_loss: 4.7251
Test epoch:57, time: 801.273404(s), Recall (@2: 0.1509, @5: 0.2417, @10: 0.3120), NDCG (@2: 0.1328, @5: 0.1734, @10: 0.1960)

Train epoch:58, time: 801.273404(s), rec_loss: 4.5451, tra_kl_loss: 6.2966, time_kl_loss: 4.7592
Test epoch:58, time: 812.565699(s), Recall (@2: 0.1509, @5: 0.2363, @10: 0.3053), NDCG (@2: 0.1316, @5: 0.1699, @10: 0.1923)

Train epoch:59, time: 812.565699(s), rec_loss: 4.5443, tra_kl_loss: 6.2763, time_kl_loss: 4.7102
Test epoch:59, time: 823.559225(s), Recall (@2: 0.1490, @5: 0.2292, @10: 0.3042), NDCG (@2: 0.1303, @5: 0.1662, @10: 0.1906)

Train epoch:60, time: 823.559225(s), rec_loss: 4.5277, tra_kl_loss: 6.2220, time_kl_loss: 4.6991
Test epoch:60, time: 834.506821(s), Recall (@2: 0.1529, @5: 0.2329, @10: 0.3042), NDCG (@2: 0.1344, @5: 0.1699, @10: 0.1929)

Train epoch:61, time: 834.506821(s), rec_loss: 4.5305, tra_kl_loss: 6.2322, time_kl_loss: 4.6968
Test epoch:61, time: 846.960368(s), Recall (@2: 0.1488, @5: 0.2301, @10: 0.3019), NDCG (@2: 0.1301, @5: 0.1663, @10: 0.1894)

Train epoch:62, time: 846.960368(s), rec_loss: 4.5232, tra_kl_loss: 6.2749, time_kl_loss: 4.7284
Test epoch:62, time: 858.806424(s), Recall (@2: 0.1503, @5: 0.2305, @10: 0.3072), NDCG (@2: 0.1314, @5: 0.1675, @10: 0.1923)

Train epoch:63, time: 858.806424(s), rec_loss: 4.5130, tra_kl_loss: 6.2892, time_kl_loss: 4.7650
Test epoch:63, time: 870.009333(s), Recall (@2: 0.1455, @5: 0.2283, @10: 0.3051), NDCG (@2: 0.1268, @5: 0.1639, @10: 0.1885)

Train epoch:64, time: 870.009333(s), rec_loss: 4.5135, tra_kl_loss: 6.3189, time_kl_loss: 4.7213
Test epoch:64, time: 881.723541(s), Recall (@2: 0.1511, @5: 0.2257, @10: 0.3006), NDCG (@2: 0.1321, @5: 0.1657, @10: 0.1897)

Train epoch:65, time: 881.723541(s), rec_loss: 4.5083, tra_kl_loss: 6.2922, time_kl_loss: 4.7157
Test epoch:65, time: 892.655359(s), Recall (@2: 0.1434, @5: 0.2262, @10: 0.2995), NDCG (@2: 0.1261, @5: 0.1634, @10: 0.1869)

Train epoch:66, time: 892.655359(s), rec_loss: 4.5020, tra_kl_loss: 6.3345, time_kl_loss: 4.7388
Test epoch:66, time: 903.852858(s), Recall (@2: 0.1473, @5: 0.2204, @10: 0.2956), NDCG (@2: 0.1290, @5: 0.1619, @10: 0.1862)

Train epoch:67, time: 903.852858(s), rec_loss: 4.5005, tra_kl_loss: 6.3354, time_kl_loss: 4.7735
Test epoch:67, time: 914.771874(s), Recall (@2: 0.1449, @5: 0.2232, @10: 0.2986), NDCG (@2: 0.1295, @5: 0.1646, @10: 0.1891)

Train epoch:68, time: 914.771874(s), rec_loss: 4.4977, tra_kl_loss: 6.1593, time_kl_loss: 4.7302
Test epoch:68, time: 925.939224(s), Recall (@2: 0.1414, @5: 0.2219, @10: 0.2962), NDCG (@2: 0.1254, @5: 0.1619, @10: 0.1858)

Train epoch:69, time: 925.939224(s), rec_loss: 4.4979, tra_kl_loss: 6.2532, time_kl_loss: 4.7046
Test epoch:69, time: 936.950594(s), Recall (@2: 0.1570, @5: 0.2337, @10: 0.3010), NDCG (@2: 0.1368, @5: 0.1709, @10: 0.1926)

Train epoch:70, time: 936.950594(s), rec_loss: 4.4878, tra_kl_loss: 6.2312, time_kl_loss: 4.7016
Test epoch:70, time: 947.809118(s), Recall (@2: 0.1498, @5: 0.2285, @10: 0.3025), NDCG (@2: 0.1319, @5: 0.1671, @10: 0.1911)
