dataset:four-sin
train_dir:default
batch_size:64
lr:0.001
maxlen:50
hidden_units:64
num_blocks:2
num_epochs:50
num_heads:1
dropout_rate:0.2
l2_emb:0.001
gpu:0
inference_only:False
state_dict_path:None
time_span:128
dis_span:256
anchor_num:500
layer_num:3
tra_kl_reg:1.0
dis_kl_reg:1.0
time_kl_reg:1.0
contra_reg:1.0
tra_delta:0.0
tem_delta:0.0
dis_delta:0.0
valid_epoch:1
device:cuda:0
In total: 737601 trainable parameters.
Train epoch:1, time: 0.000000(s), rec_loss: 8.0544, tra_kl_loss: 6.5515, time_kl_loss: 6.0542, dis_kl_loss: 6.0264, contra_loss: 15801.0979
Test epoch:1, time: 11.490082(s), Recall (@2: 0.1095, @5: 0.1695, @10: 0.2253), NDCG (@2: 0.0963, @5: 0.1228, @10: 0.1408)

Train epoch:2, time: 11.490082(s), rec_loss: 7.2705, tra_kl_loss: 7.2154, time_kl_loss: 5.8275, dis_kl_loss: 5.8118, contra_loss: 29649.2947
Test epoch:2, time: 22.363955(s), Recall (@2: 0.1156, @5: 0.1969, @10: 0.2568), NDCG (@2: 0.1010, @5: 0.1372, @10: 0.1568)

Train epoch:3, time: 22.363955(s), rec_loss: 6.7458, tra_kl_loss: 6.8273, time_kl_loss: 5.0846, dis_kl_loss: 5.1478, contra_loss: 32292.8982
Test epoch:3, time: 33.345399(s), Recall (@2: 0.1147, @5: 0.1876, @10: 0.2646), NDCG (@2: 0.0997, @5: 0.1319, @10: 0.1566)

Train epoch:4, time: 33.345399(s), rec_loss: 6.3809, tra_kl_loss: 6.5356, time_kl_loss: 4.9634, dis_kl_loss: 4.9620, contra_loss: 31846.6083
Test epoch:4, time: 44.314991(s), Recall (@2: 0.1257, @5: 0.2098, @10: 0.2881), NDCG (@2: 0.1088, @5: 0.1466, @10: 0.1718)

Train epoch:5, time: 44.314991(s), rec_loss: 6.1109, tra_kl_loss: 6.4334, time_kl_loss: 4.8467, dis_kl_loss: 4.8624, contra_loss: 29865.6335
Test epoch:5, time: 55.683964(s), Recall (@2: 0.1261, @5: 0.2111, @10: 0.2835), NDCG (@2: 0.1076, @5: 0.1458, @10: 0.1691)

Train epoch:6, time: 55.683964(s), rec_loss: 5.9035, tra_kl_loss: 6.3908, time_kl_loss: 4.8346, dis_kl_loss: 4.8008, contra_loss: 29273.6924
Test epoch:6, time: 66.990301(s), Recall (@2: 0.1345, @5: 0.2236, @10: 0.3029), NDCG (@2: 0.1149, @5: 0.1549, @10: 0.1806)

Train epoch:7, time: 66.990301(s), rec_loss: 5.7302, tra_kl_loss: 6.3255, time_kl_loss: 4.7896, dis_kl_loss: 4.8201, contra_loss: 27087.2534
Test epoch:7, time: 77.964580(s), Recall (@2: 0.1358, @5: 0.2210, @10: 0.2973), NDCG (@2: 0.1165, @5: 0.1549, @10: 0.1794)

Train epoch:8, time: 77.964580(s), rec_loss: 5.5939, tra_kl_loss: 6.3991, time_kl_loss: 4.7502, dis_kl_loss: 4.7997, contra_loss: 25505.3056
Test epoch:8, time: 88.727625(s), Recall (@2: 0.1432, @5: 0.2309, @10: 0.3055), NDCG (@2: 0.1221, @5: 0.1617, @10: 0.1857)

Train epoch:9, time: 88.727625(s), rec_loss: 5.4893, tra_kl_loss: 6.2854, time_kl_loss: 4.7553, dis_kl_loss: 4.7515, contra_loss: 24375.0189
Test epoch:9, time: 99.956473(s), Recall (@2: 0.1434, @5: 0.2279, @10: 0.3012), NDCG (@2: 0.1229, @5: 0.1608, @10: 0.1845)

Train epoch:10, time: 99.956473(s), rec_loss: 5.3925, tra_kl_loss: 6.2760, time_kl_loss: 4.7625, dis_kl_loss: 4.7538, contra_loss: 22465.0768
Test epoch:10, time: 110.292552(s), Recall (@2: 0.1460, @5: 0.2324, @10: 0.3016), NDCG (@2: 0.1251, @5: 0.1640, @10: 0.1865)

Train epoch:11, time: 110.292552(s), rec_loss: 5.3221, tra_kl_loss: 6.3323, time_kl_loss: 4.7636, dis_kl_loss: 4.7224, contra_loss: 21845.3662
Test epoch:11, time: 121.366181(s), Recall (@2: 0.1516, @5: 0.2426, @10: 0.3139), NDCG (@2: 0.1295, @5: 0.1702, @10: 0.1932)

Train epoch:12, time: 121.366181(s), rec_loss: 5.2616, tra_kl_loss: 6.3177, time_kl_loss: 4.7158, dis_kl_loss: 4.7085, contra_loss: 20518.5251
Test epoch:12, time: 132.539154(s), Recall (@2: 0.1505, @5: 0.2337, @10: 0.3081), NDCG (@2: 0.1292, @5: 0.1665, @10: 0.1904)

Train epoch:13, time: 132.539154(s), rec_loss: 5.2108, tra_kl_loss: 6.3069, time_kl_loss: 4.6971, dis_kl_loss: 4.6935, contra_loss: 19874.2751
Test epoch:13, time: 143.852325(s), Recall (@2: 0.1555, @5: 0.2449, @10: 0.3187), NDCG (@2: 0.1331, @5: 0.1734, @10: 0.1972)

Train epoch:14, time: 143.852325(s), rec_loss: 5.1655, tra_kl_loss: 6.2303, time_kl_loss: 4.6686, dis_kl_loss: 4.6793, contra_loss: 19406.3653
Test epoch:14, time: 154.921694(s), Recall (@2: 0.1507, @5: 0.2391, @10: 0.3107), NDCG (@2: 0.1297, @5: 0.1696, @10: 0.1927)

Train epoch:15, time: 154.921694(s), rec_loss: 5.1225, tra_kl_loss: 6.2421, time_kl_loss: 4.6568, dis_kl_loss: 4.6063, contra_loss: 18511.0463
Test epoch:15, time: 166.016862(s), Recall (@2: 0.1494, @5: 0.2393, @10: 0.3092), NDCG (@2: 0.1293, @5: 0.1697, @10: 0.1922)

Train epoch:16, time: 166.016862(s), rec_loss: 5.0930, tra_kl_loss: 6.2443, time_kl_loss: 4.6352, dis_kl_loss: 4.6714, contra_loss: 17701.2248
Test epoch:16, time: 177.695886(s), Recall (@2: 0.1501, @5: 0.2406, @10: 0.3096), NDCG (@2: 0.1279, @5: 0.1687, @10: 0.1911)

Train epoch:17, time: 177.695886(s), rec_loss: 5.0580, tra_kl_loss: 6.2877, time_kl_loss: 4.6035, dis_kl_loss: 4.6614, contra_loss: 16704.9876
Test epoch:17, time: 189.591791(s), Recall (@2: 0.1574, @5: 0.2516, @10: 0.3223), NDCG (@2: 0.1365, @5: 0.1787, @10: 0.2014)

Train epoch:18, time: 189.591791(s), rec_loss: 5.0337, tra_kl_loss: 6.3044, time_kl_loss: 4.7332, dis_kl_loss: 4.6689, contra_loss: 16420.9276
Test epoch:18, time: 201.545820(s), Recall (@2: 0.1516, @5: 0.2447, @10: 0.3189), NDCG (@2: 0.1322, @5: 0.1740, @10: 0.1978)

Train epoch:19, time: 201.545820(s), rec_loss: 5.0033, tra_kl_loss: 6.1414, time_kl_loss: 4.6160, dis_kl_loss: 4.6386, contra_loss: 15321.1828
Test epoch:19, time: 213.489397(s), Recall (@2: 0.1596, @5: 0.2447, @10: 0.3223), NDCG (@2: 0.1377, @5: 0.1762, @10: 0.2015)

Train epoch:20, time: 213.489397(s), rec_loss: 4.9883, tra_kl_loss: 6.2556, time_kl_loss: 4.6778, dis_kl_loss: 4.7015, contra_loss: 15174.9133
Test epoch:20, time: 225.224143(s), Recall (@2: 0.1529, @5: 0.2378, @10: 0.3141), NDCG (@2: 0.1323, @5: 0.1706, @10: 0.1953)

Train epoch:21, time: 225.224143(s), rec_loss: 4.9582, tra_kl_loss: 6.2595, time_kl_loss: 4.6413, dis_kl_loss: 4.6234, contra_loss: 14557.3504
Test epoch:21, time: 237.742876(s), Recall (@2: 0.1580, @5: 0.2482, @10: 0.3234), NDCG (@2: 0.1385, @5: 0.1790, @10: 0.2033)

Train epoch:22, time: 237.742876(s), rec_loss: 4.9361, tra_kl_loss: 6.2276, time_kl_loss: 4.6564, dis_kl_loss: 4.6662, contra_loss: 13883.9933
Test epoch:22, time: 250.184507(s), Recall (@2: 0.1604, @5: 0.2514, @10: 0.3288), NDCG (@2: 0.1391, @5: 0.1798, @10: 0.2049)

Train epoch:23, time: 250.184507(s), rec_loss: 4.9247, tra_kl_loss: 6.2704, time_kl_loss: 4.6318, dis_kl_loss: 4.6517, contra_loss: 13975.2822
Test epoch:23, time: 262.894941(s), Recall (@2: 0.1531, @5: 0.2402, @10: 0.3126), NDCG (@2: 0.1315, @5: 0.1708, @10: 0.1942)

Train epoch:24, time: 262.894941(s), rec_loss: 4.8999, tra_kl_loss: 6.2209, time_kl_loss: 4.6323, dis_kl_loss: 4.6505, contra_loss: 13223.9891
Test epoch:24, time: 275.389119(s), Recall (@2: 0.1563, @5: 0.2471, @10: 0.3200), NDCG (@2: 0.1355, @5: 0.1765, @10: 0.2002)

Train epoch:25, time: 275.389119(s), rec_loss: 4.8899, tra_kl_loss: 6.3773, time_kl_loss: 4.6628, dis_kl_loss: 4.6481, contra_loss: 12984.9145
Test epoch:25, time: 287.568186(s), Recall (@2: 0.1593, @5: 0.2460, @10: 0.3193), NDCG (@2: 0.1379, @5: 0.1769, @10: 0.2005)

Train epoch:26, time: 287.568186(s), rec_loss: 4.8732, tra_kl_loss: 6.2375, time_kl_loss: 4.6160, dis_kl_loss: 4.6641, contra_loss: 12394.1643
Test epoch:26, time: 300.112409(s), Recall (@2: 0.1447, @5: 0.2313, @10: 0.3051), NDCG (@2: 0.1265, @5: 0.1655, @10: 0.1891)

Train epoch:27, time: 300.112409(s), rec_loss: 4.8598, tra_kl_loss: 6.2493, time_kl_loss: 4.6250, dis_kl_loss: 4.6069, contra_loss: 11771.4935
Test epoch:27, time: 312.328733(s), Recall (@2: 0.1701, @5: 0.2615, @10: 0.3376), NDCG (@2: 0.1466, @5: 0.1877, @10: 0.2123)

Train epoch:28, time: 312.328733(s), rec_loss: 4.8484, tra_kl_loss: 6.2670, time_kl_loss: 4.6396, dis_kl_loss: 4.6381, contra_loss: 11494.9203
Test epoch:28, time: 325.176338(s), Recall (@2: 0.1531, @5: 0.2370, @10: 0.3044), NDCG (@2: 0.1326, @5: 0.1702, @10: 0.1919)

Train epoch:29, time: 325.176338(s), rec_loss: 4.8306, tra_kl_loss: 6.2355, time_kl_loss: 4.6399, dis_kl_loss: 4.6401, contra_loss: 11271.2261
Test epoch:29, time: 337.851846(s), Recall (@2: 0.1608, @5: 0.2467, @10: 0.3249), NDCG (@2: 0.1398, @5: 0.1787, @10: 0.2041)

Train epoch:30, time: 337.851846(s), rec_loss: 4.8169, tra_kl_loss: 6.2517, time_kl_loss: 4.6468, dis_kl_loss: 4.6139, contra_loss: 11241.8863
Test epoch:30, time: 350.295921(s), Recall (@2: 0.1583, @5: 0.2436, @10: 0.3206), NDCG (@2: 0.1387, @5: 0.1772, @10: 0.2020)

Train epoch:31, time: 350.295921(s), rec_loss: 4.8082, tra_kl_loss: 6.2326, time_kl_loss: 4.6473, dis_kl_loss: 4.6382, contra_loss: 10948.3454
Test epoch:31, time: 362.624901(s), Recall (@2: 0.1539, @5: 0.2365, @10: 0.3081), NDCG (@2: 0.1341, @5: 0.1710, @10: 0.1941)

Train epoch:32, time: 362.624901(s), rec_loss: 4.7950, tra_kl_loss: 6.2663, time_kl_loss: 4.6360, dis_kl_loss: 4.6481, contra_loss: 10744.2837
Test epoch:32, time: 375.206206(s), Recall (@2: 0.1550, @5: 0.2404, @10: 0.3126), NDCG (@2: 0.1356, @5: 0.1741, @10: 0.1975)

Train epoch:33, time: 375.206206(s), rec_loss: 4.7875, tra_kl_loss: 6.2679, time_kl_loss: 4.6320, dis_kl_loss: 4.6312, contra_loss: 10456.0626
Test epoch:33, time: 387.666108(s), Recall (@2: 0.1496, @5: 0.2372, @10: 0.3066), NDCG (@2: 0.1318, @5: 0.1714, @10: 0.1941)

Train epoch:34, time: 387.666108(s), rec_loss: 4.7746, tra_kl_loss: 6.1992, time_kl_loss: 4.6467, dis_kl_loss: 4.6586, contra_loss: 10085.1774
Test epoch:34, time: 399.826685(s), Recall (@2: 0.1509, @5: 0.2313, @10: 0.3025), NDCG (@2: 0.1317, @5: 0.1677, @10: 0.1906)

Train epoch:35, time: 399.826685(s), rec_loss: 4.7652, tra_kl_loss: 6.2405, time_kl_loss: 4.6109, dis_kl_loss: 4.6443, contra_loss: 9660.7323
Test epoch:35, time: 411.989685(s), Recall (@2: 0.1580, @5: 0.2469, @10: 0.3236), NDCG (@2: 0.1379, @5: 0.1778, @10: 0.2026)

Train epoch:36, time: 411.989685(s), rec_loss: 4.7580, tra_kl_loss: 6.2554, time_kl_loss: 4.6298, dis_kl_loss: 4.6587, contra_loss: 9783.1200
Test epoch:36, time: 424.560435(s), Recall (@2: 0.1535, @5: 0.2357, @10: 0.3111), NDCG (@2: 0.1338, @5: 0.1706, @10: 0.1949)

Train epoch:37, time: 424.560435(s), rec_loss: 4.7447, tra_kl_loss: 6.1694, time_kl_loss: 4.6298, dis_kl_loss: 4.6467, contra_loss: 9037.8079
Test epoch:37, time: 437.125386(s), Recall (@2: 0.1548, @5: 0.2426, @10: 0.3172), NDCG (@2: 0.1342, @5: 0.1735, @10: 0.1976)

Train epoch:38, time: 437.125386(s), rec_loss: 4.7421, tra_kl_loss: 6.3144, time_kl_loss: 4.6571, dis_kl_loss: 4.6335, contra_loss: 9208.7677
Test epoch:38, time: 449.612909(s), Recall (@2: 0.1514, @5: 0.2320, @10: 0.3047), NDCG (@2: 0.1331, @5: 0.1694, @10: 0.1929)

Train epoch:39, time: 449.612909(s), rec_loss: 4.7254, tra_kl_loss: 6.2768, time_kl_loss: 4.6326, dis_kl_loss: 4.6451, contra_loss: 8854.2063
Test epoch:39, time: 462.058358(s), Recall (@2: 0.1537, @5: 0.2372, @10: 0.3131), NDCG (@2: 0.1340, @5: 0.1716, @10: 0.1962)

Train epoch:40, time: 462.058358(s), rec_loss: 4.7150, tra_kl_loss: 6.2665, time_kl_loss: 4.6378, dis_kl_loss: 4.6386, contra_loss: 8764.5810
Test epoch:40, time: 473.745482(s), Recall (@2: 0.1475, @5: 0.2268, @10: 0.2969), NDCG (@2: 0.1289, @5: 0.1644, @10: 0.1869)

Train epoch:41, time: 473.745482(s), rec_loss: 4.7103, tra_kl_loss: 6.2680, time_kl_loss: 4.6524, dis_kl_loss: 4.6502, contra_loss: 8730.4331
Test epoch:41, time: 484.942532(s), Recall (@2: 0.1555, @5: 0.2395, @10: 0.3113), NDCG (@2: 0.1360, @5: 0.1737, @10: 0.1968)

Train epoch:42, time: 484.942532(s), rec_loss: 4.7131, tra_kl_loss: 6.3039, time_kl_loss: 4.6651, dis_kl_loss: 4.6640, contra_loss: 8788.4582
Test epoch:42, time: 496.077338(s), Recall (@2: 0.1531, @5: 0.2359, @10: 0.3129), NDCG (@2: 0.1344, @5: 0.1715, @10: 0.1962)

Train epoch:43, time: 496.077338(s), rec_loss: 4.6955, tra_kl_loss: 6.3188, time_kl_loss: 4.6544, dis_kl_loss: 4.6283, contra_loss: 8451.7952
Test epoch:43, time: 507.571814(s), Recall (@2: 0.1479, @5: 0.2324, @10: 0.3044), NDCG (@2: 0.1290, @5: 0.1671, @10: 0.1902)

Train epoch:44, time: 507.571814(s), rec_loss: 4.6884, tra_kl_loss: 6.3331, time_kl_loss: 4.6578, dis_kl_loss: 4.6649, contra_loss: 8372.4936
Test epoch:44, time: 518.937934(s), Recall (@2: 0.1578, @5: 0.2361, @10: 0.3113), NDCG (@2: 0.1380, @5: 0.1732, @10: 0.1976)

Train epoch:45, time: 518.937934(s), rec_loss: 4.6860, tra_kl_loss: 6.2288, time_kl_loss: 4.6488, dis_kl_loss: 4.6296, contra_loss: 8267.8614
Test epoch:45, time: 530.240283(s), Recall (@2: 0.1516, @5: 0.2352, @10: 0.3081), NDCG (@2: 0.1326, @5: 0.1702, @10: 0.1937)

Train epoch:46, time: 530.240283(s), rec_loss: 4.6763, tra_kl_loss: 6.1393, time_kl_loss: 4.6355, dis_kl_loss: 4.6707, contra_loss: 8105.9332
Test epoch:46, time: 541.802670(s), Recall (@2: 0.1533, @5: 0.2346, @10: 0.3111), NDCG (@2: 0.1340, @5: 0.1701, @10: 0.1948)

Train epoch:47, time: 541.802670(s), rec_loss: 4.6720, tra_kl_loss: 6.2428, time_kl_loss: 4.6642, dis_kl_loss: 4.6702, contra_loss: 8003.6393
Test epoch:47, time: 553.076196(s), Recall (@2: 0.1589, @5: 0.2402, @10: 0.3202), NDCG (@2: 0.1387, @5: 0.1750, @10: 0.2009)

Train epoch:48, time: 553.076196(s), rec_loss: 4.6653, tra_kl_loss: 6.3232, time_kl_loss: 4.6347, dis_kl_loss: 4.6986, contra_loss: 8093.1345
Test epoch:48, time: 564.231612(s), Recall (@2: 0.1550, @5: 0.2335, @10: 0.3081), NDCG (@2: 0.1354, @5: 0.1705, @10: 0.1946)

Train epoch:49, time: 564.231612(s), rec_loss: 4.6601, tra_kl_loss: 6.2291, time_kl_loss: 4.6636, dis_kl_loss: 4.6324, contra_loss: 7805.5207
Test epoch:49, time: 575.522225(s), Recall (@2: 0.1570, @5: 0.2365, @10: 0.3139), NDCG (@2: 0.1379, @5: 0.1733, @10: 0.1982)

Train epoch:50, time: 575.522225(s), rec_loss: 4.6531, tra_kl_loss: 6.1903, time_kl_loss: 4.6426, dis_kl_loss: 4.6669, contra_loss: 7751.6181
Test epoch:50, time: 586.536023(s), Recall (@2: 0.1561, @5: 0.2342, @10: 0.3031), NDCG (@2: 0.1368, @5: 0.1715, @10: 0.1937)
